#	Example:
#
#	example_effect = {
#		add_political_power = 66
#		add_popularity = {
#			ideology = fascism
#			popularity = 0.33
#		}
#	}
#
#
#	In a script file:
#
#	effect = {
#		example_effect = yes
#	}
PRC_support_up = {
	if = {
		limit = {
			NOT = {
				has_idea = PRC_communist_support_low
				has_idea = PRC_communist_support_med
				has_idea = PRC_communist_support_high
			}
		}
		add_ideas = PRC_communist_support_low
	}
	else_if = {
		limit = {
			has_idea = PRC_communist_support_low
		}
		swap_ideas = {
			remove_idea = PRC_communist_support_low
			add_idea = PRC_communist_support_med
		}
	}
	else_if = {
		limit = {
			has_idea = PRC_communist_support_med
		}
		swap_ideas = {
			remove_idea = PRC_communist_support_med
			add_idea = PRC_communist_support_high
		}
	}
	else_if = {
		limit = {
			has_idea = PRC_communist_support_high
		}
		set_global_flag = PRC_communist_support_maxed_out #address the maxed out issue
	}
}
PRC_support_down = {
	if = {
		limit = {
			has_idea = PRC_communist_support_high
			has_global_flag = PRC_communist_support_maxed_out
		}
		clr_global_flag = PRC_communist_support_maxed_out
	}
	else_if = {
		limit = {
			has_idea = PRC_communist_support_high
		}
		swap_ideas = {
			remove_idea = PRC_communist_support_high
			add_idea = PRC_communist_support_med
		}
	}
	else_if = {
		limit = {
			has_idea = PRC_communist_support_med
		}
		swap_ideas = {
			remove_idea = PRC_communist_support_med
			add_idea = PRC_communist_support_low
		}
	}
	else_if = {
		limit = {
			has_idea = PRC_communist_support_low
		}
		remove_ideas = PRC_communist_support_low
	}
}


ROOT_become_a_regional_army_of_THIS = {
	custom_effect_tooltip = ROOT_become_a_regional_army_of_THIS_tt
	hidden_effect = {
		FROM = { set_autonomy = { target = ROOT autonomy_state = autonomy_rcm_national_revolutionary_army } }
	}
}

ROOT_become_a_regional_army_of_FROM = {
	custom_effect_tooltip = ROOT_become_a_regional_army_of_FROM_tt
	hidden_effect = {
		FROM = { set_autonomy = { target = ROOT autonomy_state = autonomy_rcm_national_revolutionary_army } }
	}
}
FROM_become_a_regional_army_of_THIS = {
	custom_effect_tooltip = FROM_become_a_regional_army_of_THIS_tt
	hidden_effect = {
		set_autonomy = { target = FROM autonomy_state = autonomy_rcm_national_revolutionary_army }
	}
}

ROOT_become_a_HA_provincial_government_of_FROM = {
	custom_effect_tooltip = ROOT_become_a_HA_provincial_government_of_FROM_tt
	hidden_effect = {
		FROM = { set_autonomy = { target = ROOT autonomy_state = autonomy_rcm_provincial_government freedom_level = 0.65 } }
	}
}
FROM_become_a_HA_provincial_government_of_THIS = {
	custom_effect_tooltip = FROM_become_a_HA_provincial_government_of_THIS_tt
	hidden_effect = {
		set_autonomy = { target = FROM autonomy_state = autonomy_rcm_provincial_government freedom_level = 0.65 }
	}
}
FROM_become_a_provincial_government_of_THIS = {
	custom_effect_tooltip = FROM_become_a_provincial_government_of_THIS_tt
	hidden_effect = {
		set_autonomy = { target = FROM autonomy_state = autonomy_rcm_provincial_government }
	}
}
ROOT_become_a_NSA_provincial_government_of_FROM = {
	custom_effect_tooltip = ROOT_become_a_NSA_provincial_government_of_FROM_tt
	hidden_effect = {
		FROM = { set_autonomy = { target = ROOT autonomy_state = autonomy_rcm_provincial_government freedom_level = 0.25 } }
	}
}
FROM_become_a_NSA_provincial_government_of_THIS = {
	custom_effect_tooltip = FROM_become_a_NSA_provincial_government_of_THIS_tt
	hidden_effect = {
		set_autonomy = { target = FROM autonomy_state = autonomy_rcm_provincial_government freedom_level = 0.25 }
	}
}
peace_with_SHX_overlord = {
	if = {
		limit = {
			SHX = {
				is_puppet = yes
			}
		}
		SHX = {
			overlord = {
				save_event_target_as = SHX_overlord
			}
		}
		white_peace = event_target:SHX_overlord
	}
	if = {
		limit = {
			SHX = {
				is_in_faction = yes
			}
		}
		every_enemy_country = {
			limit = {
				is_in_faction_with = SHX
			}
			save_event_target_as = SHX_allies
		}
		white_peace = event_target:SHX_allies
	}
}
clr_baseball_game_data = {
	clr_country_flag = I_won_this_match_champion
	clr_country_flag = I_end_up_second
	clr_country_flag = I_end_up_third
	clr_country_flag = I_end_up_fourth
	clr_country_flag = I_end_up_fifth
	clr_country_flag = I_end_up_sixth
	clr_country_flag = I_chose_hosei
	clr_country_flag = I_chose_keio
	clr_country_flag = I_chose_meiji
	clr_country_flag = I_chose_rikkyo
	clr_country_flag = I_chose_tokyo
	clr_country_flag = I_chose_waseda
	clr_country_flag = champion_is_hosei
	clr_country_flag = champion_is_keio
	clr_country_flag = champion_is_meiji
	clr_country_flag = champion_is_rikkyo
	clr_country_flag = champion_is_tokyo
	clr_country_flag = champion_is_waseda
}
remove_a_random_civ = {
	random_owned_controlled_state = {
		limit = {
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
	}
}
start_baseball_game = {
	hidden_effect = {
		scoped_sound_effect = baseball_2
	}
	custom_effect_tooltip = start_baseball_game_tt
	if = {
		limit = {
			has_country_flag = stake_level_1
		}
		add_political_power = -25
	}
	if = {
		limit = {
			has_country_flag = stake_level_2
		}
		add_political_power = -50
	}
	if = {
		limit = {
			has_country_flag = stake_level_3
		}
		add_political_power = -75
	}
	
	if = {
		limit = {
			has_country_flag = civies_stake_level_1
		}
		random_owned_controlled_state = {
			limit = {
				industrial_complex > 0
			}
			remove_building = {
				type = industrial_complex
				level = 1
			}
		}
	}
	if = {
		limit = {
			has_country_flag = civies_stake_level_2
		}
		random_owned_controlled_state = {
			limit = {
				industrial_complex > 0
			}
			remove_building = {
				type = industrial_complex
				level = 1
			}
		}
		random_owned_controlled_state = {
			limit = {
				industrial_complex > 0
			}
			remove_building = {
				type = industrial_complex
				level = 1
			}
		}
	}
	if = {
		limit = {
			has_country_flag = civies_stake_level_3
		}
		random_owned_controlled_state = {
			limit = {
				industrial_complex > 0
			}
			remove_building = {
				type = industrial_complex
				level = 1
			}
		}
		random_owned_controlled_state = {
			limit = {
				industrial_complex > 0
			}
			remove_building = {
				type = industrial_complex
				level = 1
			}
		}
		random_owned_controlled_state = {
			limit = {
				industrial_complex > 0
			}
			remove_building = {
				type = industrial_complex
				level = 1
			}
		}
	}
	hidden_effect = {
		
		if = {
			limit = {
				NOT = {
					has_completed_focus = JAP_expand_the_Tokyo_Big6_Baseball_League_focus
				}
			}
			random_list = {
				25 = {
					set_country_flag = I_won_this_match_champion
					if = {
						limit = {
							has_country_flag = I_chose_waseda
						}
						set_country_flag = champion_is_waseda
					}
					else_if = {
						limit = {
							has_country_flag = I_chose_hosei
						}
						set_country_flag = champion_is_hosei
					}
					else_if = {
						limit = {
							has_country_flag = I_chose_rikkyo
						}
						set_country_flag = champion_is_rikkyo
					}
			 		else_if = {
						limit = {
							has_country_flag = I_chose_keio
						}
						set_country_flag = champion_is_keio
					}
					
					if = {
						limit = {
							has_country_flag = stake_level_1
						}
						set_variable = { This.reward_pp = 75 }
					}
					else_if = {
						limit = {
							has_country_flag = stake_level_2
						}
						set_variable = { This.reward_pp = 150 }
					}
					else_if = {
						limit = {
							has_country_flag = stake_level_3
						}
						set_variable = { This.reward_pp = 225 }
					}

					#civies
					if = {
						limit = {
							has_country_flag = civies_stake_level_1
						}
						set_variable = { This.reward_civ = 3 }
					}
					else_if = {
						limit = {
							has_country_flag = civies_stake_level_2
						}
						set_variable = { This.reward_civ = 6 }
					}
					else_if = {
						limit = {
							has_country_flag = civies_stake_level_3
						}
						set_variable = { This.reward_civ = 9 }
					}
					#country_event = {
					#	days = 60 random_days = 3
					#	id = rcmjapan_baseball.9
					#} 
					activate_mission = RCM_JAP_game_in_progress_champion_mission
				}
				75 = {

				}
			}
			if = {
				limit = {
					NOT = {
						has_country_flag = I_won_this_match_champion
					}
				}
				if = {
					limit = {
						has_country_flag = I_chose_waseda
					}
					random_list = {
						10 = { set_country_flag = champion_is_keio }
						10 = { set_country_flag = champion_is_rikkyo }
						10 = { set_country_flag = champion_is_hosei }
					}
				}
				else_if = {
					limit = {
						has_country_flag = I_chose_hosei
					}
					random_list = {
						10 = { set_country_flag = champion_is_keio }
						10 = { set_country_flag = champion_is_rikkyo }
						10 = { set_country_flag = champion_is_waseda }
					}
				}
				else_if = {
					limit = {
						has_country_flag = I_chose_rikkyo
					}
					random_list = {
						10 = { set_country_flag = champion_is_hosei }
						10 = { set_country_flag = champion_is_keio }
						10 = { set_country_flag = champion_is_waseda }
					}
				}
			 	else_if = {
					limit = {
						has_country_flag = I_chose_keio
					}
					random_list = {
						10 = { set_country_flag = champion_is_hosei }
						10 = { set_country_flag = champion_is_rikkyo }
						10 = { set_country_flag = champion_is_waseda }
					}
				}				
				random_list = {
					30 = {
						set_country_flag = I_end_up_second
						set_variable = { This.baseball_ranking = 2 }
						if = {
							limit = {
								has_country_flag = stake_level_1
							}
							set_variable = { This.reward_pp = 50 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_2
							}
							set_variable = { This.reward_pp = 100 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_3
							}
							set_variable = { This.reward_pp = 150 }
						}
						if = {
							limit = {
								has_country_flag = civies_stake_level_1
							}
							set_variable = { This.reward_civ = 2 }
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_2
							}
							set_variable = { This.reward_civ = 4 }
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_3
							}
							set_variable = { This.reward_civ = 6 }
						}
						activate_mission = RCM_JAP_game_in_progress_no_champion_mission
					}
					30 = {
						set_country_flag = I_end_up_third
						set_variable = { This.baseball_ranking = 3 }
						if = {
							limit = {
								has_country_flag = stake_level_1
							}
							set_variable = { This.reward_pp = 25 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_2
							}
							set_variable = { This.reward_pp = 50 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_3
							}
							set_variable = { This.reward_pp = 75 }
						}
						if = {
							limit = {
								has_country_flag = civies_stake_level_1
							}
							set_variable = { This.reward_civ = 1 }
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_2
							}
							set_variable = { This.reward_civ = 2 }
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_3
							}
							set_variable = { This.reward_civ = 3 }
						}
						activate_mission = RCM_JAP_game_in_progress_no_champion_mission
					}
					30 = {
						set_country_flag = I_end_up_fourth
						set_variable = { This.baseball_ranking = 4 }
						set_variable = { This.reward_pp = 0 }
						set_variable = { This.reward_civ = 0 }
						activate_mission = RCM_JAP_game_in_progress_no_champion_mission
					}
				}
			}		
		}
		else = {
			random_list = {
				10 = {
					if = {
						limit = {
							has_country_flag = I_chose_keio
						}
						set_country_flag = champion_is_keio
					}
					else_if = {
						limit = {
							has_country_flag = I_chose_rikkyo
						}
						set_country_flag = champion_is_rikkyo
					}
					else_if = {
						limit = {
							has_country_flag = I_chose_hosei
						}
						set_country_flag = champion_is_hosei
					}
					else_if = {
						limit = {
							has_country_flag = I_chose_waseda
						}
						set_country_flag = champion_is_waseda
					}
					else_if = {
						limit = {
							has_country_flag = I_chose_meiji
						}
						set_country_flag = champion_is_meiji
					}
					else_if = {
						limit = {
							has_country_flag = I_chose_tokyo
						}
						set_country_flag = champion_is_tokyo
					}	
					set_country_flag = I_won_this_match_champion
					if = {
						limit = {
							has_country_flag = stake_level_1
						}
						set_variable = { This.reward_pp = 100 }
					}
					else_if = {
						limit = {
							has_country_flag = stake_level_2
						}
						set_variable = { This.reward_pp = 200 }
					}
					else_if = {
						limit = {
							has_country_flag = stake_level_3
						}
						set_variable = { This.reward_pp = 300 }
					}
					if = {
						limit = {
							has_country_flag = civies_stake_level_1
						}
						set_variable = { This.reward_civ = 4 }
					}
					else_if = {
						limit = {
							has_country_flag = civies_stake_level_2
						}
						set_variable = { This.reward_civ = 8 }
					}
					else_if = {
						limit = {
							has_country_flag = civies_stake_level_3
						}
						set_variable = { This.reward_civ = 12 }
					}
					#country_event = {
					#	days = 60 random_days = 3
					#	id = rcmjapan_baseball.9
					#} 
					activate_mission = RCM_JAP_game_in_progress_champion_mission
				}
				50 = {

				}
			}
			if = {
				limit = {
					NOT = {
						has_country_flag = I_won_this_match_champion
					}
				}				
				if = {
					limit = {
						has_country_flag = I_chose_keio
					}
					random_list = {
						#10 = { set_country_flag = champion_is_keio }
						10 = { set_country_flag = champion_is_rikkyo }
						10 = { set_country_flag = champion_is_hosei }
						10 = { set_country_flag = champion_is_waseda }
						10 = { set_country_flag = champion_is_meiji }
						10 = { set_country_flag = champion_is_tokyo }
					}
				}
				else_if = {
					limit = {
						has_country_flag = I_chose_rikkyo
					}
					random_list = {
						10 = { set_country_flag = champion_is_keio }
						#10 = { set_country_flag = champion_is_rikkyo }
						10 = { set_country_flag = champion_is_hosei }
						10 = { set_country_flag = champion_is_waseda }
						10 = { set_country_flag = champion_is_meiji }
						10 = { set_country_flag = champion_is_tokyo }
					}
				}
				else_if = {
					limit = {
						has_country_flag = I_chose_hosei
					}
					random_list = {
						10 = { set_country_flag = champion_is_keio }
						10 = { set_country_flag = champion_is_rikkyo }
						#10 = { set_country_flag = champion_is_hosei }
						10 = { set_country_flag = champion_is_waseda }
						10 = { set_country_flag = champion_is_meiji }
						10 = { set_country_flag = champion_is_tokyo }
					}
				}
				else_if = {
					limit = {
						has_country_flag = I_chose_waseda
					}
					random_list = {
						10 = { set_country_flag = champion_is_keio }
						10 = { set_country_flag = champion_is_rikkyo }
						10 = { set_country_flag = champion_is_hosei }
						#10 = { set_country_flag = champion_is_waseda }
						10 = { set_country_flag = champion_is_meiji }
						10 = { set_country_flag = champion_is_tokyo }
					}
				}
				else_if = {
					limit = {
						has_country_flag = I_chose_meiji
					}
					random_list = {
						10 = { set_country_flag = champion_is_keio }
						10 = { set_country_flag = champion_is_rikkyo }
						10 = { set_country_flag = champion_is_hosei }
						10 = { set_country_flag = champion_is_waseda }
						#10 = { set_country_flag = champion_is_meiji }
						10 = { set_country_flag = champion_is_tokyo }
					}
				}
				else_if = {
					limit = {
						has_country_flag = I_chose_tokyo
					}
					random_list = {
						10 = { set_country_flag = champion_is_keio }
						10 = { set_country_flag = champion_is_rikkyo }
						10 = { set_country_flag = champion_is_hosei }
						10 = { set_country_flag = champion_is_waseda }
						10 = { set_country_flag = champion_is_meiji }
						#10 = { set_country_flag = champion_is_tokyo }
					}
				}				
				random_list = {
					20 = {
						set_country_flag = I_end_up_second
						set_variable = { This.baseball_ranking = 2 }
						if = {
							limit = {
								has_country_flag = stake_level_1
							}
							set_variable = { This.reward_pp = 75 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_2
							}
							set_variable = { This.reward_pp = 150 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_3
							}
							set_variable = { This.reward_pp = 225 }
						}
						if = {
							limit = {
								has_country_flag = civies_stake_level_1
							}
							set_variable = { This.reward_civ = 3 }
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_2
							}
							set_variable = { This.reward_civ = 6 }
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_3
							}
							set_variable = { This.reward_civ = 9 }
						}
						activate_mission = RCM_JAP_game_in_progress_no_champion_mission
					}
					20 = {
						set_country_flag = I_end_up_third
						set_variable = { This.baseball_ranking = 3 }
						if = {
							limit = {
								has_country_flag = stake_level_1
							}
							set_variable = { This.reward_pp = 50 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_2
							}
							set_variable = { This.reward_pp = 100 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_3
							}
							set_variable = { This.reward_pp = 150 }
						}
						if = {
							limit = {
								has_country_flag = civies_stake_level_1
							}
							set_variable = { This.reward_civ = 2 }
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_2
							}
							set_variable = { This.reward_civ = 4 }
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_3
							}
							set_variable = { This.reward_civ = 6 }
						}
						activate_mission = RCM_JAP_game_in_progress_no_champion_mission
					}
					20 = {
						set_country_flag = I_end_up_fourth
						set_variable = { This.baseball_ranking = 4 }
						if = {
							limit = {
								has_country_flag = stake_level_1
							}
							set_variable = { This.reward_pp = 25 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_2
							}
							set_variable = { This.reward_pp = 50 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_3
							}
							set_variable = { This.reward_pp = 75 }
						}
						if = {
							limit = {
								has_country_flag = civies_stake_level_1
							}
							set_variable = { This.reward_civ = 1 }
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_2
							}
							set_variable = { This.reward_civ = 2 }
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_3
							}
							set_variable = { This.reward_civ = 3 }
						}
						activate_mission = RCM_JAP_game_in_progress_no_champion_mission
					}
					20 = {
						set_country_flag = I_end_up_fifth
						set_variable = { This.baseball_ranking = 5 }
						set_variable = { This.reward_pp = 0 }
						country_event = rcmjapan_baseball.10
					}
					20 = {
						set_country_flag = I_end_up_sixth
						set_variable = { This.baseball_ranking = 6 }
						set_variable = { This.reward_pp = 25 }
						if = {
							limit = {
								has_country_flag = stake_level_1
							}
							set_variable = { This.reward_pp = -25 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_2
							}
							set_variable = { This.reward_pp = -50 }
						}
						else_if = {
							limit = {
								has_country_flag = stake_level_3
							}
							set_variable = { This.reward_pp = -75 }
						}
						if = {
							limit = {
								has_country_flag = civies_stake_level_1
							}
							#set_variable = { This.reward_civ = -1 }
							set_country_flag = civies_finished_last_low_stake
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_2
							}
							#set_variable = { This.reward_civ = -2 }
							set_country_flag = civies_finished_last_mid_stake
						}
						else_if = {
							limit = {
								has_country_flag = civies_stake_level_3
							}
							#set_variable = { This.reward_civ = -3 }
							set_country_flag = civies_finished_last_high_stake
						}
						activate_mission = RCM_JAP_game_in_progress_no_champion_mission
					}
				}
			}
		}
	}
}
final_KL_deal = {
	random_list = {
		35 = {
			modifier = {
				NOT = {
					count_triggers = {
						amount = 1
						has_country_flag = MAN_ic_in_kl_deal
						has_country_flag = MAN_af_in_kl_deal
						has_country_flag = MAN_jews_in_kl_deal
					}
				}
				factor = 0
			}				
			country_event = { id = RCM_Manchoukuo.15 }
		}
		65 = {
			modifier = {
				USA = {
					has_opinion = {
						target = ROOT
						value > 0
					}
				}
				factor = 0.8
			}
			modifier = {
				USA = {
					has_opinion = {
						target = ROOT
						value > 10
					}
				}
				factor = 0.8
			}
			modifier = {
				USA = {
					has_opinion = {
						target = ROOT
						value > 20
					}
				}
				factor = 0.8
			}
			modifier = {
				USA = {
					has_opinion = {
						target = ROOT
						value > 30
					}
				}
				factor = 0.8
			}
			modifier = {
				USA = {
					has_opinion = {
						target = ROOT
						value > 40
					}
				}
				factor = 0.8
			}
			modifier = {
				USA = {
					has_opinion = {
						target = ROOT
						value > 50
					}
				}
				factor = 0.7
			}
			modifier = {
				USA = {
					has_opinion = {
						target = ROOT
						value > 60
					}
				}
				factor = 0.6
			}
			modifier = {
				USA = {
					has_opinion = {
						target = ROOT
						value > 70
					}
				}
				factor = 0.5
			}
			modifier = {
				NOT = {
					count_triggers = {
						amount = 1
						has_country_flag = MAN_ic_in_kl_deal
						has_country_flag = MAN_af_in_kl_deal
						has_country_flag = MAN_jews_in_kl_deal
					}
				}
				factor = 20
			}
			modifier = {
				NOT = {
					count_triggers = {
						amount = 2
						has_country_flag = MAN_ic_in_kl_deal
						has_country_flag = MAN_af_in_kl_deal
						has_country_flag = MAN_jews_in_kl_deal
					}
				}
				factor = 2
			}
			modifier = {
				count_triggers = {
					amount = 3
					has_country_flag = MAN_ic_in_kl_deal
					has_country_flag = MAN_af_in_kl_deal
					has_country_flag = MAN_jews_in_kl_deal
				}
				factor = 0.2
			}
			modifier = {
				count_triggers = {
					amount = 3
					has_country_flag = MAN_ic_in_kl_deal
					has_country_flag = MAN_af_in_kl_deal
					has_country_flag = MAN_jews_in_kl_deal
				}
				USA = {
					has_opinion = {
						target = ROOT
						value > 50
					}
				}
				factor = 0
			}
			country_event = { id = RCM_Manchoukuo.16 }
		}
	}
}
KL_af_deal = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots ={
				building = arms_factory
				size > 1
				include_locked = yes
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = arms_factory
			level = 2
			instant_build = yes
		}
		add_building_construction = {
			type = infrastructure
			level = 2
			instant_build = yes
		}
	}
	random_owned_controlled_state = {
		limit = {
			free_building_slots ={
				building = arms_factory
				size > 1
				include_locked = yes
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = arms_factory
			level = 2
			instant_build = yes
		}
		add_building_construction = {
			type = infrastructure
			level = 2
			instant_build = yes
		}
	}
}
KL_ic_deal = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots ={
				building = industrial_complex
				size > 1
				include_locked = yes
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
		add_building_construction = {
			type = infrastructure
			level = 2
			instant_build = yes
		}
	}
	random_owned_controlled_state = {
		limit = {
			free_building_slots ={
				building = industrial_complex
				size > 1
				include_locked = yes
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
		add_building_construction = {
			type = infrastructure
			level = 2
			instant_build = yes
		}
	}
	random_owned_controlled_state = {
		limit = {
			free_building_slots ={
				building = industrial_complex
				size > 1
				include_locked = yes
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
		add_building_construction = {
			type = infrastructure
			level = 2
			instant_build = yes
		}
	}
}
KL_jews_deal = {
	if = {
		limit = {
			country_exists = USA
		}
		add_opinion_modifier = {
			target = USA
			modifier = MAN_kuhn_loeb_deal
		}
		USA = {
			add_opinion_modifier = {
				target = ROOT
				modifier = MAN_kuhn_loeb_deal
			}
		}
		else = {
			random_owned_controlled_state = {
				limit = {
					free_building_slots = {
						building = industrial_complex
						size > 0
						include_locked = yes
					}
					free_building_slots = {
						building = arms_factory
						size > 0
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
				add_building_construction = {
					type = arms_factory
					level = 1
					instant_build = yes
				}
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}
	}
}
white_movement_construction_post_purge = {
	every_state = {
		limit = { 
			OR = {
				state = 408
				state = 409
				state = 657
				state = 561
				state = 563
			}
		}
		add_building_construction = {
			type = infrastructure
			level = 1
			instant_build = yes
		}
	}
	408 = {
		add_extra_state_shared_building_slots = 6
		add_building_construction = {
			type = industrial_complex
			level = 3
			instant_build = yes
		}
		add_building_construction = {
			type = arms_factory
			level = 3
			instant_build = yes
		}
	}
	409 = {
		add_extra_state_shared_building_slots = 4
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
		add_building_construction = {
			type = arms_factory
			level = 2
			instant_build = yes
		}
	}
	657 = {
		add_extra_state_shared_building_slots = 4
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
		add_building_construction = {
			type = arms_factory
			level = 2
			instant_build = yes
		}
	}
}
white_movement_construction_no_purge = {
	every_state = {
		limit = { 
			OR = {
				state = 408
				state = 409
				state = 657
				state = 561
				state = 563
			}
		}
		add_building_construction = {
			type = infrastructure
			level = 1
			instant_build = yes
		}
	}
	408 = {
		add_extra_state_shared_building_slots = 8
		add_building_construction = {
			type = industrial_complex
			level = 4
			instant_build = yes
		}
		add_building_construction = {
			type = arms_factory
			level = 4
			instant_build = yes
		}
	}
	409 = {
		add_extra_state_shared_building_slots = 6
		add_building_construction = {
			type = industrial_complex
			level = 3
			instant_build = yes
		}
		add_building_construction = {
			type = arms_factory
			level = 3
			instant_build = yes
		}
	}
	657 = {
		add_extra_state_shared_building_slots = 6
		add_building_construction = {
			type = industrial_complex
			level = 3
			instant_build = yes
		}
		add_building_construction = {
			type = arms_factory
			level = 3
			instant_build = yes
		}
	}
}
puppet_white_russia_MAN = {
	RFP = {
		hidden_effect = {
			transfer_state = 408
		}
		get_current_government_type = yes
		MAN = {
			puppet = RFP
		}
		restore_previous_government_type = yes
		hidden_effect = {
			for_each_scope_loop = {
				array = SOV.core_states
				THIS = {
					add_core_of = RFP
				}
			}
		}
	}
	hidden_effect = {
		random_enemy_country = {
			limit = {
				original_tag = SOV
			}
			every_unit_leader = {
				set_nationality = RFP
			}
			RFP = {
				annex_country = {
					target = PREV
					transfer_troops = yes
				}			
			}
		}
	}
	RFP = {
		add_to_war = {
			targeted_alliance = MAN
			enemy = SOV
		}
	}
	#
	#random_enemy_country = {
	#	limit = {
	#		original_tag = SOV
	#	}
	#	save_global_event_target_as = RFP_MAN_puppet
	#	#add_to_war = {
	#	#	targeted_alliance = MAN
	#	#	enemy = SOV
	#	#}
	#	#get_current_government_type = yes
	#	#MAN = {
	#	#	puppet = event_target:RFP_MAN_puppet
	#	#}
	#	#restore_previous_government_type = yes
	#}
	

}
puppet_white_russia_JAP = {
	random_enemy_country = {
		limit = {
			original_tag = SOV
		}
		save_global_event_target_as = RFP_JAP_puppet
		add_to_war = {
			targeted_alliance = JAP
			enemy = SOV
		}
		if = {
			limit = {
				JAP = {
					is_faction_leader = yes
				}
			}
			JAP = {
				add_to_faction = PREV
			}
		}
		hidden_effect = {
			for_each_scope_loop = {
				array = SOV.core_states
				THIS = {
					add_core_of = event_target:RFP_JAP_puppet
				}
			}
			get_current_government_type = yes
			JAP = {
				puppet = event_target:RFP_JAP_puppet
			}
			restore_previous_government_type = yes
		}			
	}
	effect_tooltip = {
		RFP = {
			JAP = {
				puppet = RFP
			}
		}
	}	
}

form_south_korea = {
	custom_effect_tooltip = form_south_korea_tt
	hidden_effect = {
		if = {
			limit = {
				country_exists = DPR
			}
			form_south_korea_proper = yes
		}
		else = {		
			var:global.south_KOR_overlord = {
				get_current_government_type = yes
			}
			DPR = {
				set_variable = { global.RCM_south_korea = THIS }
				#save_global_event_target_as = RCM_south_korea
				var:global.south_KOR_overlord = {
					if = {
						limit = {
							has_dlc = "Man the Guns"
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = global.RCM_south_korea
							autonomy_state = autonomy_supervised_state
						}
						
					}
					else = {
						puppet = global.RCM_south_korea
					}
				}
				restore_previous_government_type = yes
				#transfer_state = 999
				transfer_state = 1000 #may cause crash 
			    transfer_state = 1001
				#transfer_state = 1002
				#transfer_state = 525
				
				set_capital = { state = 525 }
				set_cosmetic_tag = KOR
				add_state_core = 525
				add_state_core = 527
				add_state_core = 1003	
				add_state_core = 1004	
				add_state_core = 1002
				add_state_core = 1001
			    add_state_core = 1000
			    add_state_core = 999
			}
			#KOR = {
			#	transfer_units_fraction = {
			#		target = DPR
			#		size = 0.3
			#	}
			#}
			var:global.south_KOR_overlord = {
				declare_war_on = { target = KOR type = annex_everything }
				var:global.RCM_south_korea = {
					add_to_war = {
						targeted_alliance = PREV
						enemy = KOR
					}
					if = {
						limit = {
							has_government = communism
						}
						set_cosmetic_tag = KOR_red
					}		
					if = {
						limit = {
							has_government = democratic
						}
						set_cosmetic_tag = KOR_blue
					}				
				}
			}	
		}
	}
}
form_south_korea_proper = {
	KOR = {
		if = {
			limit = {
				var:global.south_KOR_overlord = {
					has_government = democratic
				}
			}
			start_civil_war = {
				ideology = democratic
				size = 0.3 
				capital = 1001
				states = { 1000 1001 }
			}
		}
		else_if = {
			limit = {
				var:global.south_KOR_overlord = {
					has_government = communism
				}
			}
			start_civil_war = {
				ideology = communism
				size = 0.3 
				capital = 1001
				states = { 1000 1001 }
			}
		}
		else_if = {
			limit = {
				var:global.south_KOR_overlord = {
					has_government = fascism
				}
			}
			start_civil_war = {
				ideology = fascism
				size = 0.3 
				capital = 1001
				states = { 1000 1001 }
			}
		}
		else_if = {
			limit = {
				has_global_flag = NK_LORD_I_exist_haha_but_YOU_STARTED_IT
				var:global.south_KOR_overlord = {
					has_government = n_socialism
				}
			}
			start_civil_war = {
				ideology = democratic
				size = 0.3 
				capital = 1001
				states = { 1000 1001 }
			}
			get_current_government_type = yes
			random_enemy_country = {
				limit = {
					has_government = democratic
					NOT = {
						tag = KOR
					}
					original_tag = KOR
				}
				restore_previous_government_type = yes				
				kill_country_leader = yes
			}
		}
		else_if = {
			limit = {
				NOT = {
					has_global_flag = NK_LORD_I_exist_haha_but_YOU_STARTED_IT
				}
				var:global.south_KOR_overlord = {
					has_government = n_socialism
				}
			}
			start_civil_war = {
				ideology = n_socialism
				size = 0.3 
				capital = 1001
				states = { 1000 1001 }
			}
		}
		else_if = {
			limit = {
				has_global_flag = SK_LORD_I_exist_haha_but_YOU_STARTED_IT
				var:global.south_KOR_overlord = {
					has_government = neutrality
				}
			}
			start_civil_war = {
				ideology = democratic
				size = 0.3 
				capital = 1001
				states = { 1000 1001 }
			}
			get_current_government_type = yes
			random_enemy_country = {
				limit = {
					has_government = democratic
					NOT = {
						tag = KOR
					}
					original_tag = KOR
				}
				restore_previous_government_type = yes				
				kill_country_leader = yes
			}
		}
		else_if = {
			limit = {
				NOT = {
					has_global_flag = SK_LORD_I_exist_haha_but_YOU_STARTED_IT
				}
				var:global.south_KOR_overlord = {
					has_government = neutrality
				}
			}
			start_civil_war = {
				ideology = neutrality
				size = 0.3 
				capital = 1001
				states = { 1000 1001 }
			}
		}
		random_enemy_country = {
			limit = {
				var:global.south_KOR_overlord = {
					has_government = PREV
				}
				original_tag = KOR
			}
			set_variable = { global.RCM_south_korea = THIS }
			#save_global_event_target_as = RCM_south_korea
			#get_current_government_type = yes
			var:global.south_KOR_overlord = {
				if = {
					limit = {
						has_dlc = "Man the Guns"
						has_dlc = "Together for Victory"
					}
					set_autonomy = {
						target = global.RCM_south_korea
						autonomy_state = autonomy_supervised_state
					}
				}
				else = {
					puppet = global.RCM_south_korea
				}
			}
			if = { limit = { has_government = communism }
				add_popularity = { ideology = communism popularity = 0.75 }
			}
			if = { limit = { has_government = fascism }
				add_popularity = { ideology = fascism popularity = 0.75 }
			}
			if = { limit = { has_government = democratic }
				add_popularity = { ideology = democratic popularity = 0.75 }
			}
			if = { limit = { has_government = n_socialism }
				add_popularity = { ideology = n_socialism popularity = 0.75 }
			}
			if = { limit = { has_government = neutrality }
				add_popularity = { ideology = neutrality popularity = 0.75 }
			}
			#restore_previous_government_type = yes
		}
	}
	var:global.south_KOR_overlord = {
		declare_war_on = { target = KOR type = annex_everything }	
		var:global.RCM_south_korea = {
			add_to_war = {
				targeted_alliance = PREV
				enemy = KOR
			}
			if = {
				limit = {
					has_government = communism
				}
				set_cosmetic_tag = KOR_red
			}		
			if = {
				limit = {
					has_government = democratic
				}
				set_cosmetic_tag = KOR_blue
			}	
		}
	}
}

form_north_korea = {
	custom_effect_tooltip = form_north_korea_tt
	hidden_effect = {
		if = {
			limit = {
				country_exists = DPR
			}
			form_north_korea_proper = yes
		}
		else = {		
			var:global.north_KOR_overlord = {
				get_current_government_type = yes
			}
			DPR = {
				set_variable = { global.RCM_north_korea = THIS }
				#save_global_event_target_as = RCM_north_korea
				var:global.north_KOR_overlord = {
					if = {
						limit = {
							has_dlc = "Man the Guns"
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = global.RCM_north_korea
							autonomy_state = autonomy_supervised_state
						}
					}
					else = {
						puppet = global.RCM_north_korea
					}
				}
				restore_previous_government_type = yes
				transfer_state = 527
				#transfer_state = 1003
			    transfer_state = 1004
				set_capital = { state = 527 }
				set_cosmetic_tag = KOR
				add_state_core = 525
				add_state_core = 527
				add_state_core = 1003	
				add_state_core = 1004	
				add_state_core = 1002
				add_state_core = 1001
			    add_state_core = 1000
			    add_state_core = 999
			}
			KOR = {
				transfer_units_fraction = {
					target = DPR
					size = 0.3
				}
			}
			var:global.north_KOR_overlord = {
				declare_war_on = { target = KOR type = annex_everything }
				var:global.RCM_north_korea = {
					add_to_war = {
						targeted_alliance = PREV
						enemy = KOR
					}
					if = {
						limit = {
							has_government = communism
						}
						set_cosmetic_tag = KOR_red
					}		
					if = {
						limit = {
							has_government = democratic
						}
						set_cosmetic_tag = KOR_blue
					}	
				}
			}			
		}
	}
}
form_north_korea_proper = {
	KOR = {
		if = {
			limit = {
				var:global.north_KOR_overlord = {
					has_government = democratic
				}
			}
			start_civil_war = {
				ideology = democratic
				size = 0.3 
				capital = 527
				states = { 1004 527 }
			}
		}
		else_if = {
			limit = {
				var:global.north_KOR_overlord = {
					has_government = communism
				}
			}
			start_civil_war = {
				ideology = communism
				size = 0.3 
				capital = 527
				states = { 1004 527 }
			}
		}
		else_if = {
			limit = {
				var:global.north_KOR_overlord = {
					has_government = fascism
				}
			}
			start_civil_war = {
				ideology = fascism
				size = 0.3 
				capital = 527
				states = { 1004 527 }
			}
		}
		else_if = {
			limit = {
				has_global_flag = NK_LORD_I_exist_haha_but_YOU_STARTED_IT
				var:global.north_KOR_overlord = {
					has_government = n_socialism
				}
			}
			start_civil_war = {
				ideology = fascism
				size = 0.3 
				capital = 527
				states = { 1004 527 }
			}
			get_current_government_type = yes
			random_enemy_country = {
				limit = {
					has_government = fascism
					NOT = {
						tag = KOR
					}
					original_tag = KOR
				}				
				restore_previous_government_type = yes
				kill_country_leader = yes
			}
		}
		else_if = {
			limit = {
				NOT = { has_global_flag = NK_LORD_I_exist_haha_but_YOU_STARTED_IT }
				var:global.north_KOR_overlord = {
					has_government = neutrality
				}
			}
			start_civil_war = {
				ideology = fascism
				size = 0.3 
				capital = 527
				states = { 1004 527 }
			}
			get_current_government_type = yes
			random_enemy_country = {
				limit = {
					has_government = fascism
					NOT = {
						tag = KOR
					}
					original_tag = KOR
				}				
				restore_previous_government_type = yes
				kill_country_leader = yes
			}
		}
		else_if = {
			limit = {
				has_global_flag = SK_LORD_I_exist_haha_but_YOU_STARTED_IT
				var:global.north_KOR_overlord = {
					has_government = neutrality
				}
			}
			start_civil_war = {
				ideology = neutrality
				size = 0.3 
				capital = 527
				states = { 1004 527 }
			}
		}
		else_if = {
			limit = {
				NOT = { has_global_flag = SK_LORD_I_exist_haha_but_YOU_STARTED_IT }
				var:global.north_KOR_overlord = {
					has_government = neutrality
				}
			}
			start_civil_war = {
				ideology = neutrality
				size = 0.3 
				capital = 527
				states = { 1004 527 }
			}
		}
		random_enemy_country = {
			limit = {
				var:global.north_KOR_overlord = {
					has_government = PREV
				}
				original_tag = KOR
			}
			set_variable = { global.RCM_north_korea = THIS }
			#save_global_event_target_as = RCM_north_korea
			#get_current_government_type = yes
			var:global.north_KOR_overlord = {
				if = {
					limit = {
						has_dlc = "Man the Guns"
						has_dlc = "Together for Victory"
					}
					set_autonomy = {
						target = var:global.RCM_north_korea
						autonomy_state = autonomy_supervised_state
					}
				}
				else = {
					puppet = var:global.RCM_north_korea
				}
			}
			if = { limit = { has_government = communism }
				add_popularity = { ideology = communism popularity = 0.75 }
			}
			if = { limit = { has_government = fascism }
				add_popularity = { ideology = fascism popularity = 0.75 }
			}
			if = { limit = { has_government = democratic }
				add_popularity = { ideology = democratic popularity = 0.75 }
			}
			if = { limit = { has_government = n_socialism }
				add_popularity = { ideology = n_socialism popularity = 0.75 }
			}
			if = { limit = { has_government = neutrality }
				add_popularity = { ideology = neutrality popularity = 0.75 }
			}
			#restore_previous_government_type = yes
		}
	}
	var:global.north_KOR_overlord = {
		declare_war_on = { target = KOR type = annex_everything }
	}
	var:global.RCM_north_korea = {
		add_to_war = {
			targeted_alliance = event_target:north_KOR_overlord
			enemy = KOR
		}
		if = {
			limit = {
				has_government = communism
			}
			set_cosmetic_tag = KOR_red
		}		
		if = {
			limit = {
				has_government = democratic
			}
			set_cosmetic_tag = KOR_blue
		}	
	}
}

unbalanced_industry_level_down = {
	if = {
		limit = {
			has_idea = unbalanced_industry
		}
		swap_ideas = {
			remove_idea = unbalanced_industry
			add_idea = unbalanced_industry_1
		}
	}
	else_if = {
		limit = {
			has_idea = unbalanced_industry_1
		}
		swap_ideas = {
			remove_idea = unbalanced_industry_1
			add_idea = unbalanced_industry_2
		}
	}
	else_if = {
		limit = {
			has_idea = unbalanced_industry_2
		}
		swap_ideas = {
			remove_idea = unbalanced_industry_2
			add_idea = unbalanced_industry_3
		}
	}
	else_if = {
		limit = {
			has_idea = unbalanced_industry_3
		}
		remove_ideas = unbalanced_industry_3
	}
	#==========================#
	else_if = {
		limit = {
			has_idea = MAN_unbalanced_industry
		}
		swap_ideas = {
			remove_idea = MAN_unbalanced_industry
			add_idea = MAN_unbalanced_industry_1
		}
	}
	else_if = {
		limit = {
			has_idea = MAN_unbalanced_industry_1
		}
		swap_ideas = {
			remove_idea = MAN_unbalanced_industry_1
			add_idea = MAN_unbalanced_industry_2
		}
	}
	else_if = {
		limit = {
			has_idea = MAN_unbalanced_industry_2
		}
		swap_ideas = {
			remove_idea = MAN_unbalanced_industry_2
			add_idea = MAN_unbalanced_industry_3
		}
	}
	else_if = {
		limit = {
			has_idea = MAN_unbalanced_industry_3
		}
		remove_ideas = MAN_unbalanced_industry_3
	}	
}
clear_all_add_navy_dominant = {
	if = {
		limit = {
			has_idea = JAP_interservice_rivalry_army_dominant
		}
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_army_dominant
			add_idea = JAP_interservice_rivalry_navy_dominant
		}
	}
	else_if = {
		limit = {
			has_idea = JAP_interservice_rivalry_army_strengthened
		}
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_army_strengthened
			add_idea = JAP_interservice_rivalry_navy_dominant
		}
	}
	else_if = {
		limit = {
			has_idea = JAP_interservice_rivalry_balanced
		}
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_balanced
			add_idea = JAP_interservice_rivalry_navy_dominant
		}
	}
	else_if = {
		limit = {
			has_idea = JAP_interservice_rivalry_navy_strengthened
		}
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_navy_strengthened
			add_idea = JAP_interservice_rivalry_navy_dominant
		}
	}
}

clear_all_cabinet_members_JAP = {
	if = {
		limit = {
			has_idea = sanzo_nosaka
		}
		remove_ideas = sanzo_nosaka
	}
	if = {
		limit = {
			has_idea = kijuro_shidehara
		}
		remove_ideas = kijuro_shidehara
	}
	if = {
		limit = {
			has_idea = aso_hisashi
		}
		remove_ideas = aso_hisashi
	}
	if = {
		limit = {
			has_idea = kingoro_hashimoto
		}
		remove_ideas = kingoro_hashimoto
	}
	if = {
		limit = {
			has_idea = mitsumasa_yonai
		}
		remove_ideas = mitsumasa_yonai
	}
	if = {
		limit = {
			has_idea = saionji_kinmochi
		}
		remove_ideas = saionji_kinmochi
	}
	if = {
		limit = {
			has_idea = hideki_tojo
		}
		remove_ideas = hideki_tojo
	}
	if = {
		limit = {
			has_idea = kanji_ishiwara
		}
		remove_ideas = kanji_ishiwara
	}
	if = {
		limit = {
			has_idea = fumimaro_konoe
		}
		remove_ideas = fumimaro_konoe
	}
	if = {
		limit = {
			has_idea = hisaichi_terauchi
		}
		remove_ideas = hisaichi_terauchi
	}
	if = {
		limit = {
			has_idea = chiune_sugihara
		}
		remove_ideas = chiune_sugihara
	}
	if = {
		limit = {
			has_idea = ikki_kita
		}
		remove_ideas = ikki_kita
	}
	if = {
		limit = {
			has_idea = makino_nobuaki
		}
		remove_ideas = makino_nobuaki
	}
	if = {
		limit = {
			has_idea = hachiro_arita
		}
		remove_ideas = hachiro_arita
	}
	if = {
		limit = {
			has_idea = suzuki_kisaburo
		}
		remove_ideas = suzuki_kisaburo
	}
	if = {
		limit = {
			has_idea = mineo_osumi
		}
		remove_ideas = mineo_osumi
	}
}

clear_prvious_election_flags = {
	clr_country_flag = nomination_process_is_done
	clr_country_flag = CNSP_candidate_is_fulin
	clr_country_flag = KMT_candidate_is_sun_fo
	clr_country_flag = CDL_candidate_is_junru
}

democratize_the_parties = {
	if = {#guo
		limit = { tag = event_target:WTT_communist_china not = { country_exists = CHI } }
			event_target:WTT_communist_china = {
			
				clear_global_event_target = WTT_current_china_leader
			
				every_unit_leader = { set_nationality = CHI }
				every_character = { set_nationality = CHI }
				transfer_navy = {
					target = CHI
				}
				every_subject_country = {
					every_unit_leader = { set_nationality = CHI }
					transfer_navy = {
						target = CHI
					}
					CHI = { annex_country = { target = PREV transfer_troops = yes } }
				}
			}
			
			CHI = {
			
			save_global_event_target_as = WTT_current_china_leader
			
			annex_country = {
				target = event_target:WTT_communist_china transfer_troops = yes
			}
			
			add_ideas = prc_kmt_lianhezhengfu
			add_ideas = CHI_communist_in_government
			custom_effect_tooltip = CHI_communist_in_government_tt
			set_party_name = {
				ideology = communism
				name = PRC_communism_party
				long_name = PRC_communism_party_long
			}
			
			change_tag_from = event_target:WTT_communist_china
			
			add_war_support_add_commie_leader = yes
			
			}
			
	}
	
	event_target:WTT_current_china_leader = {#guo
	
	set_party_name = {
	    ideology = neutrality
	    long_name = CHI_neutrality_CC_party_long
	    name = CHI_neutrality_CC_party
	}
	create_country_leader = {
		name = chen_guofu
		desc = ""
		picture = "Portrait_CHI_Chen_Guofu.dds"
		expire = "1965.1.1"
		ideology = sanmin_political_tutelage
		traits = {
			backroom_backstabber
		}
	}
	create_country_leader = {
		name = dai_li
		desc = ""
		picture = "Portrait_CHI_Dai_Li.dds"
		expire = "1965.1.1"
		ideology = fascism_ideology
		traits = {
			prince_of_terror
		}
	}
	hidden_effect = {
		set_politics = {
			ruling_party = democratic
			elections_allowed = yes
		}
	}
	
	}
}



ETR_politics_no_ETR = {
	set_party_name = { ideology = communism name = SIK_Xinjiang_defend_peace_and_democracy_alliance long_name = SIK_Xinjiang_defend_peace_and_democracy_alliance_long }
	set_party_name = { ideology = fascism long_name = SIK_Yining_Liberation_Organization_long name = SIK_Yining_Liberation_Organization }
	#set_party_name = { ideology = neutrality long_name = SIK_China_nationalist_party name = SIK_Kuomintang }
	set_party_name = { ideology = democratic long_name = SIK_Democratic_alliance name = SIK_Democratic_alliance }
	if = {
		limit = {
			has_idea = SIK_Autocracy
		}
		remove_ideas = SIK_Autocracy
	}
	create_country_leader = {
		name = "Abdulkerim Abbas"
		desc = "POLITICS_ABDULKERIM_ABBAS_DESC"
		picture = "Portrait_Sinkiang_Abdulkerim_Abbas.dds"
		expire = "1965.1.1"
		ideology = marxism
		traits = {
			indomitable_perseverance
		}
	}
	#create_country_leader = {
	#	name = "Ospan Batyr"
	#	desc = "POLITICS_OSPAN_BATYR_DESC"
	#	picture = "Portrait_Sinkiang_Ospan_Batyr.dds"
	#	expire = "1965.1.1"
	#	ideology = despotism
	#	traits = {
	#		spirit_of_genghis
	#		anti_communist
	#	}
	#}
	create_country_leader = {
		name = "Muhammad Amin Bughra"
		desc = "POLITICS_SHENG_SHICAI_DESC"
		picture = "Portrait_Sinkiang_Amin.dds"
		expire = "1970.1.7"
		ideology = fascism_ideology
		traits = {
			#
		}
	}
	#create_country_leader = {
	#	name = "Elihan Tore"
	#	desc = "POLITICS_ELIHAN_TORE_DESC"
	#	picture = "Portrait_Sinkiang_Elihan_Tore.dds"
	#	expire = "1965.1.1"
	#	ideology = despotism
	#	traits = {
	#	}
	#}
	create_country_leader = {
		name = Masud_Sabri
		desc = "POLITICS_MASUD_SABRI_DESC"
		picture = "Portrait_Sinkiang_Masud_Sabri.dds"
		expire = "1965.1.1"
		ideology = conservatism
		traits = {

		}
	}
}
ETR_politics = {
	set_cosmetic_tag = SIK_KMT
	set_party_name = { ideology = communism name = SIK_Xinjiang_defend_peace_and_democracy_alliance long_name = SIK_Xinjiang_defend_peace_and_democracy_alliance_long }
	set_party_name = { ideology = fascism long_name = SIK_committee_for_national_revolution_long name = SIK_committee_for_national_revolution }
	set_party_name = { ideology = neutrality long_name = SIK_China_nationalist_party name = SIK_Kuomintang }
	set_party_name = { ideology = democratic long_name = SIK_Democratic_alliance name = SIK_Democratic_alliance }
	remove_ideas = SIK_Autocracy
	create_country_leader = {
		name = "Muhammad Amin Bughra"
		desc = "POLITICS_ABDULKERIM_ABBAS_DESC"
		picture = "Portrait_Sinkiang_Abdulkerim_Abbas.dds"
		expire = "1965.1.1"
		ideology = marxism
		traits = {
			indomitable_perseverance
		}
	}
	create_country_leader = {
		name = SIK_ospan_batyr
		desc = "POLITICS_OSPAN_BATYR_DESC"
		picture = "Portrait_Sinkiang_Ospan_Batyr.dds"
		expire = "1965.1.1"
		ideology = despotism
		traits = {
			spirit_of_genghis
			anti_communist
		}
	}
	#create_country_leader = {
	#	name = "Elihan Tore"
	#	desc = "POLITICS_ELIHAN_TORE_DESC"
	#	picture = "Portrait_Sinkiang_Elihan_Tore.dds"
	#	expire = "1965.1.1"
	#	ideology = rexism
	#	traits = {
	#		inexperienced_imperialist
	#		warmonger
	#	}
	#}
	create_country_leader = {
		name = "Muhammad Amin Bughra"
		desc = "POLITICS_SHENG_SHICAI_DESC"
		picture = "Portrait_Sinkiang_Amin.dds"
		expire = "1970.1.7"
		ideology = fascism_ideology
		traits = {
			#
		}
	}
	SIK_masud_sabri = {
		add_country_leader_role = {
			promote_leader = yes
			country_leader = {
				expire = "1965.1.1"
				ideology = conservatism
				traits = { }            
			} 
		} 
	}
}
create_SIK_generals = {
	create_corps_commander = {
		name = Peter_Romanovich_Aleksandrov
		id = 2895
		portrait_path = "gfx/leaders/Europe/Portrait_Europe_Generic_land_2.dds"
		traits = {  }
		skill = 1
		attack_skill = 2
		defense_skill = 1
		planning_skill = 1
		logistics_skill = 1
	}
	create_corps_commander = {
		name = Ivan_J_Polinov
		id = 2894
		portrait_path = "gfx/leaders/Europe/Portrait_Europe_Generic_land_3.dds"
		traits = {  }
		skill = 2
		attack_skill = 2
		defense_skill = 2
		planning_skill = 1
		logistics_skill = 2
	}
	create_corps_commander = {
		name = Dalelkhan_Sugirbayev
		id = 2893
		portrait_path = "gfx/leaders/SIK/Dalelkhan_Sugirbayev.dds"
		traits = {  }
		skill = 2
		attack_skill = 2
		defense_skill = 2
		planning_skill = 1
		logistics_skill = 2
	}
	create_corps_commander = {
		name = Fatih_Muslimov
		id = 2892
		portrait_path = "gfx/leaders/SIK/Fatih_Muslimov.dds"
		traits = {  }
		skill = 1
		attack_skill = 2
		defense_skill = 1
		planning_skill = 1
		logistics_skill = 1
	}
	create_corps_commander = {
		name = SIK_Ishaq_Beg_munonov
		id = 2891
		portrait_path = "gfx/leaders/SIK/Ishaq_Beg_Munonov.dds"
		traits = {  }
		skill = 2
		attack_skill = 2
		defense_skill = 2
		planning_skill = 1
		logistics_skill = 2
	}
	create_corps_commander = {
		name = SIK_ospan_batyr
		id = 2900
		picture = "Portrait_Sinkiang_Ospan_Batyr.dds"
		traits = {  }
		skill = 3
		attack_skill = 2
		defense_skill = 3
		planning_skill = 3
		logistics_skill = 2
	}
	create_corps_commander = {
		name = "Abdulkerim Abbas"
		id = 2890
		picture = "Portrait_Sinkiang_Abdulkerim_Abbas.dds"
		traits = {  }
		skill = 3
		attack_skill = 2
		defense_skill = 3
		planning_skill = 2
		logistics_skill = 3
	}
}
RRC_PREP = {#used in complete_effect
	hidden_effect = {
		set_country_flag = im_making_or_have_made_rrc
		
		if = {
			limit = {
				any_other_country = {
					is_legit_china = yes
					NOT = {
						is_subject_of = JAP
					}
				}
			}
			news_event = {
				days = 25 id = efm_news.1012
			}
			set_global_flag = wangjingwei_defect#guo
		}
	}
}
JNC_DETERMINE = { #used in complete_effect
	hidden_effect = {
		####DETERMINE
		if = {
			limit = {
				HPC = {
					is_puppet_of = JAP
				}
			}
			if = {
				limit = {
					EHB = {
						is_ai = no
					}
					HPC = {
						is_ai = yes
					}
				}
				EHB = {
					annex_country = {
						target = HPC
						transfer_troops = yes
					}
					set_country_flag = im_jnc_now
					save_global_event_target_as = JNC_PUPPET_JAP
				}
				else = {
					HPC = {
						annex_country = {
							target = EHB
							transfer_troops = yes
						}
						set_country_flag = im_jnc_now
						save_global_event_target_as = JNC_PUPPET_JAP
					}
				}
			}			
		}
		else = {
			EHB = {
				set_country_flag = im_jnc_now
				save_global_event_target_as = JNC_PUPPET_JAP
			}
		}
	}
}
max_infra_effect = {
	custom_effect_tooltip = max_infra
	hidden_effect = {
		add_building_construction = {
			type = infrastructure
			level = 5
			instant_build = yes
		}
	}
}
level_3_infra = {
	custom_effect_tooltip = level_3_infra_tt
	hidden_effect = {
        if = {
			limit = {
				free_building_slots = {
					building = infrastructure
					size > 3
				}
			}
			add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
			}
		}
		if = {
			limit = {
				free_building_slots = {
					building = infrastructure
					size > 3
				}
				free_building_slots = {
					building = infrastructure
					size < 5
				}
			}
			add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
			}
		}
		if = {
			limit = {
				free_building_slots = {
					building = infrastructure
					size > 3
				}
				free_building_slots = {
					building = infrastructure
					size < 5
				}
			}
			add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
			}
		}
	}
}
level_6_infra = {
	custom_effect_tooltip = level_6_infra_tt
	hidden_effect = {
	if = {
		limit = {
			free_building_slots = {
				building = infrastructure
				size > 2
			}
			free_building_slots = {
				building = infrastructure
				size < 4
			}
		}
		add_building_construction = {
			type = infrastructure
			level = 1
			instant_build = yes
		}
	}
	if = {
		limit = {
			free_building_slots = {
				building = infrastructure
				size > 2
			}
			free_building_slots = {
				building = infrastructure
				size < 4
			}
		}
		add_building_construction = {
			type = infrastructure
			level = 1
			instant_build = yes
		}
	}
	if = {
		limit = {
			free_building_slots = {
				building = infrastructure
				size > 2
			}
			free_building_slots = {
				building = infrastructure
				size < 4
			}
		}
		add_building_construction = {
			type = infrastructure
			level = 1
			instant_build = yes
		}
	}
	}
}
RRC_core = {
	add_state_core = 609
	add_state_core = 744
	add_state_core = 743
    add_state_core = 613
	add_state_core = 592
	add_state_core = 597
	add_state_core = 1028
	add_state_core = 614
	add_state_core = 608
	add_state_core = 596
	add_state_core = 595
	add_state_core = 1033
	add_state_core = 591
	add_state_core = 600
	add_state_core = 620
	add_state_core = 325
	add_state_core = 747
	add_state_core = 603
	add_state_core = 748
	add_state_core = 749
	add_state_core = 606
	add_state_core = 1015
	add_state_core = 598
	add_state_core = 607
	add_state_core = 615
	add_state_core = 1027
	add_state_core = 622
	add_state_core = 605
	add_state_core = 753
	add_state_core = 1023
	add_state_core = 1041
	add_state_core = 326
	add_state_core = 602
	add_state_core = 750
	add_state_core = 599
	add_state_core = 1039
	add_state_core = 1038
	add_state_core = 593
	add_state_core = 1036
	add_state_core = 594
	add_state_core = 752
	add_state_core = 751
	add_state_core = 729
	add_state_core = 728
	add_state_core = 1017
	add_state_core = 1016
	add_state_core = 1029
	add_state_core = 1030
	add_state_core = 1032
    add_state_core = 1034
    add_state_core = 1035
	add_state_core = 1037
	add_state_core = 1040
    add_state_core = 1042
	add_state_core = 1043
    add_state_core = 991
	add_state_core = 997
	add_state_core = 998
	add_state_claim = 756
    add_state_claim = 1047
    add_state_claim = 1045
	add_state_claim = 754
	add_state_claim = 756
	add_state_claim = 604
	add_state_claim = 755
	add_state_claim = 1013
	add_state_claim = 283
	add_state_claim = 1044
	add_state_claim = 1053
	add_state_claim = 616
	add_state_claim = 611
	add_state_claim = 612
	add_state_claim = 621
	add_state_claim = 746
	add_state_claim = 1019
	add_state_claim = 1020
	add_state_claim = 1014
	add_state_claim = 1012
    add_state_claim = 1031
	add_state_claim = 1062
}
peace_with_japan_land_partition = {
	effect_tooltip = {
		white_peace = JAP
	}
	hidden_effect = {
		every_state = {
			limit = {
				is_in_array = { global.small_china = This.id } #MODDED
				OWNER = {
					OR = {
						tag = JAP
						is_subject_of = JAP
					}
				}
				CONTROLLER = {
					is_literally_china = yes
					has_war_with = JAP
				}
			}
			CONTROLLER = {
				transfer_state = PREV
			}
		}
		JAP = {			
			every_enemy_country = {
				limit = {
					OR = {
						tag = ROOT
						has_war_together_with = ROOT
						tag = event_target:scp_war_opposition_leader
						has_war_together_with = event_target:scp_war_opposition_leader
					}
				}
				#if = {
				#	limit = {
				#		NOT = {
				#			is_literally_china = yes
				#		}
				#		is_faction_leader = yes
				#	}
				#	country_event = { days = 3 id = rcmsoviet.26 }
				#}
				if = {
					limit = {
						OR = {
							is_literally_china = yes
							any_allied_country = {
								is_literally_china = yes
							}
						}
					}
					white_peace = JAP
				}				
			}
		}
		#every_enemy_country = {
		#	limit = {
		#		OR = {
		#			tag = JAP
		#			AND = {
		#				has_war_together_with = JAP
		#				OR = {
		#					is_subject_of = JAP
		#					is_in_faction_with = JAP
		#				}
		#			}
		#		}
		#	}
		#	white_peace = ROOT
		#	white_peace = event_target:scp_war_opposition_leader
		#}
		JAP = {
			every_owned_state = {
				limit = {
					#country_exists = FIC
					is_core_of = FIC
				}
				FIC = {
					transfer_state = PREV
				}
			}
		}
		FIC = {
			white_peace = JAP
		}
		news_event = RCM_news.2
	}
	#if = {
	#	
	#}
	#JAP = {
	#	drop_lands_in_china = yes
	#}
	JAP = {
		release = KOR
	}
	event_target:WTT_current_china_leader = {
		transfer_state = 524
		if = {
			limit = {
				RFM = {
					is_puppet_of = JAP
				}
			}
			annex_country = {
				target = RFM transfer_troops = no
			}
		}
		if = {
			limit = {
				EHB = {
					is_puppet_of = JAP
				}
			}
			annex_country = {
				target = EHB transfer_troops = no
			}
		}
	}
}
create_mengjiang = {
	custom_effect_tooltip = MEN_reform
	add_state_core = 612
	add_state_core = 611
	add_state_core = 621
	add_state_core = 746
	add_state_core = 1014
	add_state_core = 1013
	add_state_core = 330
	add_state_core = 817
	add_state_core = 818
	add_state_core = 1025
	add_state_core = 1026
	add_state_core = 819
	add_state_core = 820
	add_state_core = 1024
	add_state_core = 1018
	hidden_effect = {
		612 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		611 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		1014 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		1013 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		330 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		817 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		818 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		1025 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		1026 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		819 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		820 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		1024 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
		1018 = {
			if = {
				limit = {
					ECA_transfer_state_trigger = yes
				}
				set_state_province_controller = {
					controller = ECA
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				ECA = {
					set_state_owner = PREV
				}
			}
		}
	}
	hidden_effect = {
		ECA = {
			save_global_event_target_as = NewPuppet
			save_global_event_target_as = RCM_MEJ_puppet
			drop_cosmetic_tag = yes
			set_cosmetic_tag = MEJ
			set_political_party = {
				ideology = neutrality
				popularity = 30
			}
			add_popularity = {
				ideology = fascism
				popularity = 70
			}
			add_popularity = {
				ideology = n_socialism
				popularity = 0
			}
			set_politics = {
				ruling_party = fascism
				elections_allowed = no
			}
		    set_party_name = {
		        ideology = neutrality 
		        name = "MJC"
		        long_name = "Mengjiang Joint Committee"
	        }   
		    set_party_name = {
		        ideology = fascism
		        name = ECA_mjc_party
		        long_name = ECA_mjc_party_long
	        }  
		
		}
		set_global_flag = mej_exists
		news_event = { id = RCM_news.5 }
	}
}
#HUGE
RRC_CREATION = {
	####CORE&ANNEX
	save_global_event_target_as = NewPuppet
	save_global_event_target_as = RCM_RRC_puppet
	set_country_flag = im_rrc_now
	set_global_flag = rrc_exists
	for_each_scope_loop = {
		array = RFM.core_states
		THIS = {
			remove_core_of = RFM
		}
	}
	for_each_scope_loop = {
		array = EHB.core_states
		THIS = {
			remove_core_of = EHB
		}
	}
	for_each_scope_loop = {
		array = HPC.core_states
		THIS = {
			if = {
				limit = {
					HPC = {
						is_subject_of = JAP
					}
				}
				remove_core_of = HPC
			}
		}
	}
	RRC_core = yes
	if = {
		limit = {
			NOT = {
				tag = RFM
			}
		}
		RFM = {
			every_unit_leader = {
				set_nationality = PREV
			}
		}
		annex_country = {
			target = RFM
			transfer_troops = yes
		}		
	}
	else_if = {
		limit = {
			HPC = {
				is_subject_of = JAP
			}
		}
		HPC = {
			every_unit_leader = {
				set_nationality = PREV
			}
		}
		annex_country = {
			target = HPC
			transfer_troops = yes
		}
	}
	else = {
		EHB = {
			every_unit_leader = {
				set_nationality = PREV
			}
		}
		annex_country = {
			target = EHB
			transfer_troops = yes
		}
	}
	####STATES
	for_each_scope_loop = {
		array = RCM_RRC_puppet.core_states
		THIS = {
			if = {
				limit = {
					NOT = {
						is_owned_by = ECA
						AND = {
							is_owned_by = XSM
							XSM = {
								is_subject_of = JAP
							}
						}
					}
					OR = {
						is_owned_by_CHI_PRC_WARLORD_SIK = yes
						is_owned_by = JAP
					}
					is_controlled_by_jap_or_its_puppet = yes
				}
				set_state_province_controller = {
					controller = event_target:RCM_RRC_puppet
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}				
				if = {
					limit = {
						is_owned_by = JAP
					}
					event_target:RCM_RRC_puppet = {
						set_state_owner = PREV
					}
				}
			}
		}
	}
	#####HIST
	set_cosmetic_tag = RRC
	set_political_party = {
		ideology = neutrality
		popularity = 30
	}
	set_political_party = {
		ideology = n_socialism
		popularity = 0
	}
	set_political_party = {
		ideology = fascism
		popularity = 70
	}
	set_politics = {
		ruling_party = fascism
		elections_allowed = no
	}
	
	#guo
	set_country_flag = i_am_wangjingwei
	random_country = {
	limit = { has_country_flag = i_am_wangjingwei }
	event_target:WTT_current_china_leader = { CHI_wangjingwei_zz = { set_nationality = PREV } }
	}
	create_country_leader = {
		name = Wang_Jingwei
		desc=CHI_wangjingwei_zz_desc
		picture = "gfx/leaders/RRC/Portrait_Wang.dds"
		expire = "1965.1.1"
		ideology = collaborationism
		traits = {#guo
		quxianjiuguo
		wencaiyiyi
		eager_collaborator
		wushinuli
		}
	}
	set_party_name = {
		ideology = fascism
		name = CHI_WANG_neutrality_party
		long_name = CHI_WANG_neutrality_party_long
	}
	army_experience = 50
	load_oob = RRC_focus
    #delete_unit_template_and_units = { division_template = "Luchn Shih" } 	
    #delete_unit_template_and_units = { division_template = "T'iaocheng Shih" } 
    #delete_unit_template_and_units = { division_template = "Chengli Shih" } 
    #delete_unit_template_and_units = { division_template = "Ch'iping Shih" } 
    #delete_unit_template_and_units = { division_template = "Tuli L" }  
    #delete_unit_template_and_units = { division_template = "Tuli Ch'iping L" }  
	set_capital = { state = 1015 }
	for_each_scope_loop = {
		array = RCM_RRC_puppet.core_states
		THIS = {
			if = {
				limit = {
					is_controlled_by_jap_or_its_puppet = yes
					is_owned_by_jap_or_its_puppet = yes
					NOT = {
						OR = {
							is_owned_by = event_target:RCM_RRC_puppet
							is_controlled_by = event_target:RCM_RRC_puppet
						}
					}
				}
				set_state_province_controller = {
					controller = event_target:RCM_RRC_puppet
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
				event_target:RCM_RRC_puppet = {
					set_state_owner = PREV
				}
			}
		}
	}
	hidden_effect = { news_event = { id = RCM_news.5 }}
}
JNC_CREATION = {
	hidden_effect = {
		save_global_event_target_as = NewPuppet
		save_global_event_target_as = RCM_JNC_puppet
		transfer_state = 608
		set_state_owner = 609 
		608 = {
			set_state_province_controller = {
				controller = event_target:RCM_JNC_puppet
				limit = {
					OR = {
						tag = JAP
						has_war_together_with = JAP
					}
				}
			}
		}
		add_state_core = 614
		add_state_core = 615
		add_state_core = 1017
		add_state_core = 998
		add_state_core = 1027
		add_state_core = 608
		add_state_core = 609
		add_state_core = 597
		add_state_core = 1028
		add_state_core = 607
		add_state_core = 743
            for_each_scope_loop = {
			array = RCM_JNC_puppet.core_states
			THIS = {				
				if = {
					limit = {
						is_controlled_by_jap_or_its_puppet = yes
					}
					set_state_province_controller = {
						controller = event_target:RCM_JNC_puppet
						limit = {
							OR = {
								tag = JAP
								has_war_together_with = JAP
							}
						}
					}
				}
			}
		}
		load_oob = JNC_prov_focus
		#delete_unit_template_and_units = { division_template = "Luchn Shih" }
        #delete_unit_template_and_units = { division_template = "T'iaocheng Shih" } 
        #delete_unit_template_and_units = { division_template = "Chengli Shih" } 
        #delete_unit_template_and_units = { division_template = "Ch'iping Shih" } 
        #delete_unit_template_and_units = { division_template = "Tuli L" }  
        #delete_unit_template_and_units = { division_template = "Tuli Ch'iping L" }  		
		set_capital = { state = 608 }
		set_cosmetic_tag = JNC
		set_global_flag = jnc_exists
		set_country_flag = im_jnc_now
		event_target:WTT_current_china_leader = {
			ROOT = {
				add_to_war = {
					targeted_alliance = JAP
					enemy = PREV
				}
			}			
		}		
		add_popularity = {
			ideology = fascism
			popularity = 0.7
		}
		set_party_name = { #
		    ideology = fascism
		    name = JNC_NPS_party
		    long_name = JNC_NPS_party_long
	    }   
		set_politics = {
			ruling_party = fascism
			elections_allowed = no
		}
		if = {
			limit = {
				tag = HPC
				EHB = {
					is_ai = yes
				}
			}
			annex_country = {
				target = EHB transfer_troops = yes
			}
		}
		if = {
			limit = {
				tag = EHB
				HPC = {
					is_subject_of = JAP
					is_ai = yes
				}
			}
			annex_country = {
				target = HPC transfer_troops = yes
			}
		}
		create_country_leader = {
			name = Wang_Kemin
			desc = "POLITICS_WANG_KEMIN_DESC"
			picture = "gfx/leaders/JNC/Portrait_JNC_Wang_Kemin.dds"
			expire = "1945.12.25"
			ideology = collaborationism
		}
		army_experience = 50
		if = {
			limit = {
				tag = HPC
			}
			load_focus_tree = { tree = japan_puppet_focus keep_completed = yes }
			add_ideas = JPG_illegal_regime_1
		}
		if = { #in case of rebuilding, sometimes it is independent and not has east hebei
			limit = {
				tag = EHB
				EHB = {
					NOT = {
						is_subject_of = JAP
					}
				}
			}
			EHB = {
				get_current_government_type = yes
			}
			JAP = {
				puppet = EHB
			}
			EHB = {
				restore_previous_government_type = yes
			}
			if = {
				limit = {
					609 = {
						is_controlled_by_jap_or_its_puppet = yes
					}
				}
				EHB = {
					set_state_owner = 609		
				}
				609 = {
					set_state_province_controller = {
						controller = EHB
						limit = {
							OR = {
								tag = JAP
								has_war_together_with = JAP
							}
						}
					}
				}
			}
		}
		news_event = { id = RCM_news.5 }
	}
	effect_tooltip = {
		JNC = {
			add_state_core = 614
			add_state_core = 615
			add_state_core = 1017
			add_state_core = 998
			add_state_core = 1027
			add_state_core = 608
			add_state_core = 609
			add_state_core = 597
			add_state_core = 1028
			add_state_core = 607
		    add_state_core = 743
        }
	}
	custom_effect_tooltip = JNC_prov_focus
}

RFM_CREATION = {
	hidden_effect = {
		set_global_flag = rfm_exists
		RFM = {
			save_global_event_target_as = NewPuppet
			save_global_event_target_as = RCM_RFM_puppet
			CCP = {
				every_unit_leader = {
					set_nationality = RFM
				}
			}
			annex_country = {
				target = CCP
				transfer_troops = yes
			}
			set_state_owner = 613
			613 = {
				set_state_province_controller = {
					controller = event_target:RCM_RFM_puppet
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
			}
			set_state_owner = 1015
			1015 = {
				set_state_province_controller = {
					controller = event_target:RCM_RFM_puppet
					limit = {
						OR = {
							tag = JAP
							has_war_together_with = JAP
						}
					}
				}
			}
			transfer_state = 613
			#transfer_state = 1015
			JAP = {
				puppet = RFM
			}
			army_experience = 50
			add_state_core = 1015
			add_state_core = 598
			add_state_core = 596
			add_state_core = 749
			add_state_core = 606
			add_state_core = 1034
			add_state_core = 1032
			add_state_core = 1043
			add_state_core = 613
			add_state_core = 997
			for_each_scope_loop = {
				array = RFM.core_states
				THIS = {
					if = {
						limit = {
							JAP_or_its_puppet_has_full_control_over_prev_states = yes
							OR = {
								state = 1015
								state = 598
								state = 749
								state = 606
								state = 1034
								state = 596
								state = 1043
								state = 1032
								state = 997
							}
						}
						RFM = {
							set_state_controller = PREV
							#transfer_state = PREV #puppet transfer state active
						}
					}
					else_if = {
						limit = {
							is_controlled_by_jap_or_its_puppet = yes
						}
						set_state_province_controller = {
							controller = event_target:RCM_RFM_puppet
							limit = {
								OR = {
									tag = JAP
									has_war_together_with = JAP
								}
							}
						}
					}
				}
			}
			event_target:WTT_current_china_leader = {
				RFM = {
					add_to_war = {
						targeted_alliance = JAP
						enemy = PREV
					}
				}
			}
			load_oob = RFM_focus
			#delete_unit_template_and_units = { division_template = "Luchn Shih" }
            #delete_unit_template_and_units = { division_template = "T'iaocheng Shih" } 
            #delete_unit_template_and_units = { division_template = "Chengli Shih" } 
            #delete_unit_template_and_units = { division_template = "Ch'iping Shih" } 
            #delete_unit_template_and_units = { division_template = "Tuli L" }  
            #delete_unit_template_and_units = { division_template = "Tuli Ch'iping L" }  	
			load_focus_tree = { tree = japan_puppet_focus keep_completed = yes }
			set_popularities = {
				democratic = 0
				fascism = 60
				communism = 0
				n_socialism = 0
				neutrality = 40
			}
			set_politics = {
				ruling_party = fascism
				last_election = "1936.1.1"
				election_frequency = 48
				elections_allowed = no
			}
		}
		news_event = { id = RCM_news.5 }
	}
	effect_tooltip = {
		RFM = {
			add_state_core = 1015
			add_state_core = 598
			add_state_core = 596
			add_state_core = 749
			add_state_core = 606
			add_state_core = 1034
			add_state_core = 1032
			add_state_core = 1043
			add_state_core = 613
			add_state_core = 997
		}
	}
	if = {
		limit = {
			JAP = {
				NOT = {
					has_global_flag = rfm_exists
				}
			}
		}
		custom_effect_tooltip = CCP_reform
	}
	custom_effect_tooltip = RFM_focus
}

CCP_CREATION = {
	CCP = {
		save_global_event_target_as = NewPuppet
		save_global_event_target_as = RCM_CCP_puppet
	}
	custom_effect_tooltip = shanghai_puppet
	hidden_effect = {
		#CCP = {
		#	transfer_state = 613
		#}
		CCP = {			
			set_state_owner = 613
		}
		613 = {
			set_state_province_controller = {
				controller = CCP
				limit = {
					OR = {
						tag = JAP
						has_war_together_with = JAP
					}
				}
			}
		}
		JAP = {
			puppet = CCP
		}
	}
	CCP = {
		add_state_core = 613
	}
	hidden_effect = {
		CCP = {
			event_target:WTT_current_china_leader = {
				PREV = {
					add_to_war = {
						targeted_alliance = JAP
						enemy = PREV
					}
				}
			}
			#delete_unit_template_and_units = { division_template = "Luchn Shih" }
            #delete_unit_template_and_units = { division_template = "T'iaocheng Shih" } 
            #delete_unit_template_and_units = { division_template = "Chengli Shih" } 
            #delete_unit_template_and_units = { division_template = "Ch'iping Shih" } 
            #delete_unit_template_and_units = { division_template = "Tuli L" }  
            #delete_unit_template_and_units = { division_template = "Tuli Ch'iping L" }  			
			add_popularity = {
				ideology = fascism
				popularity = 1
			}
			set_popularities = {
				democratic = 0
				fascism = 100
				communism = 0
				neutrality = 0
				n_socialism = 0
			}
			set_politics = {
				ruling_party = fascism
				elections_allowed = no
			}
		}
	}
	set_global_flag = ccp_exists
	news_event = { id = RCM_news.5 }
}

MEN_CREATION = {
	set_global_flag = men_exists
	if = { #dont puppet unless necessary
		limit = {
			ECA = {
				NOT = {
					is_subject_of = JAP
				}
			}
		}
		JAP = {
			set_autonomy = {
				target = ECA
				autonomous_state = autonomy_wtt_imperial_protectorate
			}
		}
		else = {
			effect_tooltip = {
				JAP = {
					set_autonomy = {
						target = ECA
						autonomous_state = autonomy_wtt_imperial_protectorate
					}
				}
			}
		}
	}
	ECA = {
		save_global_event_target_as = NewPuppet
		save_global_event_target_as = RCM_MEN_puppet
		set_cosmetic_tag = MEN
		army_experience = 50
		set_politics = {
			ruling_party = fascism
			elections_allowed = no
		}
		set_political_party = {
			ideology = neutrality
			popularity = 30
		}
		set_political_party = {
			ideology = n_socialism
			popularity = 0
		}
		set_political_party = {
			ideology = communism
			popularity = 0
		}
		set_political_party = {
			ideology = fascism
			popularity = 70
		}
		set_party_name = {
		    ideology = fascism
		    name = ECA_ghq_party
		    long_name = ECA_ghq_party_long
	    }   
		create_country_leader = {
			name = Yondonwangchug
			desc = ""
			picture = "gfx/leaders/MEN/Portrait_MEN_Yondonwangchug.dds"
			expire = "1966.4.23"
			ideology = fascism_ideology
			traits = {
				spirit_of_genghis
			}
		}
		set_capital = { state = 1062 }
		set_victory_points = {
			province = 7545
			value = 3
		}
		set_victory_points = {
			province = 4495
			value = 1
		}
		#set_victory_points = {
		#	province = 828
		#	value = 1
		#}
		for_each_scope_loop = {
			array = ECA.core_states
			THIS = {
				if = {
					limit = {
						JAP = {
							has_full_control_of_state = PREV
						}
					    #NOT = { is_owned_by = PLM } #1.11 added
					}
					ECA = {
						transfer_state = PREV
					}
				}
				else_if = {
					limit = {
						is_controlled_by_jap_or_its_puppet = yes
					    #NOT = { is_owned_by = PLM } #1.11 added
					}
					ECA = {			
						set_state_owner = PREV
					}
					set_state_province_controller = {
						controller = ECA
						limit = {
							OR = {
								tag = JAP
								has_war_together_with = JAP
							}
						}
					}
				}
			}
		}
	}
	hidden_effect = { news_event = { id = RCM_news.5 }}
	
}
puppet_reclaim_land = {
	save_event_target_as = puppet_reclaim_land_temp
	for_each_scope_loop = {
		array = puppet_reclaim_land_temp.core_states
		THIS = {
			if = {
				limit = {
					OR = {
						JAP = {
							controls_state = PREV
						}
						any_of_scopes = {
							array = JAP.subjects
							controls_state = PREV
						}
					}
					is_core_of = event_target:puppet_reclaim_land_temp
				}
				event_target:puppet_reclaim_land_temp = {
					set_state_owner = PREV
				}
				set_state_province_controller = {
					controller = PREV
					limit = {
						OR = {
							is_subject_of = JAP
							tag = JAP
						}
					}
				}
			}
		}
	}
}


capture_collaborators = {
	hidden_effect = {
		event_target:captured_hanjian = {
			if = {
				limit = {
					is_subject_of = JAP
				}
				country_event = {
					id = puppet_transfer.5
				}
				#JAP = {
					#	country_event = {
						#		id = rcmjapan.1000
						#	}
					#}
			}
			every_owned_state = {
				if = {
					limit = {
						is_core_of = event_target:WTT_communist_china
					    NOT = { has_state_flag = we_will_help_the_legit_government }
					}
					add_to_temp_array = { global.transfer_hanjian_state_commie = THIS }
				}
				if = {
					limit = {
						OR = {
						    NOT = {
							    is_core_of = event_target:WTT_communist_china
						    }
					        has_state_flag = we_will_help_the_legit_government
					    }
					}
					add_to_temp_array = { global.transfer_hanjian_state_non_commie = THIS }
				}
				#set_state_flag = transfer_hanjian_captured_@PREV
			}
			JAP = {
				annex_country = {
					target = PREV transfer_troops = yes
				}
			}
			for_each_scope_loop = {
				array = global.transfer_hanjian_state_commie
				event_target:WTT_communist_china = {
					set_state_owner = PREV
				}
				set_state_province_controller = {
					controller = event_target:WTT_communist_china
					limit = {
						has_war_together_with = event_target:WTT_communist_china
					}
				}
			}
			for_each_scope_loop = {
				array = global.transfer_hanjian_state_non_commie
				event_target:WTT_current_china_leader = {
					set_state_owner = PREV
				}
				set_state_province_controller = {
					controller = event_target:WTT_current_china_leader
					limit = {
						has_war_together_with = event_target:WTT_current_china_leader
					}
				}
			}
		}
		hidden_effect = {
			if = {
				limit = {
					event_target:captured_hanjian = {
						OR = {
							owns_state = 613
							owns_state = 1015
						}
					}
				}
				613 = {
					controller = {
						if = {
							limit = {
								NOT = {
									OR = {
										tag = JAP
										tag = RFM
										is_rrc = yes
									}
								}
							}
							save_global_event_target_as = nanking_controller
						}
					}
					event_target:nanking_controller = {
						set_state_owner = PREV
					}
					set_state_province_controller = {
						controller = JAP
						limit = {
							OR = {
								tag = RFM
								is_rrc = yes
							}
						}
					}
					set_state_province_controller = {
						controller = event_target:nanking_controller
						limit = {
							NOT = {
								is_ally_with = JAP
								tag = JAP
							}
						}
					}
					1015 = {
						event_target:nanking_controller = {
							set_state_owner = PREV
						}
						set_state_province_controller = {
							controller = JAP
							limit = {
								OR = {
									tag = RFM
									is_rrc = yes
								}
							}
						}
						set_state_province_controller = {
							controller = event_target:nanking_controller
							limit = {
								NOT = {
									is_ally_with = JAP
									tag = JAP
								}
							}
						}
					}
					#clear_global_event_target = nanking_controller
				}
				1015 = {
					controller = {
						if = {
							limit = {
								NOT = {
									OR = {
										tag = JAP
										tag = RFM
										is_rrc = yes
									}
								}
							}						
							save_global_event_target_as = nanking_controller
						}
					}
					event_target:nanking_controller = {
						set_state_owner = PREV
					}
					set_state_province_controller = {
						controller = JAP
						limit = {
							OR = {
								tag = RFM
								is_rrc = yes
							}
						}
					}
					set_state_province_controller = {
						controller = event_target:nanking_controller
						limit = {
							NOT = {
								is_ally_with = JAP
								tag = JAP
							}
						}
					}
					613 = {
						event_target:nanking_controller = {
							set_state_owner = PREV
						}
						set_state_province_controller = {
							controller = JAP
							limit = {
								OR = {
									tag = RFM
									is_rrc = yes
								}
							}
						}
						set_state_province_controller = {
							controller = event_target:nanking_controller
							limit = {
								NOT = {
									is_ally_with = JAP
									tag = JAP
								}
							}
						}
					}
					clear_global_event_target = nanking_controller
				}
			}
			
		}	
		#random_other_country = {
		#	limit = {
		#		has_war = no
		#		exists = yes
		#		is_in_faction = no
		#	}
		#	save_event_target_as = puppet_transfer_host_temp
		#	random_owned_controlled_state = {
		#		limit = {
		#			is_capital = no
		#			is_fully_controlled_by = PREV
		#		}
		#		save_event_target_as = puppet_transfer_state_temp
		#		FROM = {
		#			transfer_state = PREV
		#		}
		#	}
		#}
		#event_target:puppet_transfer_host_temp = {
		#	transfer_state = event_target:puppet_transfer_state_temp
		#}
		
		
	}
	#effect_tooltip = {
	#	annex_country = {
	#		target = event_target:captured_hanjian transfer_troops = no
	#	}
	#}
}

#for_tracking_ten_comp_foc = {
#	if = { #1st round
#		limit = {
#			NOT = {
#				has_country_flag = a_focus_completed
#			}
#		}
#		set_country_flag = a_focus_completed
#		else = { #2nd round
#			if = {
#				limit = {
#					NOT = {
#						has_country_flag = b_focus_completed
#					}
#				}
#				set_country_flag = b_focus_completed
#				else = { #3rd round
#					if = {
#						limit = {
#							NOT = {
#								has_country_flag = c_focus_completed
#							}
#						}
#						set_country_flag = c_focus_completed
#						else = { #4th round
#							if = {
#								limit = {
#									NOT = {
#										has_country_flag = d_focus_completed
#									}
#								}
#								set_country_flag = d_focus_completed
#								else = { #5
#									if = {
#										limit = {
#											NOT = {
#												has_country_flag = e_focus_completed
#											}
#										}
#										set_country_flag = e_focus_completed
#										else = { #6
#											if = {
#												limit = {
#													NOT = {
#														has_country_flag = f_focus_completed
#													}
#												}
#												set_country_flag = f_focus_completed
#												else = { #7
#													if = {
#														limit = {
#															NOT = {
#																has_country_flag = g_focus_completed
#															}
#														}
#														set_country_flag = g_focus_completed
#														else = { #8
#															if = {
#																limit = {
#																	NOT = {
#																		has_country_flag = h_focus_completed
#																	}
#																}
#																set_country_flag = h_focus_completed
#																else = { #9
#																	if = {
#																		limit = {
#																			NOT = {
#																				has_country_flag = i_focus_completed
#																			}
#																		}
#																		set_country_flag = i_focus_completed
#																		else = { #10
#																			if = {
#																				limit = {
#																					NOT = {
#																						has_country_flag = j_focus_completed
#																					}
#																				}
#																				set_country_flag = j_focus_completed
#																			}
#																		}
#																	}
#																}
#															}
#														}
#													}
#												}
#											}
#										}
#									}
#								}
#							}
#						}
#					}
#				}
#			}
#		}
#	}
#}

long_march_up = {
	if = {
		limit = { has_idea = Long_March_2 }
		swap_ideas = {
			remove_idea = Long_March_2
			add_idea = Long_March_1
		}
	}
	else_if = {
		limit = { has_idea = Long_March_3 }
		swap_ideas = {
			remove_idea = Long_March_3
			add_idea = Long_March_2
		}
	}
	else_if = {
		limit = { has_idea = Long_March_4 }
		swap_ideas = {
			remove_idea = Long_March_4
			add_idea = Long_March_3
		}
	}
	else_if = {
		limit = { has_idea = Long_March_5 }
		swap_ideas = {
			remove_idea = Long_March_5
			add_idea = Long_March_4
		}
	}
	else_if = {
		limit = { NOT = { has_idea = Long_March_5 } }
		add_ideas = Long_March_5
	}
}
long_march_down = {
	if = {
		limit = { has_idea = Long_March_5 }
		remove_ideas = Long_March_5
	}
	if = {
		limit = { has_idea = Long_March_4 }
		swap_ideas = {
			remove_idea = Long_March_4
			add_idea = Long_March_5
		}
	}
	if = {
		limit = { has_idea = Long_March_3 }
		swap_ideas = {
			remove_idea = Long_March_3
			add_idea = Long_March_4
		}
	}
	if = {
		limit = { has_idea = Long_March_2 }
		swap_ideas = {
			remove_idea = Long_March_2
			add_idea = Long_March_3
		}
	}
	if = {
		limit = { has_idea = Long_March_1 }
		swap_ideas = {
			remove_idea = Long_March_1
			add_idea = Long_March_2
		}
	}
}
reenable_duration = {
	if = {
		limit = { has_country_flag = infra_tier_3 }
		custom_effect_tooltip = infra_tier_3_tt
	}
	else_if = {
		limit = { has_country_flag = infra_tier_2 }
		custom_effect_tooltip = infra_tier_2_tt
	}
	else_if = {
		limit = { has_country_flag = infra_tier_1 }
		custom_effect_tooltip = infra_tier_1_tt
	}
}

PRC_border_conflict_NXM_select = {
	hidden_effect = {
		clear_variable = test_defender_state_temp
		clear_variable = test_attacker_state_temp
		clear_variable = defender_state_temp
		clear_variable = attack_dir_state_temp
		clear_variable = attacker_state_temp
		NXM = {
			random_owned_controlled_state = {
				limit = {
					state = 1029
					set_temp_variable = { test_defender_state_temp = id }
					#hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
					any_neighbor_state = {
						#hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
						set_temp_variable = { test_attacker_state_temp = id }
						#ROOT = {
						#	divisions_in_border_state = {
						#		state = var:test_attacker_state_temp
						#		border_state = var:test_defender_state_temp
						#		size > 0
						#	}
						#}
						#is_fully_controlled_by = ROOT
					}
				}
				save_event_target_as = defender_state
				set_variable = { NXM.defender_state_vs_@ROOT = id }
				set_temp_variable = { defender_state_temp = id }
				set_state_flag = border_incident_active
			}
		}
	    random_state = {
			limit = {
				is_fully_controlled_by = ROOT
				hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
				set_temp_variable = { attack_dir_state_temp = id }
				ROOT = {
					divisions_in_border_state = {
						state = var:attack_dir_state_temp
						border_state = var:NXM.defender_state_vs_@ROOT
						size > 0
					}
				}
              	any_neighbor_state = {
					state = var:NXM.defender_state_vs_@ROOT
				}
			}
			save_event_target_as = attacker_state
			set_variable = { NXM.attacker_state_vs_@ROOT = id }
			set_temp_variable = { attacker_state_temp = id }
			set_state_flag = border_incident_active
        }
	}
	custom_effect_tooltip = RCM_border_incident_delay_until_new_incident_180
	NXM = {
		country_event = { id = RCM_border_incident_defender_warning.1 hours = 1 }
		activate_targeted_decision = { target = ROOT decision = RCM_border_conflict_incident_warning_defender }
	}
}
PRC_border_conflict_NXM_option_second_time = {
	hidden_effect = {
		clear_variable = test_defender_state_temp
		clear_variable = test_attacker_state_temp
		clear_variable = defender_state_temp
		clear_variable = attack_dir_state_temp
		clear_variable = attacker_state_temp
		NXM = {
			random_owned_controlled_state = {
				limit = {
					state = 1044
					set_temp_variable = { test_defender_state_temp = id }
					#hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
					any_neighbor_state = {
						#hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
						set_temp_variable = { test_attacker_state_temp = id }
						#ROOT = {
						#	divisions_in_border_state = {
						#		state = var:test_attacker_state_temp
						#		border_state = var:test_defender_state_temp
						#		size > 0
						#	}
						#}
						#is_fully_controlled_by = ROOT
					}
				}
				save_event_target_as = defender_state
				set_variable = { NXM.defender_state_vs_@ROOT = id }
				set_temp_variable = { defender_state_temp = id }
				set_state_flag = border_incident_active
			}
		}
	    random_state = {
			limit = {
				is_fully_controlled_by = ROOT
				hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
				set_temp_variable = { attack_dir_state_temp = id }
				#ROOT = {
				#	divisions_in_border_state = {
				#		state = var:attack_dir_state_temp
				#		border_state = var:NXM.defender_state_vs_@ROOT
				#		size > 0
				#	}
				#}
              	any_neighbor_state = {
					state = var:NXM.defender_state_vs_@ROOT
				}
			}
			save_event_target_as = attacker_state
			set_variable = { NXM.attacker_state_vs_@ROOT = id }
			set_temp_variable = { attacker_state_temp = id }
			set_state_flag = border_incident_active
		}
	}
	#custom_effect_tooltip = RCM_border_incident_delay_until_new_incident_180
	NXM = {
		country_event = { id = RCM_border_incident_defender_warning.1 hours = 1 }
		activate_targeted_decision = { target = ROOT decision = RCM_border_conflict_incident_warning_defender }
	}
}
PRC_border_conflict_NXM_option_937_w_939 = {
	hidden_effect = {
		clear_variable = test_defender_state_temp
		clear_variable = test_attacker_state_temp
		clear_variable = defender_state_temp
		clear_variable = attack_dir_state_temp
		clear_variable = attacker_state_temp
		NXM = {
			random_owned_controlled_state = {
				limit = {
					state = 1031
					set_temp_variable = { test_defender_state_temp = id }
					#hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
					any_neighbor_state = {
						#hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
						set_temp_variable = { test_attacker_state_temp = id }
						#ROOT = {
						#	divisions_in_border_state = {
						#		state = var:test_attacker_state_temp
						#		border_state = var:test_defender_state_temp
						#		size > 0
						#	}
						#}
						#is_fully_controlled_by = ROOT
					}
				}
				save_event_target_as = defender_state
				set_variable = { NXM.defender_state_vs_@ROOT = id }
				set_temp_variable = { defender_state_temp = id }
				set_state_flag = border_incident_active
			}
		}
	    random_state = {
			limit = {
				is_fully_controlled_by = ROOT
				hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
				set_temp_variable = { attack_dir_state_temp = id }
				#ROOT = {
				#	divisions_in_border_state = {
				#		state = var:attack_dir_state_temp
				#		border_state = var:NXM.defender_state_vs_@ROOT
				#		size > 0
				#	}
				#}
              	any_neighbor_state = {
					state = var:NXM.defender_state_vs_@ROOT
				}
			}
			save_event_target_as = attacker_state
			set_variable = { NXM.attacker_state_vs_@ROOT = id }
			set_temp_variable = { attacker_state_temp = id }
			set_state_flag = border_incident_active
		}
	}
	#custom_effect_tooltip = RCM_border_incident_delay_until_new_incident_180
	NXM = {
		country_event = { id = RCM_border_incident_defender_warning.1 hours = 1 }
		activate_targeted_decision = { target = ROOT decision = RCM_border_conflict_incident_warning_defender }
	}
}
PRC_border_conflict_NXM = {
	hidden_effect = {
		var:NXM.defender_state_vs_@ROOT = {
			save_event_target_as = defender_state
		}
		var:NXM.attacker_state_vs_@ROOT = {
			save_event_target_as = attacker_state
		}
		random_state = {
			limit = {
				is_owned_and_controlled_by = NXM
				hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
				any_neighbor_state = {
					is_fully_controlled_by = ROOT
					has_ROOT_at_least_1_div_in_current_state_scope = yes
					hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
				}
			}
			set_temp_variable = { defender_state_temp = id }
		}
		random_state = {
			limit = {
				is_fully_controlled_by = ROOT
				hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
				has_ROOT_at_least_1_div_in_current_state_scope = yes
				any_neighbor_state = {
					state = var:NXM.defender_state_vs_@ROOT
				}
			}
			set_temp_variable = { attacker_state_temp = id }
		}
	}

	start_border_war = {
		change_state_after_war = no
		attacker = {
			state = var:NXM.attacker_state_vs_@ROOT
			num_provinces = 4
			on_win = RCM_border_conflict_won_attacker.1
			on_lose = RCM_border_conflict_lost_attacker.1
			on_cancel = RCM_border_conflict_canceled_attacker.1
		}

		defender = {
			state = var:NXM.defender_state_vs_@ROOT
			num_provinces = 4
			on_win = RCM_border_conflict_won_defender.1
			on_lose = RCM_border_conflict_lost_defender.1
			on_cancel = RCM_border_conflict_canceled_defender.1
		}
	}
	hidden_effect = { NXM = { remove_targeted_decision = { target = ROOT decision = RCM_border_conflict_escalation_warning_defender } } }
	NXM = {
		activate_targeted_decision = { target = ROOT decision = RCM_border_conflict_escalate_conflict }
		activate_targeted_decision = { target = ROOT decision = RCM_border_conflict_time_until_cancelled }
	}
	activate_targeted_decision = { target = NXM decision = RCM_border_conflict_escalate_conflict }
	activate_targeted_decision = { target = NXM decision = RCM_border_conflict_time_until_cancelled }
}


PRC_border_conflict_SHX_select = {
	clear_variable = test_defender_state_temp
	clear_variable = test_attacker_state_temp
	clear_variable = defender_state_temp
	clear_variable = attack_dir_state_temp
	clear_variable = attacker_state_temp
	hidden_effect = {
		SHX = {
			random_owned_controlled_state = {
				limit = {
					state = 998
					set_temp_variable = { test_defender_state_temp = id }
					#hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
					any_neighbor_state = {
						#hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
						set_temp_variable = { test_attacker_state_temp = id }
						#ROOT = {
						#	divisions_in_border_state = {
						#		state = var:test_attacker_state_temp
						#		border_state = var:test_defender_state_temp
						#		size > 0
						#	}
						#}
						#is_fully_controlled_by = ROOT
					}
				}
				save_event_target_as = defender_state
				set_variable = { SHX.defender_state_vs_@ROOT = id }
				set_temp_variable = { defender_state_temp = id }
				set_state_flag = border_incident_active
			}
		}
		random_state = {
			limit = {
				is_fully_controlled_by = ROOT
				state = 622
				hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
				set_temp_variable = { attack_dir_state_temp = id }
				ROOT = {
					divisions_in_border_state = {
						state = var:attack_dir_state_temp
						border_state = var:SHX.defender_state_vs_@ROOT
						size > 0
					}
				}
				any_neighbor_state = {
					state = var:SHX.defender_state_vs_@ROOT
				}
			}
			save_event_target_as = attacker_state
			set_variable = { SHX.attacker_state_vs_@ROOT = id }
			set_temp_variable = { attacker_state_temp = id }
			set_state_flag = border_incident_active
		}
	}
	custom_effect_tooltip = RCM_border_incident_delay_until_new_incident_180
	SHX = {
		country_event = { id = RCM_border_incident_defender_warning.1 hours = 1 }
		activate_targeted_decision = { target = ROOT decision = RCM_border_conflict_incident_warning_defender }
	}
}
PRC_border_conflict_SHX = {
	hidden_effect = {
		var:SHX.defender_state_vs_@ROOT = {
			save_event_target_as = defender_state
		}
		var:SHX.attacker_state_vs_@ROOT = {
			save_event_target_as = attacker_state
		}
		random_state = {
			limit = {
				state = 998
				is_owned_and_controlled_by = SHX
				hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
				any_neighbor_state = {
					is_fully_controlled_by = ROOT
					has_ROOT_at_least_1_div_in_current_state_scope = yes
					hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
				}
			}
			set_temp_variable = { defender_state_temp = id }
		}
		random_state = {
			limit = {
				state = 622
				is_fully_controlled_by = ROOT
				hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
				has_ROOT_at_least_1_div_in_current_state_scope = yes
				any_neighbor_state = {
					state = var:SHX.defender_state_vs_@ROOT
				}
			}
			set_temp_variable = { attacker_state_temp = id }
		}
	}
	start_border_war = {#GUO
		change_state_after_war = no
		combat_width = 120
		minimum_duration_in_days = 75
		attacker = {
			state = var:SHX.attacker_state_vs_@ROOT
			num_provinces = 4
			on_win = PRC_luobinghui.300 #guo
			on_lose = RCM_border_conflict_lost_attacker.1
			on_cancel = PRC_luobinghui.3 #guo
			
			#guomodifier = 2.0
			#guoterrain_factor = -0.5
			leader_score = { base = 100 }
		}

		defender = {
			state = var:SHX.defender_state_vs_@ROOT
			num_provinces = 4
			on_win = RCM_border_conflict_won_defender.1
			on_lose = RCM_border_conflict_lost_defender.1
			on_cancel = RCM_border_conflict_canceled_defender.1
		}
	}
	hidden_effect = { SHX = { remove_targeted_decision = { target = ROOT decision = RCM_border_conflict_escalation_warning_defender } } }
	SHX = {
		activate_targeted_decision = { target = ROOT decision = RCM_border_conflict_escalate_conflict }
		activate_targeted_decision = { target = ROOT decision = RCM_border_conflict_time_until_cancelled }
	}
	activate_targeted_decision = { target = SHX decision = RCM_border_conflict_escalate_conflict }
	activate_targeted_decision = { target = SHX decision = RCM_border_conflict_time_until_cancelled }
}

PRC_personnel_shortage_down = {
	if = {
		limit = {
			has_idea = PRC_no_skilled_personnel_1
		}
		swap_ideas = {
			remove_idea = PRC_no_skilled_personnel_1
			add_idea = PRC_no_skilled_personnel_2
		}
	}
	else_if = {
		limit = {
			has_idea = PRC_no_skilled_personnel_2
		}
		swap_ideas = {
			remove_idea = PRC_no_skilled_personnel_2
			add_idea = PRC_no_skilled_personnel_3
		}
	}
	else_if = {
		limit = {
			has_idea = PRC_no_skilled_personnel_3
		}
		swap_ideas = {
			remove_idea = PRC_no_skilled_personnel_3
			add_idea = PRC_no_skilled_personnel_4
		}
	}
	else_if = {
		limit = {
			has_idea = PRC_no_skilled_personnel_4
		}
		remove_ideas = PRC_no_skilled_personnel_4
	}
}
remove_manchuria_cores_as_china = {
	 every_state = {
	 	limit = {
	 		is_core_of = event_target:WTT_current_china_leader
	 		OR = {
	 			state = 612
	 			state = 1012
	 			state = 747
	 			is_manchuria_state = yes
	 		}
	 	}
	 	remove_core_of = event_target:WTT_current_china_leader
	 }
 }
JAP_remove_hostile_create_cmj_bloc_add_china_and_puppets_into_faction = {
	remove_opinion_modifier = {
		target = event_target:WTT_current_china_leader
		modifier = hostile_status
	}
	#dismantle_faction = yes
	create_faction = CHI_man_bloc
	hidden_effect = {
		news_event = RCM_news.3
	}
	unlock_national_focus = JAP_revise_hirota_sangesoku_focus
	every_country = {
		limit = {
			is_puppet_of = JAP
		}
		JAP = {
			add_to_faction = PREV
		}
	}
	add_to_faction = event_target:WTT_current_china_leader
	hidden_effect = {
		set_global_flag = revise_hiro_san_success
		event_target:WTT_current_china_leader = {
			save_global_event_target_as = RCM_japan_friendly_china
		}
	}
}

Puppet_HPC_Add_sino_jap_idea_Remove_hostile_Add_alliance_opinion_increase_appeasement = {
	set_autonomy = { target = HPC autonomy_state = autonomy_rcm_national_revolutionary_army }
	add_ideas = sino_japanese_alliance
	unlock_national_focus = ack_hiro_sen_focus
	if = {
		limit = {
			NOT = {
				has_completed_focus = CHI_Encirclement_Campaign_focus
			}
		}
		complete_national_focus = CHI_Encirclement_Campaign_focus
	}
	remove_opinion_modifier = {
		target = JAP
		modifier = hostile_status
	}
	add_opinion_modifier = { target = JAP modifier = sino_japanese_alliance_opinion }
	if = {
		limit = {
			has_idea = appeasement_policy
		}
		swap_ideas = {
			add_idea = appeasement_policy_2
			remove_idea = appeasement_policy
		}
	}
	else_if = {
		limit = {
			has_idea = appeasement_policy_0
		}
		swap_ideas = {
			add_idea = appeasement_policy_2
			remove_idea = appeasement_policy_0
		}
		else = {
			add_ideas = appeasement_policy_2
		}
	}
}

integrated_puppet_HPC = { 
	puppet = HPC
}


#KMT-CC Civil WAR
CHI_kmt_cc_civil_war = {
	set_country_flag = im_civ_war_exception
	random_enemy_country = {
		limit = {
			original_tag = ROOT
		}
		set_country_flag = im_civ_war_exception
		save_global_event_target_as = KMT_CC_clique
		create_country_leader = {
			name = chen_guofu
			desc = ""
			picture = "Portrait_CHI_Chen_Guofu.dds"
			expire = "1965.1.1"
			ideology = sanmin_political_tutelage
			traits = {
				backroom_backstabber
			}
		}
		set_popularities = {
			fascism = 0
			democratic = 0
			communism = 0
			neutrality = 100
			n_socialism = 0
		}
		set_politics = {
			ruling_party = neutrality
		}
		load_focus_tree = { tree = warlord_generic_nationalist keep_completed = yes }
		set_cosmetic_tag = CHI_power_struggle_defeated
		set_party_name = { ideology = neutrality long_name = CHI_neutrality_CC_party_long name = CHI_neutrality_CC_party }
	}
}
#appeasement_policy
appeasement_policy_2_level_down = {
	if = {
		limit = {
			has_idea = appeasement_policy_2
		}
		swap_ideas = {
			remove_idea = appeasement_policy_2
			add_idea = appeasement_policy_2_a
		}
	}
	else_if = {
		limit = {
			has_idea = appeasement_policy_2_a
		}
		swap_ideas = {
			remove_idea = appeasement_policy_2_a
			add_idea = appeasement_policy_2_b
		}
	}
	else_if = {
		limit = {
			has_idea = appeasement_policy_2_b
		}
		swap_ideas = {
			remove_idea = appeasement_policy_2_b
			add_idea = appeasement_policy_2_c
		}
	}
	else_if = {
		limit = {
			has_idea = appeasement_policy_2_c
		}
		swap_ideas = {
			remove_idea = appeasement_policy_2_c
			add_idea = appeasement_policy_2_d
		}
	}
	else_if = {
		limit = {
			has_idea = appeasement_policy_2_d
		}
		remove_ideas = appeasement_policy_2_d
	}
}
appeasement_policy_2_level_up = {
	if = {
		limit = {
			has_idea = appeasement_policy_2_d
		}
		swap_ideas = {
			remove_idea = appeasement_policy_2_d
			add_idea = appeasement_policy_2_c
		}
	}
	else_if = {
		limit = {
			has_idea = appeasement_policy_2_c
		}
		swap_ideas = {
			remove_idea = appeasement_policy_2_c
			add_idea = appeasement_policy_2_b
		}
	}
	else_if = {
		limit = {
			has_idea = appeasement_policy_2_b
		}
		swap_ideas = {
			remove_idea = appeasement_policy_2_b
			add_idea = appeasement_policy_2_a
		}
	}
	else_if = {
		limit = {
			has_idea = appeasement_policy_2_a
		}
		swap_ideas = {
			remove_idea = appeasement_policy_2_a
			add_idea = appeasement_policy_2
		}
	}
	else_if = {
		limit = {
			has_idea = appeasement_policy_2
		}
		add_stability = -0.05
		add_war_support = -0.05
	}
}

####CHI_inch_blood

CHI_inch_blood_level_up = {
	if = {
		limit = {
			has_idea = CHI_inch_blood_1
		}
		swap_ideas = {
			remove_idea = CHI_inch_blood_1
			add_idea = CHI_inch_blood_2
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_2
		}
		swap_ideas = {
			remove_idea = CHI_inch_blood_2
			add_idea = CHI_inch_blood_3
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_3
		}
		swap_ideas = {
			remove_idea = CHI_inch_blood_3
			add_idea = CHI_inch_blood_4
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_4
		}
		swap_ideas = {
			remove_idea = CHI_inch_blood_4
			add_idea = CHI_inch_blood_5
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_5
		}
		swap_ideas = {
			remove_idea = CHI_inch_blood_5
			add_idea = CHI_inch_blood_6
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_6
		}
		swap_ideas = {
			remove_idea = CHI_inch_blood_6
			add_idea = CHI_inch_blood_7
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_7
		}
		swap_ideas = {
			remove_idea = CHI_inch_blood_7
			add_idea = CHI_inch_blood_8
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_8
		}
		swap_ideas = {
			remove_idea = CHI_inch_blood_8
			add_idea = CHI_inch_blood_9
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_9
		}
		swap_ideas = {
			remove_idea = CHI_inch_blood_9
			add_idea = CHI_inch_blood_10
		}
	}
}
CHI_inch_blood_level_down = {
	if = {
		limit = {
			has_idea = CHI_inch_blood_2
		}
		swap_ideas = {
			add_idea = CHI_inch_blood_1
			remove_idea = CHI_inch_blood_2
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_3
		}
		swap_ideas = {
			add_idea = CHI_inch_blood_2
			remove_idea = CHI_inch_blood_3
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_4
		}
		swap_ideas = {
			add_idea = CHI_inch_blood_3
			remove_idea = CHI_inch_blood_4
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_5
		}
		swap_ideas = {
			add_idea = CHI_inch_blood_4
			remove_idea = CHI_inch_blood_5
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_6
		}
		swap_ideas = {
			add_idea = CHI_inch_blood_5
			remove_idea = CHI_inch_blood_6
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_7
		}
		swap_ideas = {
			add_idea = CHI_inch_blood_6
			remove_idea = CHI_inch_blood_7
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_8
		}
		swap_ideas = {
			add_idea = CHI_inch_blood_7
			remove_idea = CHI_inch_blood_8
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_9
		}
		swap_ideas = {
			add_idea = CHI_inch_blood_8
			remove_idea = CHI_inch_blood_9
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_inch_blood_10
		}
		swap_ideas = {
			add_idea = CHI_inch_blood_9
			remove_idea = CHI_inch_blood_10
		}
	}
}

#JPG_illegal_regime_ LEVEL down
JPG_illegal_regime_level_down = {
	if = {
		limit = {
			has_idea = JPG_illegal_regime_1
		}
		swap_ideas = {
		    remove_idea = JPG_illegal_regime_1
		    add_idea = JPG_illegal_regime_2
		}
		add_autonomy_ratio = {
			value = 0.05
			localization = JPG_declare_our_sovereignty
		}
	}
	else_if = {
		limit = {
			has_idea = JPG_illegal_regime_2
		}
		swap_ideas = {
		    remove_idea = JPG_illegal_regime_2
		    add_idea = JPG_illegal_regime_3
		}
		add_autonomy_ratio = {
			value = 0.1
			localization = JPG_declare_our_sovereignty
		}
	}
	else_if = {
		limit = {
			has_idea = JPG_illegal_regime_3
		}
		swap_ideas = {
		    remove_idea = JPG_illegal_regime_3
		    add_idea = JPG_illegal_regime_4
		}
		add_autonomy_ratio = {
			value = 0.15
			localization = JPG_declare_our_sovereignty
		}
	}
	else_if = {
		limit = {
			has_idea = JPG_illegal_regime_4
		}
		swap_ideas = {
		    remove_idea = JPG_illegal_regime_4
		    add_idea = JPG_illegal_regime_5
		}
		add_autonomy_ratio = {
			value = 0.2
			localization = JPG_declare_our_sovereignty
		}
	}
	else_if = {
		limit = {
			has_idea = JPG_illegal_regime_5
		}
		remove_ideas = JPG_illegal_regime_5
		add_autonomy_ratio = {
			value = 0.25
			localization = JPG_declare_our_sovereignty
		}
	}
}

#administration reform
fractured_administration_level_down = {
	if = {
		limit = {
			has_idea = CHI_fractured_administration_idea_1
		}
		swap_ideas = {
		    remove_idea = CHI_fractured_administration_idea_1
		    add_idea = CHI_fractured_administration_idea_2
	    	}
	}
	else_if = {
		limit = {
			has_idea = CHI_fractured_administration_idea_2
		}
		swap_ideas = {
		    remove_idea = CHI_fractured_administration_idea_2
		    add_idea = CHI_fractured_administration_idea_3
	    	}
	}
	else_if = {
		limit = {
			has_idea = CHI_fractured_administration_idea_3
		}
		swap_ideas = {
		    remove_idea = CHI_fractured_administration_idea_3
		    add_idea = CHI_fractured_administration_idea_4
	    	}
	}
	else_if = {
		limit = {
			has_idea = CHI_fractured_administration_idea_4
		}
		remove_ideas = CHI_fractured_administration_idea_4
	}
}


#VANDALISM EFFECT
vandalize_this_state = {
	
	if = { #SECOND FOCUS
		limit = {
			event_target:WTT_communist_china = {
				has_country_flag = vandalism_2_focus_complete_flag
			}
		}
		if = {
			limit = {
				arms_factory > 0
			}
			damage_building = {
				type = arms_factory
				damage = 1.8
			}
		}
		if = {
			limit = {
				industrial_complex > 0
			}
			damage_building = {
				type = industrial_complex
				damage = 1.8
			}
		}
		if = {
			limit = {
				infrastructure > 0
			}
			damage_building = {
				type = infrastructure
				damage = 3
			}
		}
		if = {
			limit = {
				dockyard > 0
			}
			damage_building = {
				type = dockyard
				damage = 1.8
			}
		}
	    if = {
			limit = {
				rail_way > 0
			}
			damage_building = {
				type = rail_way
				damage = 3
			}
		}
	}
	else_if = { #FIRST FOCUS
		limit = {
			event_target:WTT_communist_china = {
				has_country_flag = vandalism_1_focus_complete_flag
			}
		}
		if = {
			limit = {
				arms_factory > 0
			}
			damage_building = {
				type = arms_factory
				damage = 1.2
			}
		}
		if = {
			limit = {
				industrial_complex > 0
			}
			damage_building = {
				type = industrial_complex
				damage = 1.2
			}
		}
		if = {
			limit = {
				infrastructure > 0
			}
			damage_building = {
				type = infrastructure
				damage = 2
			}
		}
		if = {
			limit = {
				dockyard > 0
			}
			damage_building = {
				type = dockyard
				damage = 1.2
			}
		}
	    if = {
			limit = {
				rail_way > 0
			}
			damage_building = {
				type = rail_way
				damage = 2
			}
		}
	}
	else = { #NO FOCUS
		if = {
			limit = {
				arms_factory > 0
			}
			damage_building = {
				type = arms_factory
				damage = 0.6
			}
		}
		if = {
			limit = {
				industrial_complex > 0
			}
			damage_building = {
				type = industrial_complex
				damage = 0.6
			}
		}
		if = {
			limit = {
				infrastructure > 0
			}
			damage_building = {
				type = infrastructure
				damage = 1
			}
		}
		if = {
			limit = {
				dockyard > 0
			}
			damage_building = {
				type = dockyard
				damage = 0.6
			}
		}
	    if = {
			limit = {
				rail_way > 0
			}
			damage_building = {
				type = rail_way
				damage = 1
			}
		}
	}
}
#Attack effect
    attack_this_state = {
        if = {
		limit = { 
            owner = { has_war_with = event_target:WTT_communist_china }
            NOT = { 
			    owner = { has_government = communism }
			}
		    region = 143
		}
		damage_units = {
			region = 143
			damage = 0.1
            org_damage = 0.2
            str_damage = 0.1
            ratio = yes
            army = yes
            navy = no
        }
    }
}

#ROOT's army leaders join FROM(china)
ROOT_army_leaders_join_FROM = {
	every_army_leader = {
		limit = {
			OWNER = { TAG = ROOT }
		}
		set_unit_leader_flag = allegiance_to_@ROOT #return when wars break out
		set_nationality = FROM
	}
	every_unit_leader = {
		limit = {
			OWNER = { TAG = ROOT }
		}
		set_unit_leader_flag = allegiance_to_@ROOT #return when wars break ou
		set_nationality = FROM
	}
	set_global_flag = joined_chi_@ROOT
}
FROM_army_leaders_join_ROOT = {
	every_army_leader = {
		limit = {
			OWNER = { TAG = FROM }
		}
		set_unit_leader_flag = allegiance_to_@FROM #return when wars break out
		set_nationality = ROOT
	}
	every_unit_leader = {
		limit = {
			OWNER = { TAG = FROM }
		}
		set_unit_leader_flag = allegiance_to_@FROM #return when wars break ou
		set_nationality = ROOT
	}
	set_global_flag = joined_chi_@FROM
}


#WARLORD BECOMES COMMUNIST
warlord_becomes_communist = {
	set_party_name = {
		ideology = neutrality
		name = neutrality_party_local_support
		long_name = neutrality_party_local_support_long
	}
	retire_country_leader = yes
	create_country_leader = {
		name = "None"
		desc = ""
		picture = ""
		expire = "1965.1.1"
		ideology = despotism
		traits = {
			#
		}
	}
	set_politics = { ruling_party = communism elections_allowed = no }
	retire_country_leader = yes
	if = {
		limit = {
			has_country_flag = leader_is_generallissimo
		}
		add_country_leader_trait = generallissimo
	}
	if = {
		limit = {
			original_tag = PLM
		}
		add_country_leader_trait = fu_zuoyi_doctrine
	}
}
warlord_becomes_socialist = {
	set_party_name = {
		ideology = neutrality
		name = neutrality_party_local_support
		long_name = neutrality_party_local_support_long
	}
	retire_country_leader = yes
	create_country_leader = {
		name = "None"
		desc = ""
		picture = ""
		expire = "1965.1.1"
		ideology = despotism
		traits = {
			#
		}
	}
	set_politics = { ruling_party = n_socialism elections_allowed = no }
	retire_country_leader = yes
	if = {
		limit = {
			has_country_flag = leader_is_generallissimo
		}
		add_country_leader_trait = generallissimo
	}
    if = {
		limit = {
			original_tag = PLM
		}
		add_country_leader_trait = fu_zuoyi_doctrine
	}
}
warlord_becomes_fascist = {
	set_party_name = {
		ideology = neutrality
		name = neutrality_party_local_support
		long_name = neutrality_party_local_support_long
	}
	retire_country_leader = yes
	create_country_leader = {
		name = "None"
		desc = ""
		picture = ""
		expire = "1965.1.1"
		ideology = despotism
		traits = {
			#
		}
	}
	set_politics = { ruling_party = fascism elections_allowed = no }
	retire_country_leader = yes
	if = {
		limit = {
			has_country_flag = leader_is_generallissimo
		}
		add_country_leader_trait = generallissimo
	}
    if = {
		limit = {
			original_tag = PLM
		}
		add_country_leader_trait = fu_zuoyi_doctrine
	}
}
warlord_becomes_democratic = {
	set_party_name = {
		ideology = neutrality
		name = neutrality_party_local_support
		long_name = neutrality_party_local_support_long
	}
	retire_country_leader = yes
	create_country_leader = {
		name = "None"
		desc = ""
		picture = ""
		expire = "1965.1.1"
		ideology = despotism
		traits = {
			#
		}
	}
	set_politics = { ruling_party = democratic elections_allowed = yes }
	retire_country_leader = yes
	if = {
		limit = {
			has_country_flag = leader_is_generallissimo
		}
		add_country_leader_trait = generallissimo
	}
    if = {
		limit = {
			original_tag = PLM
		}
		add_country_leader_trait = fu_zuoyi_doctrine
	}
}

CLIQUE_becomes_fascist = { # USE ALONG WITH warlord_becomes_XXX #PLM todo
	if = {
		limit = {
			tag = GUD
		}
		set_party_name = {
			ideology = fascism
			name = GUD_clique
			long_name = GUD_clique_long
		}
	}
	else_if = {
		limit = {
			tag = GXC
		}
		set_party_name = {
			ideology = fascism
			name = GXC_clique
			long_name = GXC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = YUN
		}
		set_party_name = {
			ideology = fascism
			name = YUN_clique
			long_name = YUN_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHX
		}
		set_party_name = {
			ideology = fascism
			name = SHX_clique
			long_name = SHX_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XSM
		}
		set_party_name = {
			ideology = fascism
			name = XSM_clique
			long_name = XSM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XIK
		}
		set_party_name = {
			ideology = fascism
			name = XIK_clique
			long_name = XIK_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SIC
		}
		set_party_name = {
			ideology = fascism
			name = SIC_clique
			long_name = SIC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = HPC
		}
		set_party_name = {
			ideology = fascism
			name = HPC_clique
			long_name = HPC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = NEA
		}
		set_party_name = {
			ideology = fascism
			name = NEA_clique
			long_name = NEA_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHD
		}
		set_party_name = {
			ideology = fascism
			name = SHD_clique
			long_name = SHD_clique_long
		}
	}
	else_if = {
		limit = {
			tag = NXM
		}
		set_party_name = {
			ideology = fascism
			name = NXM_clique
			long_name = NXM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHC
		}
		set_party_name = {
			ideology = fascism
			name = SHC_clique
			long_name = SHC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = GSM
		}
		set_party_name = {
			ideology = fascism
			name = GSM_clique
			long_name = GSM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = EGM
		}
		set_party_name = {
			ideology = fascism
			name = EGM_clique
			long_name = EGM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = TNG
		}
		set_party_name = {
			ideology = fascism
			name = TNG_clique
			long_name = TNG_clique_long
		}
	}
	else_if = {
		limit = {
			tag = HMI
		}
		set_party_name = {
			ideology = fascism
			name = HMI_clique
			long_name = HMI_clique_long
		}
	}
	else_if = {
		limit = {
			tag = KHR
		}
		set_party_name = {
			ideology = fascism
			name = KHR_clique
			long_name = KHR_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XIA
		}
		set_party_name = {
			ideology = fascism
			name = XIA_clique
			long_name = XIA_clique_long
		}
	}
	else_if = {
		limit = {
			tag = KRS
		}
		set_party_name = {
			ideology = fascism
			name = KRS_clique
			long_name = KRS_clique_long
		}
	}
	else_if = {
		limit = {
			tag = ATM
		}
		set_party_name = {
			ideology = fascism
			name = ATM_clique
			long_name = ATM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SUY
		}
		set_party_name = {
			ideology = fascism
			name = SUY_clique
			long_name = SUY_clique_long
		}
	}
}


CLIQUE_becomes_communist = {
	if = {
		limit = {
			tag = GUD
		}
		set_party_name = {
			ideology = communism
			name = GUD_clique
			long_name = GUD_clique_long
		}
	}
	else_if = {
		limit = {
			tag = GXC
		}
		set_party_name = {
			ideology = communism
			name = GXC_clique
			long_name = GXC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = YUN
		}
		set_party_name = {
			ideology = communism
			name = YUN_clique
			long_name = YUN_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHX
		}
		set_party_name = {
			ideology = communism
			name = SHX_clique
			long_name = SHX_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XSM
		}
		set_party_name = {
			ideology = communism
			name = XSM_clique
			long_name = XSM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XIK
		}
		set_party_name = {
			ideology = communism
			name = XIK_clique
			long_name = XIK_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SIC
		}
		set_party_name = {
			ideology = communism
			name = SIC_clique
			long_name = SIC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = HPC
		}
		set_party_name = {
			ideology = communism
			name = HPC_clique
			long_name = HPC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = NEA
		}
		set_party_name = {
			ideology = communism
			name = NEA_clique
			long_name = NEA_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHD
		}
		set_party_name = {
			ideology = communism
			name = SHD_clique
			long_name = SHD_clique_long
		}
	}
	else_if = {
		limit = {
			tag = NXM
		}
		set_party_name = {
			ideology = communism
			name = NXM_clique
			long_name = NXM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHC
		}
		set_party_name = {
			ideology = communism
			name = SHC_clique
			long_name = SHC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = GSM
		}
		set_party_name = {
			ideology = communism
			name = GSM_clique
			long_name = GSM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = EGM
		}
		set_party_name = {
			ideology = communism
			name = EGM_clique
			long_name = EGM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = TNG
		}
		set_party_name = {
			ideology = communism
			name = TNG_clique
			long_name = TNG_clique_long
		}
	}
	else_if = {
		limit = {
			tag = HMI
		}
		set_party_name = {
			ideology = communism
			name = HMI_clique
			long_name = HMI_clique_long
		}
	}
	else_if = {
		limit = {
			tag = KHR
		}
		set_party_name = {
			ideology = communism
			name = KHR_clique
			long_name = KHR_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XIA
		}
		set_party_name = {
			ideology = communism
			name = XIA_clique
			long_name = XIA_clique_long
		}
	}
	else_if = {
		limit = {
			tag = KRS
		}
		set_party_name = {
			ideology = communism
			name = KRS_clique
			long_name = KRS_clique_long
		}
	}
	else_if = {
		limit = {
			tag = ATM
		}
		set_party_name = {
			ideology = communism
			name = ATM_clique
			long_name = ATM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SUY
		}
		set_party_name = {
			ideology = communism
			name = SUY_clique
			long_name = SUY_clique_long
		}
	}
}

CLIQUE_becomes_socialist = {
	if = {
		limit = {
			tag = GUD
		}
		set_party_name = {
			ideology = n_socialism
			name = GUD_clique
			long_name = GUD_clique_long
		}
	}
	else_if = {
		limit = {
			tag = GXC
		}
		set_party_name = {
			ideology = n_socialism
			name = GXC_clique
			long_name = GXC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = YUN
		}
		set_party_name = {
			ideology = n_socialism
			name = YUN_clique
			long_name = YUN_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHX
		}
		set_party_name = {
			ideology = n_socialism
			name = SHX_clique
			long_name = SHX_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XSM
		}
		set_party_name = {
			ideology = n_socialism
			name = XSM_clique
			long_name = XSM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XIK
		}
		set_party_name = {
			ideology = n_socialism
			name = XIK_clique
			long_name = XIK_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SIC
		}
		set_party_name = {
			ideology = n_socialism
			name = SIC_clique
			long_name = SIC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = HPC
		}
		set_party_name = {
			ideology = n_socialism
			name = HPC_clique
			long_name = HPC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = NEA
		}
		set_party_name = {
			ideology = n_socialism
			name = NEA_clique
			long_name = NEA_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHD
		}
		set_party_name = {
			ideology = n_socialism
			name = SHD_clique
			long_name = SHD_clique_long
		}
	}
	else_if = {
		limit = {
			tag = NXM
		}
		set_party_name = {
			ideology = n_socialism
			name = NXM_clique
			long_name = NXM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHC
		}
		set_party_name = {
			ideology = n_socialism
			name = SHC_clique
			long_name = SHC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = GSM
		}
		set_party_name = {
			ideology = n_socialism
			name = GSM_clique
			long_name = GSM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = EGM
		}
		set_party_name = {
			ideology = n_socialism
			name = EGM_clique
			long_name = EGM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = TNG
		}
		set_party_name = {
			ideology = n_socialism
			name = TNG_clique
			long_name = TNG_clique_long
		}
	}
	else_if = {
		limit = {
			tag = HMI
		}
		set_party_name = {
			ideology = n_socialism
			name = HMI_clique
			long_name = HMI_clique_long
		}
	}
	else_if = {
		limit = {
			tag = KHR
		}
		set_party_name = {
			ideology = n_socialism
			name = KHR_clique
			long_name = KHR_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XIA
		}
		set_party_name = {
			ideology = n_socialism
			name = XIA_clique
			long_name = XIA_clique_long
		}
	}
	else_if = {
		limit = {
			tag = KRS
		}
		set_party_name = {
			ideology = n_socialism
			name = KRS_clique
			long_name = KRS_clique_long
		}
	}
	else_if = {
		limit = {
			tag = ATM
		}
		set_party_name = {
			ideology = n_socialism
			name = ATM_clique
			long_name = ATM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SUY
		}
		set_party_name = {
			ideology = n_socialism
			name = SUY_clique
			long_name = SUY_clique_long
		}
	}
}

leave_kuomintang_becomes_clique = {
	if = {
		limit = {
			tag = GUD
		}
		set_party_name = {
			ideology = neutrality
			name = GUD_clique
			long_name = GUD_clique_long
		}
	}
	else_if = {
		limit = {
			tag = GXC
		}
		set_party_name = {
			ideology = neutrality
			name = GXC_clique
			long_name = GXC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = YUN
		}
		set_party_name = {
			ideology = neutrality
			name = YUN_clique
			long_name = YUN_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHX
		}
		set_party_name = {
			ideology = neutrality
			name = SHX_clique
			long_name = SHX_clique_long
		}
	}
	else_if = {
		limit = {
			tag = PLM
		}
		set_party_name = {
			ideology = neutrality
			name = PLM_clique
			long_name = PLM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XSM
		}
		set_party_name = {
			ideology = neutrality
			name = XSM_clique
			long_name = XSM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XIK
		}
		set_party_name = {
			ideology = neutrality
			name = XIK_clique
			long_name = XIK_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SIC
		}
		set_party_name = {
			ideology = neutrality
			name = SIC_clique
			long_name = SIC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = HPC
		}
		set_party_name = {
			ideology = neutrality
			name = HPC_clique
			long_name = HPC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = NEA
		}
		set_party_name = {
			ideology = neutrality
			name = NEA_clique
			long_name = NEA_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHD
		}
		set_party_name = {
			ideology = neutrality
			name = SHD_clique
			long_name = SHD_clique_long
		}
	}
	else_if = {
		limit = {
			tag = NXM
		}
		set_party_name = {
			ideology = neutrality
			name = NXM_clique
			long_name = NXM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SHC
		}
		set_party_name = {
			ideology = neutrality
			name = SHC_clique
			long_name = SHC_clique_long
		}
	}
	else_if = {
		limit = {
			tag = GSM
		}
		set_party_name = {
			ideology = neutrality
			name = GSM_clique
			long_name = GSM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = EGM
		}
		set_party_name = {
			ideology = neutrality
			name = EGM_clique
			long_name = EGM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = TNG
		}
		set_party_name = {
			ideology = neutrality
			name = TNG_clique
			long_name = TNG_clique_long
		}
	}
	else_if = {
		limit = {
			tag = HMI
		}
		set_party_name = {
			ideology = neutrality
			name = HMI_clique
			long_name = HMI_clique_long
		}
	}
    else_if = {
		limit = {
			tag = KHR
		}
		set_party_name = {
			ideology = neutrality
			name = KHR_clique
			long_name = KHR_clique_long
		}
	}
	else_if = {
		limit = {
			tag = XIA
		}
		set_party_name = {
			ideology = neutrality
			name = XIA_clique
			long_name = XIA_clique_long
		}
	}
	else_if = {
		limit = {
			tag = KRS
		}
		set_party_name = {
			ideology = neutrality
			name = KRS_clique
			long_name = KRS_clique_long
		}
	}
	else_if = {
		limit = {
			tag = ATM
		}
		set_party_name = {
			ideology = neutrality
			name = ATM_clique
			long_name = ATM_clique_long
		}
	}
	else_if = {
		limit = {
			tag = SUY
		}
		set_party_name = {
			ideology = neutrality
			name = SUY_clique
			long_name = SUY_clique_long
		}
	}
}
#warlord puppet fascist tag
warlord_becomes_viceroyalty = {
	if = {
		limit = {
			tag = GUD
		}
		set_cosmetic_tag = GUD_puppet
	}
	else_if = {
		limit = {
			tag = GXC
		}
		set_cosmetic_tag = GXC_puppet
	}
	else_if = {
		limit = {
			tag = YUN
		}
		set_cosmetic_tag = YUN_puppet
	}
	else_if = {
		limit = {
			tag = SHX
		}
		set_cosmetic_tag = SHX_puppet
	}
	else_if = {
		limit = {
			tag = XSM
		}
		set_cosmetic_tag = XSM_puppet
	}
	else_if = {
		limit = {
			tag = XIK
		}
		set_cosmetic_tag = XIK_puppet
	}
	else_if = {
		limit = {
			tag = SIC
		}
		set_cosmetic_tag = SIC_puppet
	}
	else_if = {
		limit = {
			tag = HPC
		}
		set_cosmetic_tag = HPC_puppet
	}
	else_if = {
		limit = {
			tag = NEA
		}
		set_cosmetic_tag = NEA_puppet
	}
	else_if = {
		limit = {
			tag = SHD
		}
		set_cosmetic_tag = SHD_puppet
	}
	else_if = {
		limit = {
			tag = NXM
		}
		set_cosmetic_tag = NXM_puppet
	}
	else_if = {
		limit = {
			tag = SHC
		}
		set_cosmetic_tag = SHC_puppet
	}
	else_if = {
		limit = {
			tag = GSM
		}
		set_cosmetic_tag = GSM_puppet
	}
	else_if = {
		limit = {
			tag = EGM
		}
		set_cosmetic_tag = EGM_puppet
	}
	else_if = {
		limit = {
			tag = TNG
		}
		set_cosmetic_tag = TNG_puppet
	}
	else_if = {
		limit = {
			tag = HMI
		}
		set_cosmetic_tag = HMI_puppet
	}
	else_if = {
		limit = {
			tag = KHR
		}
		set_cosmetic_tag = KHR_puppet
	}
	else_if = {
		limit = {
			tag = XIA
		}
		set_cosmetic_tag = XIA_puppet
	}
	else_if = {
		limit = {
			tag = KRS
		}
		set_cosmetic_tag = KRS_puppet
	}
	else_if = {
		limit = {
			tag = ATM
		}
		set_cosmetic_tag = ATM_puppet
	}
	else_if = {
		limit = {
			tag = SUY
		}
		set_cosmetic_tag = SUY_puppet
	}
}
#Warlord military governemnt tag
Warlord_becomes_military_government = { # USE when Warlord goes down coop nat and become fascist, tag includes the NRA flag and names
	if = {
		limit = {
			tag = GUD
		}
		set_cosmetic_tag = GUD_MG
	}
	else_if = {
		limit = {
			tag = GXC
		}
		set_cosmetic_tag = GXC_MG
	}
	else_if = {
		limit = {
			tag = YUN
		}
		set_cosmetic_tag = YUN_MG
	}
	else_if = {
		limit = {
			tag = SHX
		}
		set_cosmetic_tag = SHX_MG
	}
	else_if = {
		limit = {
			tag = XSM
		}
		set_cosmetic_tag = XSM_MG
	}
	else_if = {
		limit = {
			tag = XIK
		}
		set_cosmetic_tag = XIK_MG
	}
	else_if = {
		limit = {
			tag = SIC
		}
		set_cosmetic_tag = SIC_MG
	}
	else_if = {
		limit = {
			tag = HPC
		}
		set_cosmetic_tag = HPC_MG
	}
	else_if = {
		limit = {
			tag = NEA
		}
		set_cosmetic_tag = NEA_MG
	}
	else_if = {
		limit = {
			tag = SHD
		}
		set_cosmetic_tag = SHD_MG
	}
	else_if = {
		limit = {
			tag = NXM
		}
		set_cosmetic_tag = NXM_MG
	}
	else_if = {
		limit = {
			tag = SHC
		}
		set_cosmetic_tag = SHC_MG
	}
	else_if = {
		limit = {
			tag = GSM
		}
		set_cosmetic_tag = GSM_MG
	}
	else_if = {
		limit = {
			tag = EGM
		}
		set_cosmetic_tag = EGM_MG
	}
	else_if = {
		limit = {
			tag = TNG
		}
		set_cosmetic_tag = TNG_MG
	}
	else_if = {
		limit = {
			tag = HMI
		}
		set_cosmetic_tag = HMI_MG
	}
	else_if = {
		limit = {
			tag = KHR
		}
		set_cosmetic_tag = KHR_MG
	}
	else_if = {
		limit = {
			tag = XIA
		}
		set_cosmetic_tag = KHR_MG
	}
	else_if = {
		limit = {
			tag = KRS
		}
		set_cosmetic_tag = KRS_MG
	}
	else_if = {
		limit = {
			tag = ATM
		}
		set_cosmetic_tag = ATM_MG
	}
	else_if = {
		limit = {
			tag = SUY
		}
		set_cosmetic_tag = SUY_MG
	}
}

#WARLORD become revolutionary base area
Warlord_becomes_RBA = { # USE when Warlord goes down coop com and become communuist, tags include flags only, RBA are the names already.
	if = {
		limit = {
			tag = GUD
		}
		set_cosmetic_tag = GUD_CPC
	}
	else_if = {
		limit = {
			tag = GXC
		}
		set_cosmetic_tag = GXC_CPC
	}
	else_if = {
		limit = {
			tag = YUN
		}
		set_cosmetic_tag = YUN_CPC
	}
	else_if = {
		limit = {
			tag = SHX
		}
		set_cosmetic_tag = SHX_CPC
	}
	else_if = {
		limit = {
			tag = XSM
		}
		set_cosmetic_tag = XSM_CPC
	}
	else_if = {
		limit = {
			tag = XIK
		}
		set_cosmetic_tag = XIK_CPC
	}
	else_if = {
		limit = {
			tag = SIC
		}
		set_cosmetic_tag = SIC_CPC
	}
	else_if = {
		limit = {
			tag = HPC
		}
		set_cosmetic_tag = HPC_CPC
	}
	else_if = {
		limit = {
			tag = NEA
		}
		set_cosmetic_tag = NEA_CPC
	}
	else_if = {
		limit = {
			tag = SHD
		}
		set_cosmetic_tag = SHD_CPC
	}
	else_if = {
		limit = {
			tag = NXM
		}
		set_cosmetic_tag = NXM_CPC
	}
	else_if = {
		limit = {
			tag = SHC
		}
		set_cosmetic_tag = SHC_CPC
	}
	else_if = {
		limit = {
			tag = GSM
		}
		set_cosmetic_tag = GSM_CPC
	}
	else_if = {
		limit = {
			tag = EGM
		}
		set_cosmetic_tag = EGM_CPC
	}
	else_if = {
		limit = {
			tag = TNG
		}
		set_cosmetic_tag = TNG_CPC
	}
	else_if = {
		limit = {
			tag = HMI
		}
		set_cosmetic_tag = HMI_CPC
	}
	else_if = {
		limit = {
			tag = KHR
		}
		set_cosmetic_tag = KHR_CPC
	}
	else_if = {
		limit = {
			tag = XIA
		}
		set_cosmetic_tag = XIA_CPC
	}
	if = {
		limit = {
			has_completed_focus = SIK_a_new_provincial_government
		}
		drop_cosmetic_tag = yes
		set_cosmetic_tag = SIK_CPC
	}
	else_if = {
		limit = {
			tag = KRS
		}
		set_cosmetic_tag = KRS_CPC
	}
	else_if = {
		limit = {
			tag = ATM
		}
		set_cosmetic_tag = ATM_CPC
	}
	else_if = {
		limit = {
			tag = SUY
		}
		set_cosmetic_tag = SUY_CPC
	}
}

#WARLORD become people's republic
Warlord_becomes_PR = { # USE when Warlord goes down oppo and become communuist, tags include names only, PR are the flags already.
	if = {
		limit = {
			tag = GUD
		}
		set_cosmetic_tag = GUD_PR
	}
	else_if = {
		limit = {
			tag = GXC
		}
		set_cosmetic_tag = GXC_PR
	}
	else_if = {
		limit = {
			tag = YUN
		}
		set_cosmetic_tag = YUN_PR
	}
	else_if = {
		limit = {
			tag = SHX
		}
		set_cosmetic_tag = SHX_PR
	}
	else_if = {
		limit = {
			tag = XSM
		}
		set_cosmetic_tag = XSM_PR
	}
	else_if = {
		limit = {
			tag = XIK
		}
		set_cosmetic_tag = XIK_PR
	}
	else_if = {
		limit = {
			tag = SIC
		}
		set_cosmetic_tag = SIC_PR
	}
	else_if = {
		limit = {
			tag = HPC
		}
		set_cosmetic_tag = HPC_PR
	}
	else_if = {
		limit = {
			tag = NEA
		}
		set_cosmetic_tag = NEA_PR
	}
	else_if = {
		limit = {
			tag = SHD
		}
		set_cosmetic_tag = SHD_PR
	}
	else_if = {
		limit = {
			tag = NXM
		}
		set_cosmetic_tag = NXM_PR
	}
	else_if = {
		limit = {
			tag = SHC
		}
		set_cosmetic_tag = SHC_PR
	}
	else_if = {
		limit = {
			tag = GSM
		}
		set_cosmetic_tag = GSM_PR
	}
	else_if = {
		limit = {
			tag = EGM
		}
		set_cosmetic_tag = EGM_PR
	}
	else_if = {
		limit = {
			tag = TNG
		}
		set_cosmetic_tag = TNG_PR
	}
	else_if = {
		limit = {
			tag = HMI
		}
		set_cosmetic_tag = HMI_PR
	}
	else_if = {
		limit = {
			tag = KHR
		}
		set_cosmetic_tag = KHR_PR
	}
	else_if = {
		limit = {
			tag = XIA
		}
		set_cosmetic_tag = XIA_PR
	}
	else_if = {
		limit = {
			tag = KRS
		}
		set_cosmetic_tag = KRS_PR
	}
	else_if = {
		limit = {
			tag = ATM
		}
		set_cosmetic_tag = ATM_PR
	}
	else_if = {
		limit = {
			tag = SUY
		}
		set_cosmetic_tag = SUY_PR
	}
}
#Opposition Socialism path, tags include names, flags are ZG already
Warlord_becomes_ZG = {
	if = {
		limit = {
			tag = GUD
		}
		set_cosmetic_tag = GUD_ZG
	}
	else_if = {
		limit = {
			tag = GXC
		}
		set_cosmetic_tag = GXC_ZG
	}
	else_if = {
		limit = {
			tag = YUN
		}
		set_cosmetic_tag = YUN_ZG
	}
	else_if = {
		limit = {
			tag = SHX
		}
		set_cosmetic_tag = SHX_ZG
	}
	else_if = {
		limit = {
			tag = XSM
		}
		set_cosmetic_tag = XSM_ZG
	}
	else_if = {
		limit = {
			tag = XIK
		}
		set_cosmetic_tag = XIK_ZG
	}
	else_if = {
		limit = {
			tag = SIC
		}
		set_cosmetic_tag = SIC_ZG
	}
	else_if = {
		limit = {
			tag = HPC
		}
		set_cosmetic_tag = HPC_ZG
	}
	else_if = {
		limit = {
			tag = NEA
		}
		set_cosmetic_tag = NEA_ZG
	}
	else_if = {
		limit = {
			tag = SHD
		}
		set_cosmetic_tag = SHD_ZG
	}
	else_if = {
		limit = {
			tag = NXM
		}
		set_cosmetic_tag = NXM_ZG
	}
	else_if = {
		limit = {
			tag = SHC
		}
		set_cosmetic_tag = SHC_ZG
	}
	else_if = {
		limit = {
			tag = GSM
		}
		set_cosmetic_tag = GSM_ZG
	}
	else_if = {
		limit = {
			tag = EGM
		}
		set_cosmetic_tag = EGM_ZG
	}
	else_if = {
		limit = {
			tag = TNG
		}
		set_cosmetic_tag = TNG_ZG
	}
	else_if = {
		limit = {
			tag = HMI
		}
		set_cosmetic_tag = HMI_ZG
	}
	else_if = {
		limit = {
			tag = KHR
		}
		set_cosmetic_tag = KHR_ZG
	}
	else_if = {
		limit = {
			tag = XIA
		}
		set_cosmetic_tag = XIA_ZG
	}
	else_if = {
		limit = {
			tag = KRS
		}
		set_cosmetic_tag = KRS_ZG
	}
	else_if = {
		limit = {
			tag = ATM
		}
		set_cosmetic_tag = ATM_ZG
	}
	else_if = {
		limit = {
			tag = SUY
		}
		set_cosmetic_tag = SUY_ZG
	}
}
#FOR Political Consultative Assembly
allow_elections_scripted_effect = {
	#if = {
#	 limit = {
#		 has_government = neutrality
#	 }
#	 set_politics = {
	# 		ruling_party = neutrality
	# 		elections_allowed = yes
	# 	 }
	#}
	#else_if = {
#	 limit = {
#		 has_government = n_socialism
#	 }
#	 set_politics = {
	# 		ruling_party = neutrality
	# 		elections_allowed = yes
	# 	 }
	#}
	set_variable = { var = DAYS_OF_PROMISED_ELECTION value = 270 }
	unlock_national_focus = CHI_end_political_tutelage_focus
	custom_effect_tooltip = blank_line
	unlock_national_focus = CHI_begin_constitionalization_focus
	custom_effect_tooltip = blank_line
	unlock_national_focus = CHI_politics_and_governance_focus
	custom_effect_tooltip = blank_line
	unlock_national_focus = CHI_constitution_focus
	activate_mission = RCM_promise_of_election_mission
	custom_effect_tooltip = we_will_have_to_hold_the_election_in_a_year_tt
}
add_war_support_add_commie_leader = {
	add_war_support = 0.1
	
	event_target:WTT_communist_china = { #guo
	every_character = {
		limit = {
			not = { has_character_flag = FIN_anti_communist_character_flag }
		}
		set_character_flag = former_communist_forces
	}
	            every_unit_leader = {
				limit = {
					not = { has_unit_leader_flag = former_communist_forces }
				}
				set_unit_leader_flag = former_communist_forces
			    }
				
				every_army_leader = {
				limit = {
					not = { has_unit_leader_flag = former_communist_forces }
				}
				set_unit_leader_flag = former_communist_forces
			    }
	}
	
	if = {
		limit = {
		always = no #guo
			event_target:WTT_communist_china = {
				has_country_leader_with_trait = red_sun_of_the_people
			}
		}
		if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = prc_mao_zedong ruling_only = yes	}
				}
			}
			create_country_leader = {
				name = prc_mao_zedong
				desc = "POLITICS_MAO_ZEDONG_DESC"
				picture = "gfx/leaders/CHI/Portrait_China_Mao_Zedong.dds"
				expire = "1965.1.1"
				ideology = marxism
				traits = {
					red_sun_of_the_people
				}
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = prc_wang_ming ruling_only = yes	}
				}
			}
			create_country_leader = {
				name = prc_wang_ming
				desc = "POLITICS_MAO_ZEDONG_DESC"
				picture = "gfx/leaders/CHI/Portrait_China_Mao_Zedong.dds"
				expire = "1965.1.1"
				ideology = marxism
				traits = {
					red_sun_of_the_people
				}
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = prc_chen_duxiu ruling_only = yes }
				}
			}
			create_country_leader = {
				name = prc_chen_duxiu
				desc = "POLITICS_CHEN_DUXIU_DESC"
				picture = "Portrait_China_Chen_Duxiu.dds"
				expire = "1965.1.1"
				ideology = trotskyism
				traits = {
					red_sun_of_the_people
					permanent_revolutionary
				}
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = {
						character = prc_wang_fanxi ruling_only = yes
					}
				}
			}
			create_country_leader = {
				name = prc_wang_fanxi
				desc = "POLITICS_WANG_FANGXI_DESC"
				picture = "Portrait_PRC_Wang_Fanxi.dds"
				expire = "1965.1.1"
				ideology = trotskyism
				traits = {
					red_sun_of_the_people
				}
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = {
						character = prc_bo_gu ruling_only = yes
					}
				}
			}
			create_country_leader = {
				name = prc_bo_gu
				desc = "POLITICS_WANG_MING_DESC"
				picture = "gfx/leaders/PRC/Portrait_China_Bo_Gu.dds"
				expire = "1965.1.1"
				ideology = marxism
				traits = {
					red_sun_of_the_people
				}
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = prc_zhang_wentian ruling_only = yes }
				}
			}
			create_country_leader = {
				name = prc_zhang_wentian
				desc = "POLITICS_MAO_ZEDONG_DESC"
				picture = "Zhang_Wentian.dds"
				expire = "1965.1.1"
				ideology = marxism
				traits = {
					red_sun_of_the_people
				}
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = PRC_zhang_guotao ruling_only = yes	}
				}
			}
			create_country_leader = {
				name = PRC_zhang_guotao
				desc = "POLITICS_Zhang_Guotao_DESC"
				picture = "Portrait_China_Zhang_Guotao.dds"
				expire = "1965.1.1"
				ideology = marxism
				traits = {
					red_sun_of_the_people
					red_army_organizer
				}
			}
		}
	}
	else = { #guo
		hidden_effect = {
	    retire_ideology_leader = communism
		retire_ideology_leader = communism
		retire_ideology_leader = communism
		retire_ideology_leader = communism
		}
		if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = prc_mao_zedong ruling_only = yes	}
				}
			}
			hidden_effect = {
			retire_ideology_leader = communism
			retire_ideology_leader = communism
			}
			event_target:WTT_communist_china = {
			prc_mao_zedong = {
			set_portraits = {
			army={
				large="GFX_Mao_1949"
			}
		    }
			set_portraits = {
			civilian={
				large="GFX_Mao_1949"
			}
		    }
			}
				prc_mao_zedong = { set_nationality = event_target:WTT_current_china_leader }
			}
			prc_mao_zedong = {
			set_portraits = {
			army={
				large="GFX_Mao_1949"
			}
		    }
			set_portraits = {
			civilian={
				large="GFX_Mao_1949"
			}
		    }
			add_country_leader_role = {
			country_leader = {
				expire = "1976.9.9"
				ideology = marxism
				desc=prc_mao_zedong_desc
				traits = { tiancaidezhanluejia youjizhandashi hero_of_the_peasantry_MAO red_sun_of_the_people }
			}
			promote_leader = yes
		    }
			add_country_leader_role = {
			country_leader = {
				expire = "1976.9.9"
				ideology = maoism
				desc=prc_mao_zedong_desc
				traits = { tiancaidezhanluejia youjizhandashi hero_of_the_peasantry_MAO red_sun_of_the_people }
			}
			promote_leader = yes
		    }
			}
			
			if = {
			limit = { always = yes }
			
			hidden_effect = {
			create_country_leader = { #Safe because Sokolovsky doesn't exist ingame
				   name=""
				   picture = "gfx/leaders/PRC/maozedong1949.jpg"
				   ideology = marxism
				   desc=prc_mao_zedong_desc
				   traits = { tiancaidezhanluejia youjizhandashi hero_of_the_peasantry_MAO red_sun_of_the_people }
			    }
			create_country_leader = { #Safe because Sokolovsky doesn't exist ingame
				   name=""
				   picture = "gfx/leaders/PRC/maozedong1949.jpg"
				   ideology = marxism
				   desc=prc_mao_zedong_desc
				   traits = { tiancaidezhanluejia youjizhandashi hero_of_the_peasantry_MAO red_sun_of_the_people }
			    }	
			create_country_leader = { #Safe because Sokolovsky doesn't exist ingame
				   name=""
				   picture = "gfx/leaders/PRC/maozedong1949.jpg"
				   ideology = maoism
				   desc=prc_mao_zedong_desc
				   traits = { tiancaidezhanluejia youjizhandashi hero_of_the_peasantry_MAO red_sun_of_the_people }
			    }	
			}
			
			create_country_leader = { #Safe because Sokolovsky doesn't exist ingame
				   name=""
				   picture = "gfx/leaders/PRC/maozedong1949.jpg"
				   ideology = maoism
				   desc=prc_mao_zedong_desc
				   traits = { tiancaidezhanluejia youjizhandashi hero_of_the_peasantry_MAO red_sun_of_the_people }
			    }		
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = prc_wang_ming ruling_only = yes	}
				}
			}
			hidden_effect = {
			retire_ideology_leader = communism
			retire_ideology_leader = communism
			}
			event_target:WTT_communist_china = {
				prc_wang_ming = { set_nationality = event_target:WTT_current_china_leader }
			}
			prc_wang_ming = {
			add_country_leader_role = {
			country_leader = {
				expire = "1976.9.9"
				ideology = stalinism
				desc=prc_wang_ming_desc
					traits = { #guo
					stalins_puppet
					comintern_celebrity
					legitimate_heir
					staunch_stalinist
					}
			}
			promote_leader = yes
		    }
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = prc_chen_duxiu ruling_only = yes }
				}
			}
			hidden_effect = {
			retire_ideology_leader = communism
			retire_ideology_leader = communism
			}
			event_target:WTT_communist_china = {
				prc_chen_duxiu = { set_nationality = event_target:WTT_current_china_leader }
			}
			prc_chen_duxiu = {
			add_country_leader_role = {
			country_leader = {
				expire = "1976.9.9"
				ideology = trotskyism
				desc=prc_chen_duxiu_desc
				traits = { permanent_revolutionary revolutionary_author }
			}
			promote_leader = yes
		    }
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = prc_wang_fanxi ruling_only = yes }
				}
			}
			hidden_effect = {
			retire_ideology_leader = communism
			retire_ideology_leader = communism
			}
			event_target:WTT_communist_china = {
				prc_wang_fanxi = { set_nationality = event_target:WTT_current_china_leader }
			}
			prc_wang_fanxi = {
			add_country_leader_role = {
			country_leader = {
				expire = "1976.9.9"
				ideology = trotskyism
				desc=prc_wang_fanxi_desc
				traits = { permanent_revolutionary revolutionary_author }
			}
			promote_leader = yes
		    }
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = prc_bo_gu ruling_only = yes }
				}
			}
			hidden_effect = {
			retire_ideology_leader = communism
			retire_ideology_leader = communism
			}
			event_target:WTT_communist_china = {
				prc_bo_gu = { set_nationality = event_target:WTT_current_china_leader }
			}
			prc_bo_gu = {
			add_country_leader_role = {
			country_leader = {
				expire = "1976.9.9"
				ideology = marxism
				desc=prc_bo_gu_desc
				traits = { #guo
					comintern_celebrity
					propaganda_expert
					dangdelilunxuanchuanjia
					}
			}
			promote_leader = yes
		    }
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = { character = prc_zhang_wentian ruling_only = yes }
				}
			}
			hidden_effect = {
			retire_ideology_leader = communism
			retire_ideology_leader = communism
			}
			event_target:WTT_communist_china = {
				prc_zhang_wentian = { set_nationality = event_target:WTT_current_china_leader }
			}
			prc_zhang_wentian = {
			add_country_leader_role = {
			country_leader = {
				expire = "1976.9.9"
				ideology = marxism
				desc=prc_zhang_wentian_desc
				traits = { popular_figurehead appeaser }
			}
			promote_leader = yes
		    }
			}
		}
		else_if = {
			limit = {
				event_target:WTT_communist_china = {
					has_country_leader = {
						character = PRC_zhang_guotao ruling_only = yes
					}
				}
			}
			hidden_effect = {
			retire_ideology_leader = communism
			retire_ideology_leader = communism
			}
			event_target:WTT_communist_china = {
				PRC_zhang_guotao = { set_nationality = event_target:WTT_current_china_leader }
			}
			PRC_zhang_guotao = {
			add_country_leader_role = {
			country_leader = {
				expire = "1976.9.9"
				ideology = marxism
				desc=PRC_zhang_guotao_desc
				traits = { RCM_propaganda_expert comintern_celebrity dangdeyuanlao } #guo
			}
			promote_leader = yes
		    }
			}
		}
		
		hidden_effect = { #guo
		event_target:WTT_communist_china = {
				set_global_flag = prc_character_in_kmt
				PRC_su_yu = {
		set_portraits = {
			army={
				large="gfx/leaders/PRC/Portrait_PRC_Su_Yu.dds"
			}
		}
	}
				every_character = {
				limit = {
					not = { has_character_flag = FIN_anti_communist_character_flag }
				}
				set_nationality = event_target:WTT_current_china_leader
			    }
			}
			PRC_su_yu = {
		set_portraits = {
			army={
				large="gfx/leaders/PRC/Portrait_PRC_Su_Yu.dds"
			}
		}
	}
		}
	}
}
#add_chinese_government_institution = {}
annex_from_change_party_name_boost_commie_popularity= {
	add_ideas = CHI_communist_in_government
	custom_effect_tooltip = CHI_communist_in_government_tt
	annex_country = {
		target = event_target:WTT_communist_china
		transfer_troops = yes
	}
	set_party_name = {
		ideology = communism
		name = PRC_communism_party
		long_name = PRC_communism_party_long
	}
	if = {
		limit = {
			is_ai = yes
			event_target:WTT_communist_china = {
				is_ai = no
			}
		}
		set_global_flag = PRC_was_player_can_usurp_CHI
		add_popularity = {
			ideology = communism
			popularity = 0.25
		}
	}
	else = {
		add_popularity = {
			ideology = communism
			popularity = 0.35
		}	
	}
	if = {
		limit = {
			is_ai = yes
			event_target:WTT_communist_china = {
				is_ai = no
			}
		}
		#set_global_flag = PRC_was_player_can_usurp_CHI
		change_tag_from = FROM
	}
}

###LEARN DESIGNS
learn_air_designs = {
	effect_tooltip = {
		if = {
			limit = {
				has_idea = no_proper_equipment_design
			}
			swap_ideas = {
				remove_idea = tt_no_proper_equipment_design
				add_idea = tt_no_proper_equipment_design_no_air
			}
			set_country_flag = technical_school_halt
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = technical_school_halt
				}
				has_idea = no_proper_equipment_design_no_armor
			}
			swap_ideas = {
				remove_idea = tt_no_proper_equipment_design_no_armor
				add_idea = tt_no_proper_equipment_design_naval
			}
			set_country_flag = technical_school_halt
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = technical_school_halt
				}
				has_idea = no_proper_equipment_design_no_naval
			}
			swap_ideas = {
				remove_idea = tt_no_proper_equipment_design_no_naval
				add_idea = tt_no_proper_equipment_design_armor
			}
			set_country_flag = technical_school_halt
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = technical_school_halt
				}
				has_idea = no_proper_equipment_design_air
			}
			remove_ideas = tt_no_proper_equipment_design_air
		}
	}
	hidden_effect = {
		if = {
			limit = {
				has_idea = no_proper_equipment_design
			}
			swap_ideas = {
				remove_idea = no_proper_equipment_design
				add_idea = no_proper_equipment_design_no_air
			}
			set_country_flag = technical_school_halt
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = technical_school_halt
				}
				has_idea = no_proper_equipment_design_no_armor
			}
			swap_ideas = {
				remove_idea = no_proper_equipment_design_no_armor
				add_idea = no_proper_equipment_design_naval
			}
			set_country_flag = technical_school_halt
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = technical_school_halt
				}
				has_idea = no_proper_equipment_design_no_naval
			}
			swap_ideas = {
				remove_idea = no_proper_equipment_design_no_naval
				add_idea = no_proper_equipment_design_armor
			}
			set_country_flag = technical_school_halt
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = technical_school_halt
				}
				has_idea = no_proper_equipment_design_air
			}
			remove_ideas = no_proper_equipment_design_air
		}
	}
}
learn_naval_designs = {
	effect_tooltip = {
		if = {
			limit = {
				has_idea = no_proper_equipment_design
			}
			swap_ideas = {
				remove_idea = tt_no_proper_equipment_design
				add_idea = tt_no_proper_equipment_design_no_naval
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_no_armor
			}
			swap_ideas = {
				remove_idea = tt_no_proper_equipment_design_no_armor
				add_idea = tt_no_proper_equipment_design_air
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_no_air
			}
			swap_ideas = {
				remove_idea = tt_no_proper_equipment_design_no_air
				add_idea = tt_no_proper_equipment_design_armor
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_naval
			}
			remove_ideas = tt_no_proper_equipment_design_naval
		}
	}
	hidden_effect = {
		if = {
			limit = {
				has_idea = no_proper_equipment_design
			}
			swap_ideas = {
				remove_idea = no_proper_equipment_design
				add_idea = no_proper_equipment_design_no_naval
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_no_armor
			}
			swap_ideas = {
				remove_idea = no_proper_equipment_design_no_armor
				add_idea = no_proper_equipment_design_air
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_no_air
			}
			swap_ideas = {
				remove_idea = no_proper_equipment_design_no_air
				add_idea = no_proper_equipment_design_armor
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_naval
			}
			remove_ideas = no_proper_equipment_design_naval
		}
	}
}
learn_tank_designs = {
	effect_tooltip = {
		if = {
			limit = {
				has_idea = no_proper_equipment_design
			}
			swap_ideas = {
				remove_idea = tt_no_proper_equipment_design
				add_idea = tt_no_proper_equipment_design_no_armor
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_no_naval
			}
			swap_ideas = {
				remove_idea = tt_no_proper_equipment_design_no_naval
				add_idea = tt_no_proper_equipment_design_air
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_no_air
			}
			swap_ideas = {
				remove_idea = tt_no_proper_equipment_design_no_air
				add_idea = tt_no_proper_equipment_design_naval
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_armor
			}
			remove_ideas = tt_no_proper_equipment_design_armor
		}
	}
	hidden_effect = {
		if = {
			limit = {
				has_idea = no_proper_equipment_design
			}
			swap_ideas = {
				remove_idea = no_proper_equipment_design
				add_idea = no_proper_equipment_design_no_armor
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_no_naval
			}
			swap_ideas = {
				remove_idea = no_proper_equipment_design_no_naval
				add_idea = no_proper_equipment_design_air
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_no_air
			}
			swap_ideas = {
				remove_idea = no_proper_equipment_design_no_air
				add_idea = no_proper_equipment_design_naval
			}
		}
		if = {
			limit = {
				has_idea = no_proper_equipment_design_armor
			}
			remove_ideas = no_proper_equipment_design_armor
		}
	}
}


replace_arms_with_civ_factories_1 = {

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 0
		}
		remove_building = {
			type = arms_factory
			level = 1
		}
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 0
		}
		remove_building = {
			type = arms_factory
			level = 1
		}
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 0
		}
		remove_building = {
			type = arms_factory
			level = 1
		}
		#add_building_construction = {
		#	type = industrial_complex
		#	level = 1
		#	instant_build = yes
		#}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 0
		}
		remove_building = {
			type = arms_factory
			level = 1
		}
		#add_building_construction = {
		#	type = industrial_complex
		#	level = 1
		#	instant_build = yes
		#}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 0
		}
		remove_building = {
			type = arms_factory
			level = 1
		}
		#add_building_construction = {
		#	type = industrial_complex
		#	level = 1
		#	instant_build = yes
		#}
	}
}
replace_arms_with_civ_factories_2 = {

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 1
		}
		remove_building = {
			type = arms_factory
			level = 2
		}
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 1
		}
		remove_building = {
			type = arms_factory
			level = 2
		}
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 1
		}
		remove_building = {
			type = arms_factory
			level = 2
		}
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 1
		}
		remove_building = {
			type = arms_factory
			level = 2
		}
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 1
		}
		remove_building = {
			type = arms_factory
			level = 2
		}
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}
}
replace_arms_with_civ_factories_3 = {

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 2
		}
		remove_building = {
			type = arms_factory
			level = 3
		}
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 2
		}
		remove_building = {
			type = arms_factory
			level = 3
		}
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 2
		}
		remove_building = {
			type = arms_factory
			level = 3
		}
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 2
		}
		remove_building = {
			type = arms_factory
			level = 3
		}
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 2
		}
		remove_building = {
			type = arms_factory
			level = 3
		}
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}
}
replace_arms_with_civ_factories_4 = {

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 5
		}
		remove_building = {
			type = arms_factory
			level = 6
		}
		add_building_construction = {
			type = industrial_complex
			level = 3
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 5
		}
		remove_building = {
			type = arms_factory
			level = 6
		}
		add_building_construction = {
			type = industrial_complex
			level = 3
			instant_build = yes
		}
	}

	replace_arms_with_civ_factories_3 = yes

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			arms_factory > 2
		}
		remove_building = {
			type = arms_factory
			level = 3
		}
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
	}
}

replace_arms_with_civ_factories_5 = {
	replace_arms_with_civ_factories_4 = yes
	replace_arms_with_civ_factories_4 = yes
}


#hull note demand drop chinese land
drop_lands_in_china = {
	custom_effect_tooltip = drop_lands_in_china_tt
	hidden_effect = {
		for_each_scope_loop = {
		    array = JAP.subjects
		   	THIS = {
				if = {
					limit = {
						all_owned_state = {
							has_state_flag = china_core_state
							#PREV = {
							#	has_full_control_of_state = PREV
							#}
						}
					}
					event_target:WTT_current_china_leader = {
						annex_country = {
							target = PREV transfer_troops = no
						}
					}
				}
			}
		}
		for_each_scope_loop = {
		    array = CHI.core_states #dont use big china
		    THIS = {
				if = {
					limit = {
						NOT = {
							state = 524
						}
						NOT = {
							controller = {
								is_subject = no
								is_warlord = no
								has_war_together_with = event_target:WTT_current_china_leader
							}
						}
						is_owned_by_jap_or_its_puppet = yes
					}
					event_target:WTT_current_china_leader = {
						transfer_state = PREV
					}
				}
			}
		}
	}
}
drop_lands_in_indochina = {
	custom_effect_tooltip = drop_lands_in_indochina_tt
	hidden_effect = {
		for_each_scope_loop = {
		    array = FIC.core_states
		    THIS = {
				if = {
					limit = {
						OR = {
							AND = {
								is_owned_by = FIC
								is_controlled_by_jap_or_its_puppet = yes
							}
							is_owned_by_jap_or_its_puppet = yes
						}
					}
					FIC = {
						transfer_state = PREV
					}
				}
			}
		}
	}
}
reduce_cost_for_interservice_rivalry_army = {
	if = {
		limit = { has_dlc = "Waking the Tiger" }
		custom_effect_tooltip = reduce_cost_for_interservice_rivalry_army_tt
		subtract_from_variable = {
		    PP_COST_INTERSERVICE_RIVALRY_ARMY = 5
		}
	}
}
reduce_cost_for_interservice_rivalry_navy = {
	if = {
		limit = { has_dlc = "Waking the Tiger" }
		custom_effect_tooltip = reduce_cost_for_interservice_rivalry_navy_tt
		subtract_from_variable = {
		    PP_COST_INTERSERVICE_RIVALRY_NAVY = 5
		}
	}
}


#hold_first_general_election
hold_first_general_election = {
	if = { #KMT wins
		limit = {
			check_variable = { Root.party_popularity@neutrality > Root.party_popularity@communism }
			check_variable = { Root.party_popularity@neutrality > Root.party_popularity@democratic }
		}
		if = {
			limit = {
				has_country_flag = KMT_candidate_is_sun_fo
			}
			country_event = rcmchina_elections_alt.1
			else = {
				country_event = rcmchina_elections.1
			}
		}
	}
	else_if = { #CNSP wins
		limit = {
			NOT = { has_global_flag = cdl_founded }
			check_variable = { Root.party_popularity@democratic > Root.party_popularity@communism }
			check_variable = { Root.party_popularity@democratic > Root.party_popularity@neutrality }
		}
		if = {
			limit = {
				has_country_flag = CNSP_candidate_is_fulin
			}
			country_event = rcmchina_elections_alt.2
			else = {
				country_event = rcmchina_elections.2
			}
		}
	}
	else_if = {
		limit = { #CDL wins
			has_global_flag = cdl_founded
			check_variable = { Root.party_popularity@democratic > Root.party_popularity@communism }
			check_variable = { Root.party_popularity@democratic > Root.party_popularity@neutrality }
		}
		if = {
			limit = {
				has_country_flag = CDL_candidate_is_junru
			}
			country_event = rcmchina_elections_alt.3
			else = {
				country_event = rcmchina_elections.3
			}
		}
	}
	else_if = {
		limit = { #Commies wins, GG
			check_variable = { Root.party_popularity@communism > Root.party_popularity@neutrality }
			check_variable = { Root.party_popularity@communism > Root.party_popularity@democratic }
		}
		country_event = rcmchina_elections.4
	}
}
hold_future_general_election = {
	if = { #KMT wins
		limit = {
			##TODO
		}
		if = {
			limit = {
				has_country_flag = KMT_candidate_is_sun_fo
			}
			country_event = rcmchina_elections_alt.8
			else = {
				country_event = rcmchina_elections.8
			}
		}
	}
	else_if = { #CNSP wins
		limit = {
			NOT = { has_global_flag = cdl_founded }
			#TODO
		}
		if = {
			limit = {
				has_country_flag = CNSP_candidate_is_fulin
			}
			country_event = rcmchina_elections_alt.7
			else = {
				country_event = rcmchina_elections.7
			}
		}
	}
	else_if = {
		limit = { #CDL wins
			has_global_flag = cdl_founded
			#TODO
		}
		if = {
			limit = {
				has_country_flag = CDL_candidate_is_junru
			}
			country_event = rcmchina_elections_alt.6
			else = {
				country_event = rcmchina_elections.6
			}
		}
	}
}
set_up_ammo = {
	set_variable = {
		This.initial_munition = This.ammunition_max
	}
	if = { #CHinese countries
		limit = {
			is_literally_china = yes
		}
		multiply_variable = { This.initial_munition = 0.35 }
	}
	else_if = { # Majors
		limit = { 
			is_major = yes
		}
		multiply_variable = { This.initial_munition = 0.85 }
	}
	else_if = { #small minors
		limit = {
			num_of_military_factories < 5
		}
		multiply_variable = { This.initial_munition = 0.45 }
	}
	else = { #regular minors
		multiply_variable = { This.initial_munition = 0.6 }
	}
	

	add_to_variable = {
		This.ammunition_variable = This.initial_munition
	}
	set_country_flag = I_have_ammo

}
set_up_supply_condition = {
	add_dynamic_modifier = {
		modifier = RCM_supply_condition
	}
	set_variable = {
		This.supply_condition = 50
	}
	set_variable = {
		This.supply_condition_base = 50
	}
	set_variable = {
		This.supply_condition_weeky = 0
	}
	set_variable = {
		This.supply_condition_daily = 0
	}
	set_variable = {
		This.foreign_aid_ver_big = 0
	}
	set_variable = {
		This.foreign_aid_big = 0
	}
	set_variable = {
		This.foreign_aid_med = 0
	}
	set_variable = {
		This.foreign_aid_sml = 0
	}
	set_variable = {
		This.foreign_aid_ver_sml = 0
	}
	set_country_flag = I_have_supply_conditions
	supply_on_daily_effect = yes
}
first_revise_hiro_effect = {
	set_global_flag = no_shanghai_DMZ
	613 = {
		set_demilitarized_zone = no
	}
	set_autonomy = { target = HPC autonomy_state = autonomy_rcm_national_revolutionary_army }
}
second_revise_hiro_effect = {
	set_global_flag = no_shanghai_DMZ
	613 = {
		set_demilitarized_zone = no
	}
	annex_country = { target = HPC transfer_troops = yes }	
}
third_revise_hiro_effect = {
	set_global_flag = no_shanghai_DMZ
	613 = {
		set_demilitarized_zone = no
	}
	annex_country = { target = HPC transfer_troops = yes }
	annex_country = { target = ECA transfer_troops = yes }
}
fourth_revise_hiro_effect = {
	set_global_flag = no_shanghai_DMZ
	613 = {
		set_demilitarized_zone = no
	}
	annex_country = { target = HPC transfer_troops = yes }
	annex_country = { target = EHB transfer_troops = yes }
	annex_country = { target = ECA transfer_troops = yes }
}
#PUPPETING CODE (credit to Yard1) (FROM COOP SHARED RESOURCES, DH team are advised not to use)

#THIS is target - RUN BEFORE PUPPETING
get_current_government_type_global = {
	clr_global_flag = was_neutral_global
	clr_global_flag = was_communist_global
	clr_global_flag = was_democratic_global
	clr_global_flag = was_fascist_global
	clr_global_flag = was_socialist_global
	set_variable = { var = global.last_neutrality_pop value = party_popularity@neutrality }
	set_variable = { var = global.last_communism_pop value = party_popularity@communism }
	set_variable = { var = global.last_democratic_pop value = party_popularity@democratic }
	set_variable = { var = global.last_fascism_pop value = party_popularity@fascism }
	set_variable = { var = global.last_socialist_pop value = party_popularity@n_socialism }
	if = {
		limit = { has_government = neutrality }
		set_global_flag = was_neutral_global
	}
	else_if = {
		limit = { has_government = communism }
		set_global_flag = was_communist_global
	}
	else_if = {
		limit = { has_government = democratic }
		set_global_flag = was_democratic_global
	}
	else_if = {
		limit = { has_government = fascism }
		set_global_flag = was_fascist_global
	}
	else_if = {
		limit = { has_government = n_socialism }
		set_global_flag = was_socialist_global
	}
}
#THIS is target - RUN AFTER PUPPETING having ran get_current_government_type before
restore_previous_government_type_global = {
	hidden_effect = {
		subtract_from_variable = {
			var = global.last_neutrality_pop
			value = party_popularity@neutrality
		}
		add_popularity = {
			ideology = neutrality
			popularity = global.last_neutrality_pop
		}
		clear_variable = global.last_neutrality_pop
		subtract_from_variable = {
			var = global.last_communism_pop
			value = party_popularity@communism
		}
		add_popularity = {
			ideology = communism
			popularity = global.last_communism_pop
		}
		clear_variable = global.last_communism_pop
		subtract_from_variable = {
			var = global.last_democratic_pop
			value = party_popularity@democratic
		}
		add_popularity = {
			ideology = democratic
			popularity = global.last_democratic_pop
		}
		clear_variable = global.last_democratic_pop
		subtract_from_variable = {
			var = global.last_fascism_pop
			value = party_popularity@fascism
		}
		add_popularity = {
			ideology = fascism
			popularity = global.last_fascism_pop
		}
		clear_variable = global.last_fascism_pop
		subtract_from_variable = {
			var = global.last_socialist_pop
			value = party_popularity@n_socialism
		}
		add_popularity = {
			ideology = n_socialism
			popularity = global.last_socialist_pop
		}
		clear_variable = global.last_socialist_pop
		if = {
			limit = { has_global_flag = was_neutral_global }
			#set_country_leader_ideology = moderatism
			set_politics = { ruling_party = neutrality }
			retire_country_leader = yes
		}
		else_if = {
			limit = { has_global_flag = was_communist_global }
			#set_country_leader_ideology = marxism
			set_politics = { ruling_party = communism }
			retire_country_leader = yes
		}
		else_if = {
			limit = { has_global_flag = was_democratic_global }
			#set_country_leader_ideology = liberalism
			set_politics = { ruling_party = democratic }
			retire_country_leader = yes
		}
		else_if = {
			limit = { has_global_flag = was_fascist_global }
			#set_country_leader_ideology = fascism_ideology
			set_politics = { ruling_party = fascism }
			retire_country_leader = yes
		}
		else_if = {
			limit = { has_global_flag = was_socialist_global }
			#set_country_leader_ideology = n_socialism_ideology
			set_politics = { ruling_party = n_socialism }
			retire_country_leader = yes
		}
	}
}


get_current_government_type = {
	clr_country_flag = was_neutral
	clr_country_flag = was_communist
	clr_country_flag = was_democratic
	clr_country_flag = was_fascist
	clr_country_flag = was_socialist
	set_variable = { var = last_neutrality_pop value = party_popularity@neutrality }
	set_variable = { var = last_communism_pop value = party_popularity@communism }
	set_variable = { var = last_democratic_pop value = party_popularity@democratic }
	set_variable = { var = last_fascism_pop value = party_popularity@fascism }
	set_variable = { var = last_socialist_pop value = party_popularity@n_socialism }
	if = {
		limit = { has_government = neutrality }
		set_country_flag = was_neutral
	}
	else_if = {
		limit = { has_government = communism }
		set_country_flag = was_communist
	}
	else_if = {
		limit = { has_government = democratic }
		set_country_flag = was_democratic
	}
	else_if = {
		limit = { has_government = fascism }
		set_country_flag = was_fascist
	}
	else_if = {
		limit = { has_government = n_socialism }
		set_country_flag = was_socialist
	}
}

#THIS is target - RUN AFTER PUPPETING having ran get_current_government_type before
restore_previous_government_type = {
	hidden_effect = {
		subtract_from_variable = {
			var = last_neutrality_pop
			value = party_popularity@neutrality
		}
		add_popularity = {
			ideology = neutrality
			popularity = last_neutrality_pop
		}
		clear_variable = last_neutrality_pop
		subtract_from_variable = {
			var = last_communism_pop
			value = party_popularity@communism
		}
		add_popularity = {
			ideology = communism
			popularity = last_communism_pop
		}
		clear_variable = last_communism_pop
		subtract_from_variable = {
			var = last_democratic_pop
			value = party_popularity@democratic
		}
		add_popularity = {
			ideology = democratic
			popularity = last_democratic_pop
		}
		clear_variable = last_democratic_pop
		subtract_from_variable = {
			var = last_fascism_pop
			value = party_popularity@fascism
		}
		add_popularity = {
			ideology = fascism
			popularity = last_fascism_pop
		}
		clear_variable = last_fascism_pop
		subtract_from_variable = {
			var = last_socialist_pop
			value = party_popularity@n_socialism
		}
		add_popularity = {
			ideology = n_socialism
			popularity = last_socialist_pop
		}
		clear_variable = last_socialist_pop
		if = {
			limit = { has_country_flag = was_neutral }
			set_politics = { ruling_party = neutrality }
		}
		else_if = {
			limit = { has_country_flag = was_communist }
			set_politics = { ruling_party = communism }
		}
		else_if = {
			limit = { has_country_flag = was_democratic }
			set_politics = { ruling_party = democratic }
		}
		else_if = {
			limit = { has_country_flag = was_fascist }
			set_politics = { ruling_party = fascism }
		}
		else_if = {
			limit = { has_country_flag = was_socialist }
			set_politics = { ruling_party = n_socialism }
		}
	}
}


#RANDOM BUILDING CODE (credit to Yard1) (FROM COOP SHARED RESOURCES, DH team are advised not to use)
one_random_arms_factory = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}
two_random_arms_factory = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = arms_factory
			level = 2
			instant_build = yes
		}
	}
}
three_random_arms_factory = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = arms_factory
			level = 2
			instant_build = yes
		}
	}
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}
four_random_arms_factory = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = arms_factory
			level = 2
			instant_build = yes
		}
	}
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = arms_factory
			level = 2
			instant_build = yes
		}
	}
}
one_random_industrial_complex = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = industrial_complex
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}
}
two_random_industrial_complex = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = industrial_complex
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
	}
}
three_random_industrial_complex = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = industrial_complex
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 3
		add_building_construction = {
			type = industrial_complex
			level = 3
			instant_build = yes
		}
	}
}
four_random_industrial_complex = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = industrial_complex
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
	}
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = industrial_complex
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
	}
}
one_random_infrastructure = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = infrastructure
				size > 1
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = infrastructure
								size > 1
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_building_construction = {
			type = infrastructure
			level = 2
			instant_build = yes
		}
	}
}
one_random_dockyard = {
	if = {
		limit = {
			NOT = {
				any_owned_state = {
					dockyard > 0
					free_building_slots = {
						building = dockyard
						size > 2
						include_locked = yes
					}
				}
			}
			any_owned_state = {
				is_coastal = yes
			}
		}
		random_owned_controlled_state = {
			limit = {
				is_coastal = yes
				free_building_slots = {
					building = dockyard
					size > 2
					include_locked = yes
				}
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = dockyard
				level = 1
				instant_build = yes
			}
		}
	}
	if = {
		limit = {
			NOT = { has_country_flag = naval_effort_built }
			any_owned_state = {
				dockyard > 0
				free_building_slots = {
					building = dockyard
					size > 1
					include_locked = yes
				}
			}
		}
		random_owned_controlled_state = {
			limit = {
				dockyard > 0
				free_building_slots = {
					building = dockyard
					size > 1
					include_locked = yes
				}
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = dockyard
				level = 1
				instant_build = yes
			}
		}
	}
	if = {
		limit = {
			NOT = { has_country_flag = naval_effort_built }
			NOT = {
				any_owned_state = {
					free_building_slots = {
						building = dockyard
						size > 1
						include_locked = yes
					}
				}
			}
		}
		random_state = {
			limit = {
				controller = { tag = ROOT }
				free_building_slots = {
					building = dockyard
					size > 1
					include_locked = yes
				}
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = dockyard
				level = 1
				instant_build = yes
			}
		}
	}
}
two_random_dockyards = {
	if = {
		limit = {
			NOT = {
				any_owned_state = {
					dockyard > 0
					free_building_slots = {
						building = dockyard
						size > 2
						include_locked = yes
					}
				}
			}
			any_owned_state = {
				is_coastal = yes
			}
		}
		random_owned_controlled_state = {
			limit = {
				is_coastal = yes
				free_building_slots = {
					building = dockyard
					size > 2
					include_locked = yes
				}
			}
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = dockyard
				level = 2
				instant_build = yes
			}
		}
		set_country_flag = naval_effort_built
	}
	if = {
		limit = {
			NOT = { has_country_flag = naval_effort_built }
			any_owned_state = {
				dockyard > 0
				free_building_slots = {
					building = dockyard
					size > 2
					include_locked = yes
				}
			}
		}
		random_owned_controlled_state = {
			limit = {
				dockyard > 0
				free_building_slots = {
					building = dockyard
					size > 2
					include_locked = yes
				}
			}
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = dockyard
				level = 2
				instant_build = yes
			}
		}
		set_country_flag = naval_effort_built
	}
	if = {
		limit = {
			NOT = { has_country_flag = naval_effort_built }
			NOT = {
				any_owned_state = {
					free_building_slots = {
						building = dockyard
						size > 2
						include_locked = yes
					}
				}
			}
		}
		random_state = {
			limit = {
				controller = { tag = ROOT }
				free_building_slots = {
					building = dockyard
					size > 2
					include_locked = yes
				}
			}
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = dockyard
				level = 2
				instant_build = yes
			}
		}
	}
}

WRL_propaganda_for_border_conflict = {
	if = {
		limit = {
			NOT = {
				OR = {
					has_country_flag = WRL_propaganda_flag@FROM
					has_country_flag = WRL_propaganda_2_flag@FROM
					has_country_flag = WRL_propaganda_3_flag@FROM
					has_country_flag = WRL_propaganda_4_flag@FROM
					has_country_flag = WRL_propaganda_5_flag@FROM
				}
			}
		}
		add_opinion_modifier = {
			target = FROM modifier = WRL_propaganda
		}
		set_country_flag = WRL_propaganda_flag@FROM
	}
	else_if = {
		limit = {
			has_country_flag = WRL_propaganda_flag@FROM
		}
		remove_opinion_modifier = {
			target = FROM
			modifier = WRL_propaganda
		}
		clr_country_flag = WRL_propaganda_flag@FROM
		add_opinion_modifier = {
			target = FROM modifier = WRL_propaganda_2
		}				
		set_country_flag = WRL_propaganda_2_flag@FROM
	}
	else_if = {
		limit = {
			has_country_flag = WRL_propaganda_2_flag@FROM
		}
		remove_opinion_modifier = {
			target = FROM
			modifier = WRL_propaganda_2
		}
		clr_country_flag = WRL_propaganda_2_flag@FROM
		add_opinion_modifier = {
			target = FROM modifier = WRL_propaganda_3
		}				
		set_country_flag = WRL_propaganda_3_flag@FROM
	}
	else_if = {
		limit = {
			has_country_flag = WRL_propaganda_3_flag@FROM
		}
		remove_opinion_modifier = {
			target = FROM
			modifier = WRL_propaganda_3
		}
		clr_country_flag = WRL_propaganda_3_flag@FROM
		add_opinion_modifier = {
			target = FROM modifier = WRL_propaganda_4
		}				
		set_country_flag = WRL_propaganda_4_flag@FROM
	}
	else_if = {
		limit = {
			has_country_flag = WRL_propaganda_4_flag@FROM
		}
		remove_opinion_modifier = {
			target = FROM
			modifier = WRL_propaganda_4
		}
		clr_country_flag = WRL_propaganda_4_flag@FROM
		add_opinion_modifier = {
			target = FROM modifier = WRL_propaganda_5
		}				
		set_country_flag = WRL_propaganda_5_flag@FROM
	}
}

WRL_insult_for_border_conflict = { #scope: FROM
	if = {
		limit = {
			NOT = {
				OR = {
					has_country_flag = WRL_insults_flag@ROOT
					has_country_flag = WRL_insults_2_flag@ROOT
					has_country_flag = WRL_insults_3_flag@ROOT
					has_country_flag = WRL_insults_4_flag@ROOT
					has_country_flag = WRL_insults_5_flag@ROOT
				}
			}
		}
		add_opinion_modifier = {
			target = ROOT modifier = WRL_insults
		}
		set_country_flag = WRL_insults_flag@ROOT
	}
	else_if = {
		limit = {
			has_country_flag = WRL_insults_flag@ROOT
		}
		remove_opinion_modifier = {
			target = ROOT
			modifier = WRL_insults
		}
		clr_country_flag = WRL_insults_flag@ROOT
		add_opinion_modifier = {
			target = ROOT modifier = WRL_insults_2
		}				
		set_country_flag = WRL_insults_2_flag@ROOT
	}
	else_if = {
		limit = {
			has_country_flag = WRL_insults_2_flag@ROOT
		}
		remove_opinion_modifier = {
			target = ROOT
			modifier = WRL_insults_2
		}
		clr_country_flag = WRL_insults_2_flag@ROOT
		add_opinion_modifier = {
			target = ROOT modifier = WRL_insults_3
		}				
		set_country_flag = WRL_insults_3_flag@ROOT
	}
	else_if = {
		limit = {
			has_country_flag = WRL_insults_3_flag@ROOT
		}
		remove_opinion_modifier = {
			target = ROOT
			modifier = WRL_insults_3
		}
		clr_country_flag = WRL_insults_3_flag@ROOT
		add_opinion_modifier = {
			target = ROOT modifier = WRL_insults_4
		}				
		set_country_flag = WRL_insults_4_flag@ROOT
	}
	else_if = {
		limit = {
			has_country_flag = WRL_insults_4_flag@ROOT
		}
		remove_opinion_modifier = {
			target = ROOT
			modifier = WRL_insults_4
		}
		clr_country_flag = WRL_insults_4_flag@ROOT
		add_opinion_modifier = {
			target = ROOT modifier = WRL_insults_5
		}				
		set_country_flag = WRL_insults_5_flag@ROOT
	}
}

WRL_insult_for_border_conflict_event = { #scope: FROM
	if = {
		limit = {
			NOT = {
				OR = {
					has_country_flag = WRL_insults_flag@FROM
					has_country_flag = WRL_insults_2_flag@FROM
					has_country_flag = WRL_insults_3_flag@FROM
					has_country_flag = WRL_insults_4_flag@FROM
					has_country_flag = WRL_insults_5_flag@FROM
				}
			}
		}
		add_opinion_modifier = {
			target = FROM modifier = WRL_insults
		}
		set_country_flag = WRL_insults_flag@FROM
	}
	else_if = {
		limit = {
			has_country_flag = WRL_insults_flag@FROM
		}
		remove_opinion_modifier = {
			target = FROM
			modifier = WRL_insults
		}
		clr_country_flag = WRL_insults_flag@FROM
		add_opinion_modifier = {
			target = FROM modifier = WRL_insults_2
		}				
		set_country_flag = WRL_insults_2_flag@FROM
	}
	else_if = {
		limit = {
			has_country_flag = WRL_insults_2_flag@FROM
		}
		remove_opinion_modifier = {
			target = FROM
			modifier = WRL_insults_2
		}
		clr_country_flag = WRL_insults_2_flag@FROM
		add_opinion_modifier = {
			target = FROM modifier = WRL_insults_3
		}				
		set_country_flag = WRL_insults_3_flag@FROM
	}
	else_if = {
		limit = {
			has_country_flag = WRL_insults_3_flag@FROM
		}
		remove_opinion_modifier = {
			target = FROM
			modifier = WRL_insults_3
		}
		clr_country_flag = WRL_insults_3_flag@FROM
		add_opinion_modifier = {
			target = FROM modifier = WRL_insults_4
		}				
		set_country_flag = WRL_insults_4_flag@FROM
	}
	else_if = {
		limit = {
			has_country_flag = WRL_insults_4_flag@FROM
		}
		remove_opinion_modifier = {
			target = FROM
			modifier = WRL_insults_4
		}
		clr_country_flag = WRL_insults_4_flag@FROM
		add_opinion_modifier = {
			target = FROM modifier = WRL_insults_5
		}				
		set_country_flag = WRL_insults_5_flag@FROM
	}
}

#JAP PURGE DOWN
JAP_officers_purged_down = {
	if = {
		limit = {
			has_idea = officer_purged_jap
		}
		swap_ideas = { 
			remove_idea = officer_purged_jap
			add_idea = officer_purged_jap_1
		} 
	}
	else_if = {
		limit = {
			has_idea = officer_purged_jap_1
		}
		swap_ideas = { 
			remove_idea = officer_purged_jap_1
			add_idea = officer_purged_jap_2
		}
	}
	else_if = {
		limit = {
			has_idea = officer_purged_jap_2
		}
		swap_ideas = { 
			remove_idea = officer_purged_jap_2
			add_idea = officer_purged_jap_3
		}
	}
	else_if = {
		limit = {
			has_idea = officer_purged_jap_3
		}
		swap_ideas = { 
			remove_idea = officer_purged_jap_3
			add_idea = officer_purged_jap_4
		}
	}
	else_if = {
		limit = {
			has_idea = officer_purged_jap_4
		}
		remove_ideas = officer_purged_jap_4
	}
}

damage_building_one_civ_one_mil = {
	random_list = {
		25 = {
		}
		25 = {
			damage_building = {
				type = arms_factory
				damage = 0.7
			}
			damage_building = {
				type = industrial_complex
				damage = 0.3
			}
		}
		25 = {
			damage_building = {
				type = arms_factory
				damage = 0.3
			}
			damage_building = {
				type = industrial_complex
				damage = 0.7
			}
		}
		25 = {
			damage_building = {
				type = arms_factory
				damage = 0.7
			}
			damage_building = {
				type = industrial_complex
				damage = 0.7
			}
		}
	}
}

move_building_damage = {
	if = {
		limit = {
			check_variable = {
				Root.SFT_industrial_complex_level < 2
			}
			check_variable = {
				Root.SFT_arms_factory_level < 2
			}
		}
		damage_building_one_civ_one_mil = yes
	}
	else_if = {
		limit = {
			check_variable = {
				Root.SFT_industrial_complex_level < 3
			}
			check_variable = {
				Root.SFT_arms_factory_level < 3
			}
		}
		damage_building_one_civ_one_mil = yes
		damage_building_one_civ_one_mil = yes
	}
	else_if = {
		limit = {
			check_variable = {
				Root.SFT_industrial_complex_level < 4
			}
			check_variable = {
				Root.SFT_arms_factory_level < 4
			}
		}
		damage_building_one_civ_one_mil = yes
		damage_building_one_civ_one_mil = yes
		damage_building_one_civ_one_mil = yes
	}
	else_if = {
		limit = {
			check_variable = {
				Root.SFT_industrial_complex_level < 5
			}
			check_variable = {
				Root.SFT_arms_factory_level < 5
			}
		}
		damage_building_one_civ_one_mil = yes
		damage_building_one_civ_one_mil = yes
		damage_building_one_civ_one_mil = yes
		damage_building_one_civ_one_mil = yes
	}
	else_if = {
		limit = {
			check_variable = {
				Root.SFT_industrial_complex_level < 6
			}
			check_variable = {
				Root.SFT_arms_factory_level < 6
			}
		}
		damage_building_one_civ_one_mil = yes
		damage_building_one_civ_one_mil = yes
		damage_building_one_civ_one_mil = yes
		damage_building_one_civ_one_mil = yes
		damage_building_one_civ_one_mil = yes
	}
}

plunder_one_random_state = {	
	random_state = {
		limit = {
			#has_state_flag = plundered_state
			is_fully_controlled_by = ROOT
			NOT = {
				is_owned_by = ROOT
			}
			industrial_complex > 5
		}
		#set_state_flag = plundered_state
		remove_building = {
			type = industrial_complex
			level = This.industrial_complex_level
		}
	}
}



#CHI SOV PEACE #ROOT IS CHI
CHI_SOV_peace = { #guo
	every_enemy_country = {
		limit = {
			is_in_faction_with = SOV
		}
		ROOT = {
			white_peace = PREV
		}
	}			
	
	every_country = { #guo
		limit = {
			is_in_faction_with = ROOT
			is_faction_leader = yes
			not = { tag = ROOT }
			is_ai = yes
		}
		    if = {
			limit = { has_war_with = SOV }
		    white_peace = SOV
			}
			if = {
			limit = { has_war_with = PRC }
		    white_peace = PRC
			}
			if = {
			limit = { has_war_with = MON }
		    white_peace = MON
			}
			if = {
			limit = { has_war_with = TAN }
		    white_peace = TAN
			}
			if = {
			limit = { has_war_with = SIK }
		    white_peace = SIK
			}
	}
	
	every_country = {
		limit = {
			is_in_faction_with = ROOT
			capital_scope = { is_on_continent = asia }
			NOT = { tag = ROOT }
		}
		if = {
			limit = { ROOT = { is_faction_leader = yes } }
			white_peace = SOV
			white_peace = PRC
			white_peace = MON
			white_peace = TAN
			white_peace = SIK
		}
		else = {
			random_country = {
				limit = {
					is_faction_leader = yes
					is_in_faction_with = ROOT
				}
				set_country_flag = peace_sov_@ROOT
				remove_from_faction = ROOT
			}
		}
	}
	every_country = {
		limit = {
			is_in_faction_with = SOV
			NOT = { tag = SOV }
		}
		white_peace = ROOT
	}
	every_country = {
		limit = {
			has_country_flag = peace_sov_@ROOT
		}
		add_to_faction = ROOT
	}
}

reclaim_claim_cores_from_SOV = { #need wars
	every_enemy_country = {
		limit = {
			is_in_faction_with = SOV
			all_owned_state = {
				OR = {
					is_core_of = ROOT
					is_claimed_by = ROOT
				}
			}
		}
		ROOT = {
			annex_country = { target = PREV transfer_troops = no }
		}
	}			
	every_state = {
		limit = {
			AND = {
				owner = {
					OR = {
						tag = SOV
						is_in_faction_with = SOV
					}
				}
				controller = {
					OR = {
						tag = ROOT
						tag = SOV
						is_in_faction_with = SOV
					}
				}
			}
			OR = {
				is_claimed_by = ROOT
				is_core_of = ROOT
			}
		}
		ROOT = {
			transfer_state = PREV
		}
	}
}

reclaim_claim_cores_from_SOV_small = { #need wars
	every_enemy_country = {
		limit = {
			is_in_faction_with = SOV
			OR = {
				tag = event_target:WTT_communist_china				
				all_owned_state = {
					OR = {
						is_core_of = ROOT
					}
				}
			}
		}
		ROOT = {
			annex_country = { target = PREV transfer_troops = no }
		}
	}			
	every_state = {
		limit = {
			AND = {
				owner = {
					OR = {
						tag = SOV
						is_in_faction_with = SOV
					}
				}
				controller = {
					OR = {
						tag = ROOT
						tag = SOV
						is_in_faction_with = SOV
					}
				}
			}
			OR = {
				is_core_of = ROOT
			}
		}
		ROOT = {
			transfer_state = PREV
		}
	}
}

JAP_USA_sanctions_level_down = {
	if = {
		limit = {
			has_idea = JAP_USA_sanctions_idea_4
		}
		swap_ideas = {
			add_idea = JAP_USA_sanctions_idea_3
			remove_idea = JAP_USA_sanctions_idea_4
		}
	}
	else_if = {
		limit = {
			has_idea = JAP_USA_sanctions_idea_3
		}
		swap_ideas = {
			add_idea = JAP_USA_sanctions_idea_2
			remove_idea = JAP_USA_sanctions_idea_3
		}
	}
	else_if = {
		limit = {
			has_idea = JAP_USA_sanctions_idea_2
		}
		swap_ideas = {
			add_idea = JAP_USA_sanctions_idea_1
			remove_idea = JAP_USA_sanctions_idea_2
		}
	}
	else_if = {
		limit = {
			has_idea = JAP_USA_sanctions_idea_1
		}
		remove_ideas = JAP_USA_sanctions_idea_1
	}
}

#GET THE CORRECT CONTROLLER output: event_target:correct_controller
get_correct_controller_of_state = {
	clear_global_event_target = correct_controller
	every_country = {
		set_variable = { This.total_vp = 0 }
	}
	clear_array = global.compare_vp_array
	meta_effect = { 
	    text = {
	       	for_each_loop = {
				array = [THIS_STATE_ID].provinces
				every_country = {
					limit = {
						controls_province = v
					}
					add_to_variable = { This.total_vp = global.victory_points^v }
				}
			}
	    }
	    THIS_STATE_ID = "[?This.true_test_id|00]"
	    #debug = yes #set to yes if you want to see what game actually executes
	}
	every_country = {
		limit = { check_variable = { This.total_vp > 0 } }
		add_to_array = {
			global.compare_vp_array = This.total_vp
		}
	}
	find_highest_in_array = {
		array = global.compare_vp_array
		value = temp_vp
	}
	random_country = {
		limit = { check_variable = { This.total_vp > 0 } check_variable = { This.total_vp = temp_vp } }
		save_global_event_target_as = correct_controller
		#custom_effect_tooltip = "[?This.total_vp|]"
	}
	
	#custom_effect_tooltip = "[correct_controller.GetName]"
}



# HoI4 State Land Connection Indexer by Yard1
# Provides a simple way to check if two states share a land connection
# Call the scripted effect below in on_startup from a country scope (any will do, I suggest random_country)
# In order to check if two states have a land connection to each other, compare their state_land_connection_index variables. If they are the same, then they have a land connection.
# HoI4 State Land Connection Indexer by Yard1
# Provides a simple way to check if two states share a land connection
# Call the scripted effect below in on_startup from a country scope (any will do, I suggest random_country)
# In order to check if two states have a land connection to each other, compare their state_land_connection_index variables. If they are the same, then they have a land connection.
mark_land_connected_states = {
	random_country = {
		set_variable = { global.current_state_land_connection_index = 1 }
		every_state = {
			add_to_array = { global.unchecked_land_connection_states = THIS }
		}
		while_loop_effect = {
			limit = {
				check_variable = { global.unchecked_land_connection_states^num > 0 }
			}
			log = "Run land connection loop with index [?global.current_state_land_connection_index|0], [?global.unchecked_land_connection_states^num|0] states left to index"
			var:global.unchecked_land_connection_states^0 = {
				log = "Adding index [?global.current_state_land_connection_index|0] to [?this.GetName]"
				set_variable = { state_land_connection_index = global.current_state_land_connection_index }
				every_neighbor_state = {
					log = "Adding index [?global.current_state_land_connection_index|0] to [?this.GetName], neighbor of [?prev.GetName]"
					set_variable = { state_land_connection_index = global.current_state_land_connection_index }
					if = {
						limit = { is_in_array = { global.unchecked_land_connection_states = THIS } }
						remove_from_array = { global.unchecked_land_connection_states = THIS }
					}
				}
				remove_from_array = { global.unchecked_land_connection_states = THIS }
			}
			set_temp_variable = { temp_lc_state = 0 }
			while_loop_effect = {
				limit = {
					any_of = {
						array = global.unchecked_land_connection_states
						var:v = {
							any_neighbor_state = { has_variable = state_land_connection_index }
						}
						set_temp_variable = { global.temp_lc_state = v }
					}
				}
				if = {
					limit = { NOT = { check_variable = { temp_lc_state = 0 } } }
					log = "Found [?temp_lc_state.GetName] as a neighbor of an indexed state"
					var:temp_lc_state = {
						log = "Adding index [?global.current_state_land_connection_index|0] to [?this.GetName]"
						set_variable = { state_land_connection_index = global.current_state_land_connection_index }
						remove_from_array = { global.unchecked_land_connection_states = THIS }
						every_neighbor_state = {
							log = "Adding index [?global.current_state_land_connection_index|0] to [?this.GetName], neighbor of [?prev.GetName]"
							set_variable = { state_land_connection_index = global.current_state_land_connection_index }
							if = {
								limit = { is_in_array = { global.unchecked_land_connection_states = THIS } }
								remove_from_array = { global.unchecked_land_connection_states = THIS }
							}
						}
					}
				}
			}
			log = "Land connection loop done, [?global.unchecked_land_connection_states^num|0] states left to index"
			log = "----"
			add_to_variable = { global.current_state_land_connection_index = 1 }
		}
		clear_variable = global.current_state_land_connection_index
		clear_array = global.unchecked_land_connection_states
	}
}


#JAP CHRISTIAN BAN EFFECT
JAP_ban_persecution_15_35_50 = {
	custom_effect_tooltip = JAP_ban_persecution_15_35_50_tt
	hidden_effect = {
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.1
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.1
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.1
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.2
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.2
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.2
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.3
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.3
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.3
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.4
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.4
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.4
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.5
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.5
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.5
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.6
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.6
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.6
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.7
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.7
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.7
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.8
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.8
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.8
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.9
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.9
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.9
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.10
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.10
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.10
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.11
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.11
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.11
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.12
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.12
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.12
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.13
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.13
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.13
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.14
			}
			35 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.14
			}
			50 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.14
			}
		}
	}
}
JAP_ban_persecution_20_40_40 = {
	custom_effect_tooltip = JAP_ban_persecution_20_40_40_tt
	hidden_effect = {
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.1
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.1
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.1
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.2
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.2
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.2
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.3
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.3
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.3
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.4
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.4
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.4
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.5
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.5
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.5
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.6
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.6
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.6
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.7
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.7
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.7
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.8
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.8
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.8
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.9
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.9
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.9
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.10
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.10
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.10
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.11
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.11
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.11
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.12
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.12
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.12
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.13
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.13
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.13
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.14
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.14
			}
			40 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.14
			}
		}
	}
}

JAP_ban_persecution_25_45_30 = {
	custom_effect_tooltip = JAP_ban_persecution_25_45_30_tt
	hidden_effect = {
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.1
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.1
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.1
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.2
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.2
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.2
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.3
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.3
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.3
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.4
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.4
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.4
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.5
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.5
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.5
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.6
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.6
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.6
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.7
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.7
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.7
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.8
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.8
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.8
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.9
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.9
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.9
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.10
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.10
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.10
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.11
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.11
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.11
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.12
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.12
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.12
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.13
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.13
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.13
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_ban_persecution_support_big.14
			}
			45 = {
				country_event = rcmjapan_christian_ban_persecution_support_small.14
			}
			30 = {
				country_event = rcmjapan_christian_ban_persecution_backlash.14
			}
		}
	}
}

#JAP CHRISTIAN CONST EFFECT
JAP_constitutionalize_religious_freedom_15_35_50 = {
	custom_effect_tooltip = JAP_constitutionalize_religious_freedom_15_35_50_tt
	hidden_effect = {
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.1
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.1
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.1
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.2
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.2
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.2
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.3
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.3
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.3
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.4
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.4
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.4
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.5
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.5
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.5
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.6
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.6
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.6
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.7
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.7
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.7
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.8
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.8
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.8
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.9
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.9
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.9
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.10
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.10
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.10
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.11
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.11
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.11
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.12
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.12
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.12
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.13
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.13
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.13
			}
		}
		random_list = {
			15 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.14
			}
			35 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.14
			}
			50 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.14
			}
		}
	}
}
JAP_constitutionalize_religious_freedom_20_40_40 = {
	custom_effect_tooltip = JAP_constitutionalize_religious_freedom_20_40_40_tt
	hidden_effect = {
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.1
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.1
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.1
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.2
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.2
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.2
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.3
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.3
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.3
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.4
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.4
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.4
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.5
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.5
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.5
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.6
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.6
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.6
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.7
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.7
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.7
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.8
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.8
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.8
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.9
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.9
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.9
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.10
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.10
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.10
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.11
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.11
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.11
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.12
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.12
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.12
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.13
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.13
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.13
			}
		}
		random_list = {
			20 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.14
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.14
			}
			40 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.14
			}
		}
	}
}

JAP_constitutionalize_religious_freedom_25_45_30 = {
	custom_effect_tooltip = JAP_constitutionalize_religious_freedom_25_45_30_tt
	hidden_effect = {
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.1
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.1
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.1
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.2
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.2
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.2
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.3
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.3
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.3
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.4
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.4
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.4
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.5
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.5
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.5
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.6
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.6
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.6
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.7
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.7
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.7
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.8
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.8
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.8
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.9
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.9
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.9
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.10
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.10
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.10
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.11
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.11
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.11
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.12
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.12
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.12
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.13
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.13
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.13
			}
		}
		random_list = {
			25 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_big.14
			}
			45 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_support_small.14
			}
			30 = {
				country_event = rcmjapan_christian_constitutionalize_religious_freedom_backlash.14
			}
		}
	}
}
# Disband units fraction effect by Yard1
# remove disband_fraction land units, keeping manpower and equipment
# expects disband_fraction variable to be set
disband_units_fraction = {
	AAA = { 
		set_temp_variable = {
			old_manpower = manpower_k
		}
	}
	random_state = {
		limit = {
			is_coastal = no
			owner = {
				PREV = {
					is_fully_controlled_by = PREV
				}
			}
		}
		owner = { save_event_target_as = disband_state_owner }
		save_event_target_as = disband_state
		AAA = { set_state_owner = PREV }
	}
	transfer_units_fraction = {
		target = AAA
		size = 0
		army_ratio = var:disband_fraction
		keep_unit_leaders_trigger = {
			always = yes
		}
	}
	AAA = {
		every_state = {
			AAA = {
				delete_unit = { 
					state = PREV
					disband = yes
				}
			}
		}
		set_temp_variable = {
			manpower_diff = manpower_k
		}
		subtract_from_temp_variable = {
			manpower_diff = old_manpower
		}
		while_loop_effect = { #avoid overflows
			limit = { check_variable = { manpower_diff > 1 } }
			subtract_from_temp_variable = { manpower_diff = 1 }
			ROOT = { add_manpower = 1000 }
			add_manpower = -1000
		}
		multiply_temp_variable = {
			manpower_diff = 1000
		}
		ROOT = { add_manpower = PREV.manpower_diff }
		multiply_temp_variable = {
			manpower_diff = -1
		}
		add_manpower = manpower_diff
		transfer_units_fraction = {
			target = ROOT
			size = 0
			stockpile_ratio = 1
			keep_unit_leaders_trigger = {
				always = yes
			}
		}
	}
	event_target:disband_state = {
		event_target:disband_state_owner = { set_state_owner = PREV }
	}
	annex_country = {
		target = AAA
	}
}
# PRC OOB 1936
RCM_create_prc_1936_oob = {
	#guo
	JAP = { set_cosmetic_tag = JAP_DIGUO }
}

RCM_create_prc_west_route_army_oob = {
	if = {
		limit = {
			NOT = {
				has_template = "Chntuan"
			}
		}
		division_template = {
			name = "Chntuan"				 								 
			division_names_group = PRC_INF_00
			#is_locked = yes
			#force_allow_recruiting = no
			regiments = {
				infantry = { x = 0 y = 0 }	 
				infantry = { x = 0 y = 1 }
				infantry = { x = 0 y = 2 }
				infantry = { x = 0 y = 3 }	 
				infantry = { x = 1 y = 0 }	 
				infantry = { x = 1 y = 1 }
				infantry = { x = 1 y = 2 }
				infantry = { x = 1 y = 3 }
				infantry = { x = 2 y = 0 }	 
				infantry = { x = 2 y = 1 }
				infantry = { x = 2 y = 2 }
				infantry = { x = 2 y = 3 }	 
			}
		}
	}
	if = {
		limit = {
			NOT = {
				has_template = "Chn"
			}
		}
		division_template = {
			name = "Chntuan"				 								 
			division_names_group = PRC_INF_00
			#is_locked = yes
			#force_allow_recruiting = no
			regiments = {
				infantry = { x = 0 y = 0 }	 
				infantry = { x = 0 y = 1 }
				infantry = { x = 0 y = 2 }
				infantry = { x = 0 y = 3 }	 
				infantry = { x = 1 y = 0 }	 
				infantry = { x = 1 y = 1 }
				infantry = { x = 1 y = 2 }
				infantry = { x = 1 y = 3 }
				infantry = { x = 2 y = 0 }	 
				infantry = { x = 2 y = 1 }
				infantry = { x = 2 y = 2 }
				infantry = { x = 2 y = 3 }	 
			}
		}
	}
	
    random_owned_controlled_state = {
		limit = {
			state = 1031
		}
		create_unit = {
			division = "name = \"Ti 4 Fangmienchn Ti 5 Chn\" division_template = \"Chn\" start_experience_factor = 0.4 start_equipment_factor = 0.4"
			owner = PRC
			id = 101
			prioritize_location = 1985
		}	
		create_unit = {
			division = "name = \"Ti 4 Fangmienchn Ti 9 Chn\" division_template = \"Chn\" start_experience_factor = 0.4 start_equipment_factor = 0.6"
			owner = PRC
			id = 102
			prioritize_location = 1985
		}	
		create_unit = {
			division = "name = \"Ti 4 Fangmienchn Ti 30 Chn\" division_template = \"Chn\" start_experience_factor = 0.4 start_equipment_factor = 0.6"
			owner = PRC
			id = 103
			prioritize_location = 1985
		}
	}

	random_owned_controlled_state = {
		limit = {
			state = 1029
		}
		create_unit = {
			division = "name = \"Ti 4 Fangmienchn Ti 4 Chn\" division_template = \"Chn\" start_experience_factor = 0.4 start_equipment_factor = 0.9"
			owner = PRC
			id = 104
			prioritize_location = 4939
		}	
		create_unit = {
			division = "name = \"Ti 4 Fangmienchn Ti 31 Chntuan\" division_template = \"Chntuan\" start_experience_factor = 0.4 start_equipment_factor = 0.6"
			owner = PRC
			id = 105
			prioritize_location = 10880
		}	
		create_unit = {
			division = "name = \"Ti 2 Fangmienchn Ti 2 Chntuan\" division_template = \"Chntuan\" start_experience_factor = 0.4 start_equipment_factor = 0.5"
			owner = PRC
			id = 106
			prioritize_location = 12356
		}	
		create_unit = {
			division = "name = \"Ti 2 Fangmienchn Ti 6 Chntuan\" division_template = \"Chntuan\" start_experience_factor = 0.4 start_equipment_factor = 0.4"
			owner = PRC
			id = 107
			prioritize_location = 12356
		}	
		create_unit = {
			division = "name = \"Ti 2 Fangmienchn Ti 32 Chn\" division_template = \"Chn\" start_experience_factor = 0.4 start_equipment_factor = 0.33"
			owner = PRC
			id = 108
			prioritize_location = 12356
		}		
	}
}

RCM_create_hunan_1936_oob = {
	if = {
		limit = {
			NOT = {
				has_template = "Luchn Shih"
			}
		}
		division_template = {
			name = "Luchn Shih"			
			division_names_group = CHI_INF_01
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 }
				infantry = { x = 0 y = 2 }
				infantry = { x = 0 y = 3 }
				infantry = { x = 1 y = 0 }
				infantry = { x = 1 y = 1 }
				infantry = { x = 1 y = 2 }
				infantry = { x = 1 y = 3 }
				infantry = { x = 2 y = 0 }
				infantry = { x = 2 y = 1 }
				infantry = { x = 2 y = 2 }
				infantry = { x = 3 y = 0 }
				infantry = { x = 3 y = 1 }
				infantry = { x = 3 y = 2 }
			}
			support = {
			}
		}
	}
	if = {
		limit = {
			NOT = {
				has_template = "Tuli L"
			}
		}
		division_template = {
			name = "Tuli L"			
			division_names_group = CHI_INF_02
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 }
				infantry = { x = 1 y = 0 }
				infantry = { x = 1 y = 1 }
			}
			support = {
			}
		}
	}
	750 = {
		create_unit = {
			division = "name = \"Luchn Ti 15 Shih\" division_template = \"Luchn Shih\" start_experience_factor = 0.2 start_equipment_factor = 0.85"
			owner = CHI
			id = 1
			prioritize_location = 10006
		}	
		create_unit = {
			division = "name = \"Luchn Hsinpien Ti 34 Shih\" division_template = \"Luchn Shih\" start_experience_factor = 0.2 start_equipment_factor = 0.75"
			owner = CHI
			id = 6
			prioritize_location = 10335
		}	
	}
	748 = {
		create_unit = {
			division = "name = \"Luchn Ti 16 Shih\" division_template = \"Luchn Shih\" start_experience_factor = 0.2 start_equipment_factor = 0.85"
			owner = CHI
			id = 2
			prioritize_location = 8095
		}	
		create_unit = {
			division = "name = \"Luchn Ti 62 Shih\" division_template = \"Luchn Shih\" start_experience_factor = 0.2 start_equipment_factor = 0.85"
			owner = CHI
			id = 4
			prioritize_location = 1474
		}	
		create_unit = {
			division = "name = \"Luchn Ti 63 Shih\" division_template = \"Luchn Shih\" start_experience_factor = 0.2 start_equipment_factor = 0.75"
			owner = CHI
			id = 5
			prioritize_location = 1474
		}	
	}
	1035 = {
        create_unit = {
			division = "name = \"Luchn Ti 19 Shih\" division_template = \"Luchn Shih\" start_experience_factor = 0.2 start_equipment_factor = 0.85"
			owner = CHI
			id = 3
			prioritize_location = 7101
		}	
		create_unit = {
			division = "name = \"Luchn Tuli Ti 32 L\" division_template = \"Tuli L\" start_experience_factor = 0.2 start_equipment_factor = 0.9"
			owner = CHI
			id = 7
			prioritize_location = 7097
		}
	}												
}