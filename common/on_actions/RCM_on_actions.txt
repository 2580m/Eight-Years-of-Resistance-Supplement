on_actions = {
	on_daily = {
		effect = {
			#address the integration bug
			event_target:WTT_current_china_leader = {
				set_variable = { count_available_ongoing_warlords = 0 }
				for_each_scope_loop = {
					array = This.subjects
					if = {
						limit = {
							has_country_flag = ongoing_integration_flag
							is_warlord = yes
						}
						add_to_variable = { Prev.count_available_ongoing_warlords = 1 }
					}
				}
				if = {
					limit = {
						check_variable = {
							global.warlord_integration_count > count_available_ongoing_warlords
						}
					}
					CHI_warlord_integration_down = yes
				}
			}
			
			
			#PRC factional boosts
			#trotskyist
			if = {
				limit = {
					has_idea = prc_wang_shiwei #0.5 every 2 months
				}				
				add_to_variable = { prc_wang_shiwei_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_wang_shiwei_counter < 60 } }
					}
					set_temp_variable = { temp_member = 4 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TROT_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_wang_shiwei_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = prc_peng_shuzhi #0.5 every 1 month
				}
				add_to_variable = { prc_peng_shuzhi_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_peng_shuzhi_counter < 30 } }
					}
					set_temp_variable = { temp_member = 4 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TROT_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_peng_shuzhi_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = prc_zheng_chaolin #0.5 every 1 month
				}
				add_to_variable = { prc_zheng_chaolin_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_zheng_chaolin_counter < 30 } }
					}
					set_temp_variable = { temp_member = 4 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TROT_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_zheng_chaolin_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = prc_wang_fanxi #0.5 every 1 month
				}
				add_to_variable = { prc_wang_fanxi_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_wang_fanxi_counter < 30 } }
					}
					set_temp_variable = { temp_member = 4 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TROT_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_wang_fanxi_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = PRC_cooperate_with_4th_international #0.5 every 1 month
				}
				add_to_variable = { PRC_cooperate_with_4th_international_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { PRC_cooperate_with_4th_international_counter < 30 } }
					}
					set_temp_variable = { temp_member = 4 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TROT_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { PRC_cooperate_with_4th_international_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = CCP_constitution_trot #0.5 every 1 month
				}
				add_to_variable = { CCP_constitution_trot_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { CCP_constitution_trot_counter < 30 } }
					}
					set_temp_variable = { temp_member = 4 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TROT_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { CCP_constitution_trot_counter = 0 }		
				}			
			}
			if = {
				limit = {
					OR = {
						has_idea = CCP_question_history_zhang #0.5 every 1 month
						has_idea = CCP_question_history_mao #0.5 every 1 month
						has_idea = CCP_question_history_teb #0.5 every 1 month
						#has_idea = CCP_question_history_trot #0.5 every 1 month
					}
				}
				add_to_variable = { CCP_question_history_trot_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { CCP_question_history_trot_counter < 30 } }
					}
					set_temp_variable = { temp_member = 4 }
					set_temp_variable = { temp_seats = -0.005 tooltip = TROT_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { CCP_question_history_trot_counter = 0 }		
				}			
			}



			#28b
			if = {
				limit = {
					has_idea = prc_bo_gu #0.5 every 1 month
				}
				add_to_variable = { prc_bo_gu_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_bo_gu_counter < 30 } }
					}
					set_temp_variable = { temp_member = 3 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TEB_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_bo_gu_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = prc_wang_ming #0.5 every 1 month
				}
				add_to_variable = { prc_wang_ming_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_wang_ming_counter < 30 } }
					}
					set_temp_variable = { temp_member = 3 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TEB_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_wang_ming_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = prc_meng_qingshu #0.5 every 1 month
				}
				add_to_variable = { prc_meng_qingshu_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_meng_qingshu_counter < 30 } }
					}
					set_temp_variable = { temp_member = 3 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TEB_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_meng_qingshu_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = prc_chen_changhao #0.5 every 1 month
				}
				add_to_variable = { prc_chen_changhao_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_chen_changhao_counter < 30 } }
					}
					set_temp_variable = { temp_member = 3 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TEB_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_chen_changhao_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = prc_wang_shengrong #0.5 every 1 month
				}
				add_to_variable = { prc_wang_shengrong_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_wang_shengrong_counter < 30 } }
					}
					set_temp_variable = { temp_member = 3 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TEB_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_wang_shengrong_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = changjiang_bureau #0.5 every 1 month
				}
				add_to_variable = { changjiang_bureau_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { changjiang_bureau_counter < 30 } }
					}
					set_temp_variable = { temp_member = 3 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TEB_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { changjiang_bureau_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = changjiang_bureau_2 #0.5 every 1 month
				}
				add_to_variable = { changjiang_bureau_2_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { changjiang_bureau_2_counter < 15 } }
					}
					set_temp_variable = { temp_member = 3 }
					set_temp_variable = { temp_seats = 0.01 tooltip = TEB_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { changjiang_bureau_2_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = CCP_constitution_28b #0.5 every 1 month
				}
				add_to_variable = { CCP_constitution_28b_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { CCP_constitution_28b_counter < 30 } }
					}
					set_temp_variable = { temp_member = 3 }
					set_temp_variable = { temp_seats = 0.005 tooltip = TROT_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { CCP_constitution_28b_counter = 0 }		
				}			
			}
			if = {
				limit = {
					OR = {
						has_idea = CCP_question_history_zhang #0.5 every 1 month
						has_idea = CCP_question_history_mao #0.5 every 1 month
						#has_idea = CCP_question_history_teb #0.5 every 1 month
						has_idea = CCP_question_history_trot #0.5 every 1 month
					}
				}
				add_to_variable = { CCP_question_history_teb_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { CCP_question_history_teb_counter < 30 } }
					}
					set_temp_variable = { temp_member = 3 }
					set_temp_variable = { temp_seats = -0.005 tooltip = teb_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { CCP_question_history_teb_counter = 0 }		
				}			
			}
			#mao
			if = {
				limit = {
					has_idea = prc_mao_zedong #0.5 every 1 month
				}
				add_to_variable = { prc_mao_zedong_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_mao_zedong_counter < 30 } }
					}
					set_temp_variable = { temp_member = 2 }
					set_temp_variable = { temp_seats = 0.005 tooltip = MAOIST_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_mao_zedong_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = prc_zhang_wentian #0.5 every 1 month
				}
				add_to_variable = { prc_zhang_wentian_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_zhang_wentian_counter < 30 } }
					}
					set_temp_variable = { temp_member = 2 }
					set_temp_variable = { temp_seats = 0.005 tooltip = MAOIST_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_zhang_wentian_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = PRC_chen_yun #0.5 every 1 month
				}
				add_to_variable = { PRC_chen_yun_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { PRC_chen_yun_counter < 30 } }
					}
					set_temp_variable = { temp_member = 2 }
					set_temp_variable = { temp_seats = 0.005 tooltip = MAOIST_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { PRC_chen_yun_counter = 0 }		
				}			
			}
			
			if = {
				limit = {
					has_idea = PRC_kang_sheng #0.5 every 1 month
				}
				add_to_variable = { PRC_kang_sheng_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { PRC_kang_sheng_counter < 30 } }
					}
					set_temp_variable = { temp_member = 2 }
					set_temp_variable = { temp_seats = 0.005 tooltip = MAOIST_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { PRC_kang_sheng_counter = 0 }		
				}			
			}
			
			if = {
				limit = {
					has_idea = prc_wang_jiaxiang #0.5 every 1 month
				}
				add_to_variable = { prc_wang_jiaxiang_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { prc_wang_jiaxiang_counter < 30 } }
					}
					set_temp_variable = { temp_member = 2 }
					set_temp_variable = { temp_seats = 0.005 tooltip = MAOIST_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { prc_wang_jiaxiang_counter = 0 }		
				}			
			}
			
			if = {
				limit = {
					has_idea = yanan_rect_2 #0.5 every 1 month
				}
				add_to_variable = { yanan_rect_2_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { yanan_rect_2_counter < 30 } }
					}
					set_temp_variable = { temp_member = 2 }
					set_temp_variable = { temp_seats = 0.005 tooltip = MAOIST_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { yanan_rect_2_counter = 0 }		
				}			
			}
			
			if = {
				limit = {
					has_idea = yanan_rect_3 #0.5 every 1 month
				}
				add_to_variable = { yanan_rect_3_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { yanan_rect_3_counter < 30 } }
					}
					set_temp_variable = { temp_member = 2 }
					set_temp_variable = { temp_seats = 0.01 tooltip = MAOIST_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { yanan_rect_3_counter = 0 }		
				}			
			}
			
			if = {
				limit = {
					has_idea = CCP_constitution_mao #0.5 every 1 month
				}
				add_to_variable = { CCP_constitution_mao_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { CCP_constitution_mao_counter < 30 } }
					}
					set_temp_variable = { temp_member = 2 }
					set_temp_variable = { temp_seats = 0.005 tooltip = MAOIST_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { CCP_constitution_mao_counter = 0 }		
				}			
			}
			
			if = {
				limit = {
					OR = {
						has_idea = CCP_question_history_zhang #0.5 every 1 month
						#has_idea = CCP_question_history_mao #0.5 every 1 month
						has_idea = CCP_question_history_teb #0.5 every 1 month
						has_idea = CCP_question_history_trot #0.5 every 1 month
					}
				}
				add_to_variable = { CCP_question_history_mao_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { CCP_question_history_mao_counter < 30 } }
					}
					set_temp_variable = { temp_member = 2 }
					set_temp_variable = { temp_seats = -0.005 tooltip = MAOIST_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { CCP_question_history_mao_counter = 0 }		
				}			
			}
			
			#zhang
			if = {
				limit = {
					has_idea = PRC_zhang_guotao #0.5 every 1 month
				}
				add_to_variable = { PRC_zhang_guotao_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { PRC_zhang_guotao_counter < 30 } }
					}
					set_temp_variable = { temp_member = 1 }
					set_temp_variable = { temp_seats = 0.01 tooltip = TEB_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { PRC_zhang_guotao_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = CCP_constitution_zhang #0.5 every 1 month
				}
				add_to_variable = { CCP_constitution_zhang_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { CCP_constitution_zhang_counter < 30 } }
					}
					set_temp_variable = { temp_member = 1 }
					set_temp_variable = { temp_seats = 0.01 tooltip = TEB_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { CCP_constitution_zhang_counter = 0 }		
				}			
			}
			if = {
				limit = {
					has_idea = CCP_question_history_zhang #0.5 every 1 month
					#has_idea = CCP_question_history_mao #0.5 every 1 month
					has_idea = CCP_question_history_teb #0.5 every 1 month
					has_idea = CCP_question_history_trot #0.5 every 1 month
				}
				add_to_variable = { CCP_question_history_mao_counter = 1 }
				if = {
					limit = {
						NOT = { check_variable = { CCP_question_history_mao_counter < 30 } }
					}
					set_temp_variable = { temp_member = 1 }
					set_temp_variable = { temp_seats = -0.005 tooltip = TEB_faction_support_tt }
											#percentage
					modify_parliament_seat = yes
					set_variable = { CCP_question_history_mao_counter = 0 }		
				}			
			}
			#DIFFICULTY
			if = {
				limit = {
					is_ai = no
					OR = {
						has_country_flag = challenge_1_flag #4 weeks
						has_country_flag = challenge_2_flag #2 weeks
						has_country_flag = challenge_3_flag #1 weeks
					}
				}
				add_to_variable = {
					this.difficulty_day_count = 1
				}			
				if = {
					limit = {
						OR = {
							AND = {
								NOT = {
									check_variable = { this.difficulty_day_count < 28 }
								}
								has_country_flag = challenge_1_flag #4 weeks
							}
							AND = {
								NOT = {
									check_variable = { this.difficulty_day_count < 14 }
								}
								has_country_flag = challenge_2_flag #2 weeks
							}
							AND = {
								NOT = {
									check_variable = { this.difficulty_day_count < 7 }
								}
								has_country_flag = challenge_3_flag #1 weeks
							}
						}
					}
					
					every_enemy_country = {
						limit = {
							set_temp_variable = { temp_cons_infra_ratio = this.RCM_army_supply_consumption }
							divide_temp_variable = { temp_cons_infra_ratio = this.total_infra }
							#prevent over-spawning
							check_variable = { temp_cons_infra_ratio < 4.5 } #4.5 is absolute maximum
							
							is_subject = no
							OR = { #focus on leader instead
								is_in_faction = no
								is_faction_leader = yes
								tag = event_target:WTT_current_china_leader
							}
							NOT = {							
								AND = {
									ROOT = {
										is_literally_china = yes #warlord against japan too stronk
										NOT = {
											tag = event_target:WTT_current_china_leader
										}
									}
									tag = JAP
								}
							}
							NOT = {
								AND = {
									ROOT = {
										is_literally_china = yes #warlord against japan too stronk
										NOT = {
											tag = event_target:WTT_current_china_leader
										}
									}
									tag = JAP
								}
							}
							NOT = {
								AND = {
									date < 1937.1.1 #before xi an incident
									ROOT = {
										tag = event_target:WTT_current_china_leader
									}
									tag = event_target:WTT_communist_china
								}
							}
							NOT = {
								AND = {
									ROOT = {
										tag = MAN #china in this case too op
									}
									tag = event_target:WTT_current_china_leader
								}
							}
							NOT = {
								AND = {
									ic_ratio = { #too strong countries don't apply
										tag = ROOT 
										ratio > 2.5 #a bit more nightmarish
									}
									strength_ratio = { 
										tag = ROOT 
										ratio > 2.5 #a bit more nightmarish
									}
								}
							}
						}
						if = {
							limit = {
								NOT = {
									is_in_array = {
										global.AI_difficulty_enemy_spawn = THIS
									}
								}
							}
							add_to_array = { global.AI_difficulty_enemy_spawn = THIS }
						}
						if = {
							limit = {
								NOT = { has_tech = gw_artillery }
							}
							set_technology = {
								gw_artillery = 1
							}
						}
						if = {
							limit = {
								NOT = {
									has_tech = tech_support
								}
							}
							set_technology = {
								tech_support = 1
							}
						}
						if = {
							limit = {
								NOT = {
									has_country_flag = difficulty_template_set_all
								}
								has_tech = tech_recon
								has_tech = tech_engineers
							}
							division_template = {
								name = "Reserve Infantry Division"
								regiments = {
									infantry = { x = 0 y = 0 }
									infantry = { x = 0 y = 1 }
									infantry = { x = 0 y = 2 }
							        infantry = { x = 1 y = 0 }
									infantry = { x = 1 y = 1 }
									infantry = { x = 1 y = 2 }
									infantry = { x = 2 y = 0 }
									#infantry = { x = 2 y = 1 }
									#infantry = { x = 2 y = 2 }
									#infantry = { x = 3 y = 0 }
									#infantry = { x = 3 y = 1 }
									#infantry = { x = 3 y = 2 }
									#artillery_brigade = { x = 4 y = 0 }
									#infantry = { x = 4 y = 1 }
									#infantry = { x = 4 y = 2 }
									artillery_brigade = { x = 3 y = 0 }
									artillery_brigade = { x = 3 y = 1 }
									#artillery_brigade = { x = 5 y = 2 }
								}
								support = {
									artillery = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
									recon = { x = 0 y = 2 }									
								}
							}
							set_country_flag = difficulty_template_set_all
						}
						else_if = {
							limit = {
								NOT = {
									has_country_flag = difficulty_template_set_recon
								}
								has_tech = tech_recon
								NOT = { has_tech = tech_engineers }
							}
							division_template = {
								name = "Reserve Infantry Division"
								regiments = {
									infantry = { x = 0 y = 0 }
									infantry = { x = 0 y = 1 }
									infantry = { x = 0 y = 2 }
							        infantry = { x = 1 y = 0 }
									infantry = { x = 1 y = 1 }
									infantry = { x = 1 y = 2 }
									infantry = { x = 2 y = 0 }
									#infantry = { x = 2 y = 1 }
									#infantry = { x = 2 y = 2 }
									#infantry = { x = 3 y = 0 }
									#infantry = { x = 3 y = 1 }
									#infantry = { x = 3 y = 2 }
									#artillery_brigade = { x = 4 y = 0 }
									#infantry = { x = 4 y = 1 }
									#infantry = { x = 4 y = 2 }
									artillery_brigade = { x = 3 y = 0 }
									artillery_brigade = { x = 3 y = 1 }
									#artillery_brigade = { x = 5 y = 2 }
								}
								support = {
									artillery = { x = 0 y = 0 }
									#engineer = { x = 0 y = 1 }
									recon = { x = 0 y = 2 }									
								}
							}
							set_country_flag = difficulty_template_set_recon
						}
						else_if = {
							limit = {
								NOT = {
									has_country_flag = difficulty_template_set_engineer
								}
								has_tech = tech_engineers
								NOT = { has_tech = tech_recon }
							}
							division_template = {
								name = "Reserve Infantry Division"
								regiments = {
									infantry = { x = 0 y = 0 }
									infantry = { x = 0 y = 1 }
									infantry = { x = 0 y = 2 }
							        infantry = { x = 1 y = 0 }
									infantry = { x = 1 y = 1 }
									infantry = { x = 1 y = 2 }
									infantry = { x = 2 y = 0 }
									#infantry = { x = 2 y = 1 }
									#infantry = { x = 2 y = 2 }
									#infantry = { x = 3 y = 0 }
									#infantry = { x = 3 y = 1 }
									#infantry = { x = 3 y = 2 }
									#artillery_brigade = { x = 4 y = 0 }
									#infantry = { x = 4 y = 1 }
									#infantry = { x = 4 y = 2 }
									artillery_brigade = { x = 3 y = 0 }
									artillery_brigade = { x = 3 y = 1 }
									#artillery_brigade = { x = 5 y = 2 }
								}
								support = {
									artillery = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
									#recon = { x = 0 y = 2 }									
								}
							}
							set_country_flag = difficulty_template_set_engineer
						}
						else_if = {
							limit = {
								NOT = {
									has_country_flag = difficulty_template_set_none
								}
								NOT = { has_tech = tech_engineers }
								NOT = { has_tech = tech_recon }
							}
							division_template = {
								name = "Reserve Infantry Division"
								regiments = {
									infantry = { x = 0 y = 0 }
									infantry = { x = 0 y = 1 }
									infantry = { x = 0 y = 2 }
							        infantry = { x = 1 y = 0 }
									infantry = { x = 1 y = 1 }
									infantry = { x = 1 y = 2 }
									infantry = { x = 2 y = 0 }
									#infantry = { x = 2 y = 1 }
									#infantry = { x = 2 y = 2 }
									#infantry = { x = 3 y = 0 }
									#infantry = { x = 3 y = 1 }
									#infantry = { x = 3 y = 2 }
									#artillery_brigade = { x = 4 y = 0 }
									#infantry = { x = 4 y = 1 }
									#infantry = { x = 4 y = 2 }
									artillery_brigade = { x = 3 y = 0 }
									artillery_brigade = { x = 3 y = 1 }
									#artillery_brigade = { x = 5 y = 2 }
								}
								support = {
									artillery = { x = 0 y = 0 }
									#engineer = { x = 0 y = 1 }
									##recon = { x = 0 y = 2 }									
								}
							}
							set_country_flag = difficulty_template_set_none
						}

						if = {
							limit = {
								has_tech = improved_light_tank						
							}
							if = {
								limit = {
									NOT = {
										has_tech = motorised_infantry
									}
								}
								set_technology = {
									motorised_infantry = 1
								}
							}
							if = {
								limit = {
									NOT = {
										has_tech = improved_light_td
									}
								}
								set_technology = {
									improved_light_td = 1
								}
							}
							set_country_flag = upgraded_to_light_tank
							if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_all_tank_light
									}
									has_tech = tech_recon
									has_tech = tech_engineers
								}
								division_template = {
								name = "Reserve Light Tank Division"
								regiments = {
									light_armor = { x = 0 y = 0 }
									light_armor = { x = 0 y = 1 }
									light_armor = { x = 0 y = 2 }
							        light_tank_destroyer_brigade = { x = 1 y = 0 }
									light_tank_destroyer_brigade = { x = 1 y = 1 }
									motorized = { x = 1 y = 2 }
									motorized = { x = 2 y = 0 }
									motorized = { x = 2 y = 1 }
									motorized = { x = 2 y = 2 }
									motorized = { x = 2 y = 3 }
								}
								support = {
									artillery = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
									recon = { x = 0 y = 2 }									
								}
								}
								set_country_flag = difficulty_template_set_all_tank_light
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_recon_tank_light
									}
									has_tech = tech_recon
									NOT = { has_tech = tech_engineers }
								}
								division_template = {
									name = "Reserve Light Tank Division"
									regiments = {
										light_armor = { x = 0 y = 0 }
										light_armor = { x = 0 y = 1 }
										light_armor = { x = 0 y = 2 }
							    	    light_tank_destroyer_brigade = { x = 1 y = 0 }
										light_tank_destroyer_brigade = { x = 1 y = 1 }
										motorized = { x = 1 y = 2 }
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_recon_tank_light
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_engineer_tank_light
									}
									has_tech = tech_engineers
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Light Tank Division"
									regiments = {
										light_armor = { x = 0 y = 0 }
										light_armor = { x = 0 y = 1 }
										light_armor = { x = 0 y = 2 }
							    	    light_tank_destroyer_brigade = { x = 1 y = 0 }
										light_tank_destroyer_brigade = { x = 1 y = 1 }
										motorized = { x = 1 y = 2 }
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										engineer = { x = 0 y = 1 }
										#recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_engineer_tank_light
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_none_tank_light
									}
									NOT = { has_tech = tech_engineers }
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Light Tank Division"
									regiments = {
										light_armor = { x = 0 y = 0 }
										light_armor = { x = 0 y = 1 }
										light_armor = { x = 0 y = 2 }
							        	light_tank_destroyer_brigade = { x = 1 y = 0 }
										light_tank_destroyer_brigade = { x = 1 y = 1 }
										motorized = { x = 1 y = 2 }
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										##recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_none_tank_light
							}
						}
						if = {
							limit = {
								has_tech = improved_medium_tank						
							}
							if = {
								limit = {
									NOT = {
										has_tech = motorised_infantry
									}
								}
								set_technology = {
									motorised_infantry = 1
								}
							}
							if = {
								limit = {
									NOT = {
										has_tech = improved_medium_td
									}
								}
								set_technology = {
									improved_medium_td = 1
								}
							}
							set_country_flag = upgraded_to_medium_tank
							if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_all_tank_medium
									}
									has_tech = tech_recon
									has_tech = tech_engineers
								}
								division_template = {
								name = "Reserve Medium Tank Division"
								regiments = {
									medium_armor = { x = 0 y = 0 }
									medium_armor = { x = 0 y = 1 }
									medium_armor = { x = 0 y = 2 }
							        medium_tank_destroyer_brigade = { x = 1 y = 0 }
									medium_tank_destroyer_brigade = { x = 1 y = 1 }
									motorized = { x = 1 y = 2 }
									motorized = { x = 2 y = 0 }
									motorized = { x = 2 y = 1 }
									motorized = { x = 2 y = 2 }
									motorized = { x = 2 y = 3 }
								}
								support = {
									artillery = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
									recon = { x = 0 y = 2 }									
								}
								}
								set_country_flag = difficulty_template_set_all_tank_medium
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_recon_tank_medium
									}
									has_tech = tech_recon
									NOT = { has_tech = tech_engineers }
								}
								division_template = {
									name = "Reserve Medium Tank Division"
									regiments = {
										medium_armor = { x = 0 y = 0 }
										medium_armor = { x = 0 y = 1 }
										medium_armor = { x = 0 y = 2 }
							    	    medium_tank_destroyer_brigade = { x = 1 y = 0 }
										medium_tank_destroyer_brigade = { x = 1 y = 1 }
										motorized = { x = 1 y = 2 }
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_recon_tank_medium
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_engineer_tank_medium
									}
									has_tech = tech_engineers
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Medium Tank Division"
									regiments = {
										medium_armor = { x = 0 y = 0 }
										medium_armor = { x = 0 y = 1 }
										medium_armor = { x = 0 y = 2 }
							    	    medium_tank_destroyer_brigade = { x = 1 y = 0 }
										medium_tank_destroyer_brigade = { x = 1 y = 1 }
										motorized = { x = 1 y = 2 }
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										engineer = { x = 0 y = 1 }
										#recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_engineer_tank_medium
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_none_tank_medium
									}
									NOT = { has_tech = tech_engineers }
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Medium Tank Division"
									regiments = {
										medium_armor = { x = 0 y = 0 }
										medium_armor = { x = 0 y = 1 }
										medium_armor = { x = 0 y = 2 }
							        	medium_tank_destroyer_brigade = { x = 1 y = 0 }
										medium_tank_destroyer_brigade = { x = 1 y = 1 }
										motorized = { x = 1 y = 2 }
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										##recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_none_tank_medium
							}
						}
						if = {
							limit = {
								has_tech = main_battle_tank						
							}
							if = {
								limit = {
									NOT = {
										has_tech = mechanised_infantry
									}
								}
								set_technology = {
									mechanised_infantry = 1
								}
							}
							if = {
								limit = {
									NOT = {
										has_tech = modern_td
									}
								}
								set_technology = {
									modern_td = 1
								}
							}
							set_country_flag = upgraded_to_modern_tank
							if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_all_tank_modern
									}
									has_tech = tech_recon
									has_tech = tech_engineers
								}
								division_template = {
								name = "Reserve Modern Tank Division"
								regiments = {
									modern_armor = { x = 0 y = 0 }
									modern_armor = { x = 0 y = 1 }
									modern_armor = { x = 0 y = 2 }
							        modern_tank_destroyer_brigade = { x = 1 y = 0 }
									modern_tank_destroyer_brigade = { x = 1 y = 1 }
									mechanized = { x = 1 y = 2 }
									mechanized = { x = 2 y = 0 }
									mechanized = { x = 2 y = 1 }
									mechanized = { x = 2 y = 2 }
									mechanized = { x = 2 y = 3 }
								}
								support = {
									artillery = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
									recon = { x = 0 y = 2 }									
								}
								}
								set_country_flag = difficulty_template_set_all_tank_modern
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_recon_tank_modern
									}
									has_tech = tech_recon
									NOT = { has_tech = tech_engineers }
								}
								division_template = {
									name = "Reserve Modern Tank Division"
									regiments = {
										modern_armor = { x = 0 y = 0 }
										modern_armor = { x = 0 y = 1 }
										modern_armor = { x = 0 y = 2 }
							    	    modern_tank_destroyer_brigade = { x = 1 y = 0 }
										modern_tank_destroyer_brigade = { x = 1 y = 1 }
										mechanized = { x = 1 y = 2 }
										mechanized = { x = 2 y = 0 }
										mechanized = { x = 2 y = 1 }
										mechanized = { x = 2 y = 2 }
										mechanized = { x = 2 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_recon_tank_modern
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_engineer_tank_modern
									}
									has_tech = tech_engineers
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Modern Tank Division"
									regiments = {
										modern_armor = { x = 0 y = 0 }
										modern_armor = { x = 0 y = 1 }
										modern_armor = { x = 0 y = 2 }
							    	    modern_tank_destroyer_brigade = { x = 1 y = 0 }
										modern_tank_destroyer_brigade = { x = 1 y = 1 }
										mechanized = { x = 1 y = 2 }
										mechanized = { x = 2 y = 0 }
										mechanized = { x = 2 y = 1 }
										mechanized = { x = 2 y = 2 }
										mechanized = { x = 2 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										engineer = { x = 0 y = 1 }
										#recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_engineer_tank_modern
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_none_tank_modern
									}
									NOT = { has_tech = tech_engineers }
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Modern Tank Division"
									regiments = {
										modern_armor = { x = 0 y = 0 }
										modern_armor = { x = 0 y = 1 }
										modern_armor = { x = 0 y = 2 }
							    	    modern_tank_destroyer_brigade = { x = 1 y = 0 }
										modern_tank_destroyer_brigade = { x = 1 y = 1 }
										mechanized = { x = 1 y = 2 }
										mechanized = { x = 2 y = 0 }
										mechanized = { x = 2 y = 1 }
										mechanized = { x = 2 y = 2 }
										mechanized = { x = 2 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										##recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_none_tank_modern
							}
						}

						if = {
							limit = {
								check_variable = { This.supply_condition_army_debuff > 30 } #upkeep over 30 percent
								check_variable = { This.supply_condition < 30 } #overall supply smaller than 30 percent
							}							
							if = {
								limit = {
									NOT = { has_country_flag = challenge_extra_supply }
								}
								set_variable = { challenge_extra_supply_coefficient = 1 }
								set_country_flag = challenge_extra_supply
								else = {
									add_to_variable = { challenge_extra_supply_coefficient = 1 }
								} #this will translate to 5% of upper limit increase
							}
							add_to_variable = { This.supply_condition_base = 5 }
						}
						else = {
							random_owned_controlled_state = {
								limit = {
									PREV = {
										NOT = {
											has_country_flag = upgraded_to_light_tank
											has_country_flag = upgraded_to_medium_tank
											has_country_flag = upgraded_to_modern_tank
										}
									}
								}
								create_unit = {
									division = "name = \"Reserve Infantry Division\" division_template = \"Reserve Infantry Division\" start_experience_factor = 0.4"
									owner = PREV
								}
							}
							random_owned_controlled_state = {
								limit = {
									PREV = {
										has_country_flag = upgraded_to_light_tank
									}
								}
								create_unit = {
									division = "name = \"Reserve Light Tank Division\" division_template = \"Reserve Light Tank Division\" start_experience_factor = 0.4"
									owner = PREV
								}
							}
							random_owned_controlled_state = {
								limit = {
									PREV = {
										has_country_flag = upgraded_to_medium_tank
									}
								}
								create_unit = {
									division = "name = \"Reserve Medium Tank Division\" division_template = \"Reserve Medium Tank Division\" start_experience_factor = 0.4"
									owner = PREV
								}
							}
							random_owned_controlled_state = {
								limit = {
									PREV = {
										has_country_flag = upgraded_to_modern_tank
									}
								}
								create_unit = {
									division = "name = \"Reserve Modern Tank Division\" division_template = \"Reserve Modern Tank Division\" start_experience_factor = 0.4"
									owner = PREV
								}
							}
						}
					}
					set_variable = { this.difficulty_day_count = 0 }
				}
			}
			if = {
				limit = {
					is_ai = no
					OR = {
						has_country_flag = nightmare_1_flag #8 weeks
						has_country_flag = nightmare_2_flag #4 weeks
						has_country_flag = nightmare_3_flag #2 weeks
						has_country_flag = nightmare_4_flag #1 weeks
					}
				}
				add_to_variable = {
					this.difficulty_day_count = 1
				}			
				if = {
					limit = {
						OR = {
							AND = {
								NOT = {
									check_variable = { this.difficulty_day_count < 56 }
								}
								has_country_flag = nightmare_1_flag #8 weeks
							}
							AND = {
								NOT = {
									check_variable = { this.difficulty_day_count < 28 }
								}
								has_country_flag = nightmare_2_flag #4 weeks
							}
							AND = {
								NOT = {
									check_variable = { this.difficulty_day_count < 14 }
								}
								has_country_flag = nightmare_3_flag #2 weeks
							}
							AND = {
								NOT = {
									check_variable = { this.difficulty_day_count < 7 }
								}
								has_country_flag = nightmare_4_flag #1 weeks
							}
						}
					}
					
					every_enemy_country = {
						limit = {							
							set_temp_variable = { temp_cons_infra_ratio = This.RCM_army_supply_consumption }
							divide_temp_variable = { temp_cons_infra_ratio = This.total_infra }
							#prevent over-spawning
							check_variable = { temp_cons_infra_ratio < 4.5 } #4.5 is absolute maximum
							is_subject = no
							OR = { #focus on leader instead
								is_in_faction = no
								is_faction_leader = yes
								tag = event_target:WTT_current_china_leader
							}
							NOT = {							
								AND = {
									ROOT = {
										is_literally_china = yes #warlord against japan too stronk
										NOT = {
											tag = event_target:WTT_current_china_leader
										}
									}
									tag = JAP
								}
							}
							NOT = {
								AND = {
									ROOT = {
										is_literally_china = yes #warlord against japan too stronk
										NOT = {
											tag = event_target:WTT_current_china_leader
										}
									}
									tag = JAP
								}
							}
							NOT = {
								AND = {
									date < 1937.1.1 #before xi an incident
									ROOT = {
										tag = event_target:WTT_current_china_leader
									}
									tag = event_target:WTT_communist_china
								}
							}
							NOT = {
								AND = {
									ROOT = {
										tag = MAN #china in this case too op
									}
									tag = event_target:WTT_current_china_leader
								}
							}
							NOT = {
								AND = {
									ic_ratio = { #too strong countries don't apply
										tag = ROOT 
										ratio > 3.5 #a bit more nightmarish
									}
									strength_ratio = { 
										tag = ROOT 
										ratio > 3.5 #a bit more nightmarish
									}
								}
							}
						}
						if = {
							limit = {
								NOT = { has_tech = gw_artillery }
							}
							set_technology = {
								gw_artillery = 1
							}
						}
						if = {
							limit = {
								NOT = {
									has_tech = tech_support
								}
							}
							set_technology = {
								tech_support = 1
							}
						}
						if = {
							limit = {
								NOT = {
									has_country_flag = difficulty_template_set_all
								}
								has_tech = tech_recon
								has_tech = tech_engineers
							}
							division_template = {
								name = "Reserve Infantry Division"
								regiments = {
									infantry = { x = 0 y = 0 }
									infantry = { x = 0 y = 1 }
									infantry = { x = 0 y = 2 }
									infantry = { x = 0 y = 3 }
									infantry = { x = 1 y = 0 }
									infantry = { x = 1 y = 1 }
									infantry = { x = 1 y = 2 }
									infantry = { x = 1 y = 3 }
									infantry = { x = 2 y = 0 }
									infantry = { x = 2 y = 1 }
									infantry = { x = 2 y = 2 }
									infantry = { x = 2 y = 3 }
									infantry = { x = 3 y = 0 }
									artillery_brigade = { x = 4 y = 0 }
									artillery_brigade = { x = 4 y = 1 }
									artillery_brigade = { x = 4 y = 2 }	
								}
								support = {
									artillery = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
									recon = { x = 0 y = 2 }									
								}
							}
							set_country_flag = difficulty_template_set_all
						}
						else_if = {
							limit = {
								NOT = {
									has_country_flag = difficulty_template_set_recon
								}
								has_tech = tech_recon
								NOT = { has_tech = tech_engineers }
							}
							division_template = {
								name = "Reserve Infantry Division"
								regiments = {
									infantry = { x = 0 y = 0 }
									infantry = { x = 0 y = 1 }
									infantry = { x = 0 y = 2 }
									infantry = { x = 0 y = 3 }
									infantry = { x = 1 y = 0 }
									infantry = { x = 1 y = 1 }
									infantry = { x = 1 y = 2 }
									infantry = { x = 1 y = 3 }
									infantry = { x = 2 y = 0 }
									infantry = { x = 2 y = 1 }
									infantry = { x = 2 y = 2 }
									infantry = { x = 2 y = 3 }
									infantry = { x = 3 y = 0 }
									artillery_brigade = { x = 4 y = 0 }
									artillery_brigade = { x = 4 y = 1 }
									artillery_brigade = { x = 4 y = 2 }	
								}
								support = {
									artillery = { x = 0 y = 0 }
									#engineer = { x = 0 y = 1 }
									recon = { x = 0 y = 2 }									
								}
							}
							set_country_flag = difficulty_template_set_recon
						}
						else_if = {
							limit = {
								NOT = {
									has_country_flag = difficulty_template_set_engineer
								}
								has_tech = tech_engineers
								NOT = { has_tech = tech_recon }
							}
							division_template = {
								name = "Reserve Infantry Division"
								regiments = {
									infantry = { x = 0 y = 0 }
									infantry = { x = 0 y = 1 }
									infantry = { x = 0 y = 2 }
									infantry = { x = 0 y = 3 }
									infantry = { x = 1 y = 0 }
									infantry = { x = 1 y = 1 }
									infantry = { x = 1 y = 2 }
									infantry = { x = 1 y = 3 }
									infantry = { x = 2 y = 0 }
									infantry = { x = 2 y = 1 }
									infantry = { x = 2 y = 2 }
									infantry = { x = 2 y = 3 }
									infantry = { x = 3 y = 0 }
									artillery_brigade = { x = 4 y = 0 }
									artillery_brigade = { x = 4 y = 1 }
									artillery_brigade = { x = 4 y = 2 }	
								}
								support = {
									artillery = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
									#recon = { x = 0 y = 2 }									
								}
							}
							set_country_flag = difficulty_template_set_engineer
						}
						else_if = {
							limit = {
								NOT = {
									has_country_flag = difficulty_template_set_none
								}
								NOT = { has_tech = tech_engineers }
								NOT = { has_tech = tech_recon }
							}
							division_template = {
								name = "Reserve Infantry Division"
								regiments = {
									infantry = { x = 0 y = 0 }
									infantry = { x = 0 y = 1 }
									infantry = { x = 0 y = 2 }
									infantry = { x = 0 y = 3 }
									infantry = { x = 1 y = 0 }
									infantry = { x = 1 y = 1 }
									infantry = { x = 1 y = 2 }
									infantry = { x = 1 y = 3 }
									infantry = { x = 2 y = 0 }
									infantry = { x = 2 y = 1 }
									infantry = { x = 2 y = 2 }
									infantry = { x = 2 y = 3 }
									infantry = { x = 3 y = 0 }
									artillery_brigade = { x = 4 y = 0 }
									artillery_brigade = { x = 4 y = 1 }
									artillery_brigade = { x = 4 y = 2 }	
								}
								support = {
									artillery = { x = 0 y = 0 }
									#engineer = { x = 0 y = 1 }
									##recon = { x = 0 y = 2 }									
								}
							}
							set_country_flag = difficulty_template_set_none
						}
						if = {
							limit = {
								has_tech = basic_light_tank						
							}
							if = {
								limit = {
									NOT = {
										has_tech = motorised_infantry
									}
								}
								set_technology = {
									motorised_infantry = 1
								}
							}
							if = {
								limit = {
									NOT = {
										has_tech = basic_light_td
									}
								}
								set_technology = {
									basic_light_td = 1
								}
							}
							set_country_flag = upgraded_to_light_tank
							if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_all_tank_light
									}
									has_tech = tech_recon
									has_tech = tech_engineers
								}
								division_template = {
								name = "Reserve Light Tank Division"
								regiments = {
									light_armor = { x = 0 y = 0 }
									light_armor = { x = 0 y = 1 }
									light_armor = { x = 0 y = 2 }
									light_armor = { x = 0 y = 3 }
									light_armor = { x = 1 y = 0 }										
									light_armor = { x = 1 y = 1 }	
									light_armor = { x = 1 y = 2 }
									light_armor = { x = 1 y = 3 }	
									motorized = { x = 2 y = 0 }
									motorized = { x = 2 y = 1 }
									motorized = { x = 2 y = 2 }
									motorized = { x = 2 y = 3 }					
									light_tank_destroyer_brigade = { x = 3 y = 0 }
									light_sp_artillery_brigade = { x = 3 y = 1 }			
									light_sp_artillery_brigade = { x = 3 y = 2 }
									light_sp_artillery_brigade = { x = 3 y = 3 }
								}
								support = {
									artillery = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
									recon = { x = 0 y = 2 }									
								}
								}
								set_country_flag = difficulty_template_set_all_tank_light
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_recon_tank_light
									}
									has_tech = tech_recon
									NOT = { has_tech = tech_engineers }
								}
								division_template = {
									name = "Reserve Light Tank Division"
									regiments = {
										light_armor = { x = 0 y = 0 }
										light_armor = { x = 0 y = 1 }
										light_armor = { x = 0 y = 2 }
										light_armor = { x = 0 y = 3 }
										light_armor = { x = 1 y = 0 }										
										light_armor = { x = 1 y = 1 }	
										light_armor = { x = 1 y = 2 }
										light_armor = { x = 1 y = 3 }	
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }					
							    		light_tank_destroyer_brigade = { x = 3 y = 0 }
										light_sp_artillery_brigade = { x = 3 y = 1 }			
										light_sp_artillery_brigade = { x = 3 y = 2 }
										light_sp_artillery_brigade = { x = 3 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_recon_tank_light
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_engineer_tank_light
									}
									has_tech = tech_engineers
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Light Tank Division"
									regiments = {
										light_armor = { x = 0 y = 0 }
										light_armor = { x = 0 y = 1 }
										light_armor = { x = 0 y = 2 }
										light_armor = { x = 0 y = 3 }
										light_armor = { x = 1 y = 0 }										
										light_armor = { x = 1 y = 1 }	
										light_armor = { x = 1 y = 2 }
										light_armor = { x = 1 y = 3 }	
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }					
							    		light_tank_destroyer_brigade = { x = 3 y = 0 }
										light_sp_artillery_brigade = { x = 3 y = 1 }			
										light_sp_artillery_brigade = { x = 3 y = 2 }
										light_sp_artillery_brigade = { x = 3 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										engineer = { x = 0 y = 1 }
										#recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_engineer_tank_light
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_none_tank_light
									}
									NOT = { has_tech = tech_engineers }
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Light Tank Division"
									regiments = {
										light_armor = { x = 0 y = 0 }
										light_armor = { x = 0 y = 1 }
										light_armor = { x = 0 y = 2 }
										light_armor = { x = 0 y = 3 }
										light_armor = { x = 1 y = 0 }										
										light_armor = { x = 1 y = 1 }	
										light_armor = { x = 1 y = 2 }
										light_armor = { x = 1 y = 3 }	
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }					
							    		light_tank_destroyer_brigade = { x = 3 y = 0 }
										light_sp_artillery_brigade = { x = 3 y = 1 }			
										light_sp_artillery_brigade = { x = 3 y = 2 }
										light_sp_artillery_brigade = { x = 3 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										##recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_none_tank_light
							}
						}
						if = {
							limit = {
								has_tech = basic_medium_tank						
							}
							if = {
								limit = {
									NOT = {
										has_tech = motorised_infantry
									}
								}
								set_technology = {
									motorised_infantry = 1
								}
							}
							if = {
								limit = {
									NOT = {
										has_tech = basic_medium_td
									}
								}
								set_technology = {
									basic_medium_td = 1
								}
							}
							set_country_flag = upgraded_to_medium_tank
							if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_all_tank_medium
									}
									has_tech = tech_recon
									has_tech = tech_engineers
								}
								division_template = {
								name = "Reserve Medium Tank Division"
								regiments = {
									medium_armor = { x = 0 y = 0 }
									medium_armor = { x = 0 y = 1 }
									medium_armor = { x = 0 y = 2 }
									medium_armor = { x = 0 y = 3 }
									medium_armor = { x = 1 y = 0 }										
									medium_armor = { x = 1 y = 1 }	
									medium_armor = { x = 1 y = 2 }
									medium_armor = { x = 1 y = 3 }	
									motorized = { x = 2 y = 0 }
									motorized = { x = 2 y = 1 }
									motorized = { x = 2 y = 2 }
									motorized = { x = 2 y = 3 }					
									medium_tank_destroyer_brigade = { x = 3 y = 0 }
									medium_sp_artillery_brigade = { x = 3 y = 1 }			
									medium_sp_artillery_brigade = { x = 3 y = 2 }
									medium_sp_artillery_brigade = { x = 3 y = 3 }
								}
								support = {
									artillery = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
									recon = { x = 0 y = 2 }									
								}
								}
								set_country_flag = difficulty_template_set_all_tank_medium
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_recon_tank_medium
									}
									has_tech = tech_recon
									NOT = { has_tech = tech_engineers }
								}
								division_template = {
									name = "Reserve Medium Tank Division"
									regiments = {
										medium_armor = { x = 0 y = 0 }
										medium_armor = { x = 0 y = 1 }
										medium_armor = { x = 0 y = 2 }
										medium_armor = { x = 0 y = 3 }
										medium_armor = { x = 1 y = 0 }										
										medium_armor = { x = 1 y = 1 }	
										medium_armor = { x = 1 y = 2 }
										medium_armor = { x = 1 y = 3 }	
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }					
										medium_tank_destroyer_brigade = { x = 3 y = 0 }
										medium_sp_artillery_brigade = { x = 3 y = 1 }			
										medium_sp_artillery_brigade = { x = 3 y = 2 }
										medium_sp_artillery_brigade = { x = 3 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_recon_tank_medium
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_engineer_tank_medium
									}
									has_tech = tech_engineers
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Medium Tank Division"
									regiments = {
										medium_armor = { x = 0 y = 0 }
										medium_armor = { x = 0 y = 1 }
										medium_armor = { x = 0 y = 2 }
										medium_armor = { x = 0 y = 3 }
										medium_armor = { x = 1 y = 0 }										
										medium_armor = { x = 1 y = 1 }	
										medium_armor = { x = 1 y = 2 }
										medium_armor = { x = 1 y = 3 }	
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }					
										medium_tank_destroyer_brigade = { x = 3 y = 0 }
										medium_sp_artillery_brigade = { x = 3 y = 1 }			
										medium_sp_artillery_brigade = { x = 3 y = 2 }
										medium_sp_artillery_brigade = { x = 3 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										engineer = { x = 0 y = 1 }
										#recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_engineer_tank_medium
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_none_tank_medium
									}
									NOT = { has_tech = tech_engineers }
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Medium Tank Division"
									regiments = {
										medium_armor = { x = 0 y = 0 }
										medium_armor = { x = 0 y = 1 }
										medium_armor = { x = 0 y = 2 }
										medium_armor = { x = 0 y = 3 }
										medium_armor = { x = 1 y = 0 }										
										medium_armor = { x = 1 y = 1 }	
										medium_armor = { x = 1 y = 2 }
										medium_armor = { x = 1 y = 3 }	
										motorized = { x = 2 y = 0 }
										motorized = { x = 2 y = 1 }
										motorized = { x = 2 y = 2 }
										motorized = { x = 2 y = 3 }					
										medium_tank_destroyer_brigade = { x = 3 y = 0 }
										medium_sp_artillery_brigade = { x = 3 y = 1 }			
										medium_sp_artillery_brigade = { x = 3 y = 2 }
										medium_sp_artillery_brigade = { x = 3 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										##recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_none_tank_medium
							}
						}
						if = {
							limit = {
								has_tech = main_battle_tank						
							}
							if = {
								limit = {
									NOT = {
										has_tech = mechanised_infantry
									}
								}
								set_technology = {
									mechanised_infantry = 1
								}
							}
							if = {
								limit = {
									NOT = {
										has_tech = modern_td
									}
								}
								set_technology = {
									modern_td = 1
								}
							}
							set_country_flag = upgraded_to_modern_tank
							if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_all_tank_modern
									}
									has_tech = tech_recon
									has_tech = tech_engineers
								}
								division_template = {
								name = "Reserve Modern Tank Division"
								regiments = {
									modern_armor = { x = 0 y = 0 }
									modern_armor = { x = 0 y = 1 }
									modern_armor = { x = 0 y = 2 }
									modern_armor = { x = 0 y = 3 }
									modern_armor = { x = 1 y = 0 }										
									modern_armor = { x = 1 y = 1 }	
									modern_armor = { x = 1 y = 2 }
									modern_armor = { x = 1 y = 3 }	
									mechanized = { x = 2 y = 0 }
									mechanized = { x = 2 y = 1 }
									mechanized = { x = 2 y = 2 }
									mechanized = { x = 2 y = 3 }					
									modern_tank_destroyer_brigade = { x = 3 y = 0 }
									modern_sp_artillery_brigade = { x = 3 y = 1 }			
									modern_sp_artillery_brigade = { x = 3 y = 2 }
									modern_sp_artillery_brigade = { x = 3 y = 3 }
								}
								support = {
									artillery = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
									recon = { x = 0 y = 2 }									
								}
								}
								set_country_flag = difficulty_template_set_all_tank_modern
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_recon_tank_modern
									}
									has_tech = tech_recon
									NOT = { has_tech = tech_engineers }
								}
								division_template = {
									name = "Reserve Modern Tank Division"
									regiments = {
										modern_armor = { x = 0 y = 0 }
										modern_armor = { x = 0 y = 1 }
										modern_armor = { x = 0 y = 2 }
										modern_armor = { x = 0 y = 3 }
										modern_armor = { x = 1 y = 0 }										
										modern_armor = { x = 1 y = 1 }	
										modern_armor = { x = 1 y = 2 }
										modern_armor = { x = 1 y = 3 }	
										mechanized = { x = 2 y = 0 }
										mechanized = { x = 2 y = 1 }
										mechanized = { x = 2 y = 2 }
										mechanized = { x = 2 y = 3 }					
										modern_tank_destroyer_brigade = { x = 3 y = 0 }
										modern_sp_artillery_brigade = { x = 3 y = 1 }			
										modern_sp_artillery_brigade = { x = 3 y = 2 }
										modern_sp_artillery_brigade = { x = 3 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_recon_tank_modern
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_engineer_tank_modern
									}
									has_tech = tech_engineers
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Modern Tank Division"
									regiments = {
										modern_armor = { x = 0 y = 0 }
										modern_armor = { x = 0 y = 1 }
										modern_armor = { x = 0 y = 2 }
										modern_armor = { x = 0 y = 3 }
										modern_armor = { x = 1 y = 0 }										
										modern_armor = { x = 1 y = 1 }	
										modern_armor = { x = 1 y = 2 }
										modern_armor = { x = 1 y = 3 }	
										mechanized = { x = 2 y = 0 }
										mechanized = { x = 2 y = 1 }
										mechanized = { x = 2 y = 2 }
										mechanized = { x = 2 y = 3 }					
										modern_tank_destroyer_brigade = { x = 3 y = 0 }
										modern_sp_artillery_brigade = { x = 3 y = 1 }			
										modern_sp_artillery_brigade = { x = 3 y = 2 }
										modern_sp_artillery_brigade = { x = 3 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										engineer = { x = 0 y = 1 }
										#recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_engineer_tank_modern
							}
							else_if = {
								limit = {
									NOT = {
										has_country_flag = difficulty_template_set_none_tank_modern
									}
									NOT = { has_tech = tech_engineers }
									NOT = { has_tech = tech_recon }
								}
								division_template = {
									name = "Reserve Modern Tank Division"
									regiments = {
										modern_armor = { x = 0 y = 0 }
										modern_armor = { x = 0 y = 1 }
										modern_armor = { x = 0 y = 2 }
										modern_armor = { x = 0 y = 3 }
										modern_armor = { x = 1 y = 0 }										
										modern_armor = { x = 1 y = 1 }	
										modern_armor = { x = 1 y = 2 }
										modern_armor = { x = 1 y = 3 }	
										mechanized = { x = 2 y = 0 }
										mechanized = { x = 2 y = 1 }
										mechanized = { x = 2 y = 2 }
										mechanized = { x = 2 y = 3 }					
										modern_tank_destroyer_brigade = { x = 3 y = 0 }
										modern_sp_artillery_brigade = { x = 3 y = 1 }			
										modern_sp_artillery_brigade = { x = 3 y = 2 }
										modern_sp_artillery_brigade = { x = 3 y = 3 }
									}
									support = {
										artillery = { x = 0 y = 0 }
										#engineer = { x = 0 y = 1 }
										##recon = { x = 0 y = 2 }									
									}
								}
								set_country_flag = difficulty_template_set_none_tank_modern
							}
						}
						if = {
							limit = {
								check_variable = { This.supply_condition_army_debuff > 30 } #upkeep over 30 percent
								check_variable = { This.supply_condition < 30 } #overall supply smaller than 30 percent
							}							
							if = {
								limit = {
									NOT = { has_country_flag = nightmare_extra_supply }
								}
								set_variable = { nightmare_extra_supply_coefficient = 1 }
								set_country_flag = nightmare_extra_supply
								else = {
									add_to_variable = { nightmare_extra_supply_coefficient = 1 }
								} #this will translate to 10% of upper limit increase
							}
							add_to_variable = { This.supply_condition_base = 10 }
						}
						else = {
							random_owned_controlled_state = {
								limit = {
									PREV = {
										NOT = {
											has_country_flag = upgraded_to_light_tank
											has_country_flag = upgraded_to_medium_tank
											has_country_flag = upgraded_to_modern_tank
										}
									}
								}
								create_unit = {
									division = "name = \"Reserve Infantry Division\" division_template = \"Reserve Infantry Division\" start_experience_factor = 0.4"
									owner = PREV
								}
							}
							random_owned_controlled_state = {
								limit = {
									PREV = {
										has_country_flag = upgraded_to_light_tank
									}
								}
								create_unit = {
									division = "name = \"Reserve Light Tank Division\" division_template = \"Reserve Light Tank Division\" start_experience_factor = 0.4"
									owner = PREV
								}
							}
							random_owned_controlled_state = {
								limit = {
									PREV = {
										has_country_flag = upgraded_to_medium_tank
									}
								}
								create_unit = {
									division = "name = \"Reserve Medium Tank Division\" division_template = \"Reserve Medium Tank Division\" start_experience_factor = 0.4"
									owner = PREV
								}
							}
							random_owned_controlled_state = {
								limit = {
									PREV = {
										has_country_flag = upgraded_to_modern_tank
									}
								}
								create_unit = {
									division = "name = \"Reserve Modern Tank Division\" division_template = \"Reserve Modern Tank Division\" start_experience_factor = 0.4"
									owner = PREV
								}
							}
						}
					}
					set_variable = { this.difficulty_day_count = 0 }
				}
			}
	    #huabei bandit supression hq
	    event_target:WTT_current_china_leader = {
			if = {
				limit = {
					has_war_with = event_target:WTT_communist_china
					country_exists =SUY
					SUY = { has_war_with = event_target:WTT_communist_china }
					has_global_flag = NCBSHQ_formed
					any_owned_state = {
						is_NCBSHQ_state = yes
						is_controlled_by = ROOT
					}
				}
				every_owned_state = {
					limit = {
						is_NCBSHQ_state = yes
						is_controlled_by = event_target:WTT_current_china_leader
					}				
					add_core_of =SUY
					SUY = {
						transfer_state = PREV
					} 
				}
			}				
		}
        #suiyuan army
		event_target:WTT_current_china_leader = {
			if = {
				limit = {
					has_war_with = JAP
					country_exists = SUY
					is_in_faction_with = SUY
					SUY = { is_subject = no }
				}
				1014 = {
					if = {
						limit = {
							NOT = { is_owned_by = SUY }
							OR = {
								is_controlled_by = SHX
								is_controlled_by = event_target:WTT_current_china_leader
								is_controlled_by = SUY
							}
							OR = {
								is_owned_by = ECA
								is_owned_by = event_target:WTT_current_china_leader
							}
						 }  				    
						SUY = {
							transfer_state = 1014
						} 
					}
				}				
		    }
	    }
		#remove anti communist modifier
		event_target:WTT_communist_china = {
			if = {
				limit = {
					NOT = { has_war_with = JAP }
				    any_of_scopes = {
						array = global.small_china
						has_state_flag = we_will_help_the_legit_government 
		                is_owned_by = event_target:WTT_communist_china
					}
				}
			    every_owned_state = {
	                limit = {
		                has_state_flag = we_will_help_the_legit_government 
		                #is_owned_by = event_target:WTT_communist_china
		            }
		            remove_dynamic_modifier = { modifier = anti_partisan_area }
		            clr_state_flag = we_will_help_the_legit_government
		        }
	        }				
		}
		#anti communist modifier 2 
		event_target:WTT_communist_china = {
			if = {
				limit = {
					has_war_with = JAP
					any_of_scopes = {
						array = global.small_china
						has_state_flag = we_will_help_the_legit_government 
		                is_owned_by = event_target:WTT_communist_china
					}
				}
				every_owned_state = {
	                limit = {
		                has_state_flag = we_will_help_the_legit_government 
		                #is_owned_by = event_target:WTT_communist_china
		            }
		            event_target:WTT_current_china_leader = { set_state_controller = PREV }  
				    event_target:WTT_current_china_leader = { set_state_owner = PREV } 
		        }
	        }				
		}
		#JAP = {
		#    if = {
		#	    limit = {
		#		    has_idea = JAP_demilitarisation
		#			has_army_manpower = {
        #                size > 10000
        #           }
		#		}
		#	    every_state = {
		#            JAP = {
		#	            delete_unit = {
		#	                state = PREV
		#	                disband = yes 
		#	            }
		#            }
		#        }
		#	}
		#} 
		#inflation during war of resistance
		event_target:WTT_current_china_leader = {
			if = {
				limit = {
					has_war_with = JAP
				    NOT = {
						has_country_flag = im_read_ccw72_flag
					}
					any_core_state = {
						OR = {
							state = 592
							state = 613
							#state = 608
							state = 1015
							state = 1034
						}
						NOT = {
							has_state_flag = took_by_japan_flag
						}
						is_controlled_by_jap_or_its_puppet = yes	
					}
				}
			    every_core_state = {
					limit = {
						OR = {
							state = 592
							state = 613
							#state = 608
							state = 1015
							state = 1034
						}
					    NOT = {
							has_state_flag = took_by_japan_flag
						}
						is_controlled_by_jap_or_its_puppet = yes
					}
				    set_state_flag = took_by_japan_flag
				}
				country_event = ccw.72
			}				
	    }
        
       GXC = {
			if = {
				limit = {
					OR = {
						AND = {
							controls_state = 613
						    #NOT = {
							#	owns_state = 613
							#}
							613 = {
								NOT = {
									has_state_flag = gxc_owns_here_flag
								}
							}
						}
						AND = {
							controls_state = 1015
						    #NOT = {
							#	owns_state = 1015
							#}
							1015 = {
								NOT = {
									has_state_flag = gxc_owns_here_flag
								}
							}
						}
					}
				    event_target:WTT_current_china_leader = {
						exists = yes
						original_tag = CHI
						is_in_faction_with = ROOT
						is_faction_leader = yes
					}
				}	
				every_controlled_state = {
					limit = {
						OR = {
							state = 613
							state = 1015
						}
					    NOT = {
							is_owned_by = ROOT
						}
					}
					transfer_state_to = event_target:WTT_current_china_leader
				}
			}				
	    }

        if = {
			limit = {
				tag = GXC
				OR = {
					owns_state = 613		
					owns_state = 1015
				}
				NOT = {
					has_defensive_war_with = JAP
				}
			}
			every_owned_state = {
				limit = {
					OR = {
						state = 613
						state = 1015
					}
				}
				set_state_flag = gxc_owns_here_flag
			}
		}

		if = {
			limit = {
				is_literally_china = yes 
			    is_major = no 
				NOT = {
					tag = GUD
					tag = GXC
				}
				OR = {
					is_in_faction_with = GUD
					is_in_faction_with = GXC
				}
				has_war_with = event_target:WTT_current_china_leader
				NOT = {
					has_country_flag = im_lg_ally_flag
				}
			    strength_ratio = {
					tag = event_target:WTT_current_china_leader
					ratio > 0.05
				}
			}
		    set_country_flag = im_lg_ally_flag
			set_major = yes 
		}

		if = {
			limit = {
				is_literally_china = yes 
			    has_country_flag = im_lg_ally_flag
				is_major = yes
				is_faction_leader = no
				NOT = {
					tag = event_target:WTT_current_china_leader
				}
				NOT = {
					has_war_with = event_target:WTT_current_china_leader
			    }
			}
		    clr_country_flag = im_lg_ally_flag
			set_major = no
		}

		if = { 
			limit = {
				tag = EGM
				OR = {
					#NOT = {
					#	has_full_control_of_state = 1031
					#}
					AND = {
						owns_state = 1031
						PRC = {
							has_full_control_of_state = 1031
						}
					}
					AND = {
						owns_state = 1044
						NOT = {
							has_full_control_of_state = 1044
						}
					}
					surrender_progress > 0.6	
				}
				PRC = {
					has_active_mission = PRC_attack_ma_hongbin_mission
					has_war_with = ROOT
				}
				NXM = {
					is_neighbor_of = ROOT
					NOT = {
						has_war_with = ROOT
					}
				}
				NOT = {
					has_global_flag = nxm.3_flag
				}
			}
			set_global_flag = nxm.3_flag
			country_event = nxm.3
		}

		if = { 
			limit = {
				tag = EGM
				NOT = {
					owns_state = 1044
				}
				PRC = {
					has_active_mission = PRC_attack_ma_hongbin_mission
					has_war_with = ROOT
				}
				OR = {
					PRC = {
						controls_province = 3745
					}
					PRC = {
						controls_province = 5025
					}
				}
			}
			random_country = {
				limit = {
					NOT = {
						tag = EGM
					}
					owns_state = 1044
					NOT = {
						has_war_with = EGM
						has_border_war_with = EGM
					}
				}
				country_event = nxm.2
			}
			else_if = {
				limit = {
					PRC = {
						has_active_mission = PRC_attack_ma_hongbin_mission
					}
					1044 = {
						owner = {
							tag = NXM
						}
					}
					EGM = {
						exists = no
					}
					1031 = {
						is_controlled_by = PRC
					}
				}
                PRC = {
				    activate_mission = RCM_border_conflict_prepare_next_offensive
				}
			}
		}

		#DMZ
		if = {
			limit = {
				tag = event_target:WTT_current_china_leader
				NEA = {
					is_subject_of = event_target:WTT_current_china_leader
				}
				has_war_with = PRC
				has_global_flag = tacit_truce_flag		
			}
			1030 = {
				teleport_armies = { 
					to_state = 744
				}
			}
			1053 = {
				teleport_armies = { 
					to_state = 744
				}
			}
		}
		if = {
			limit = {
				tag = NEA
				any_owned_state = {
                    has_state_flag = I_choose_this_state_to_DMZ
					OR = {
						state = 1030
						state = 1053
					}
				}
				has_war_together_with = PRC
				NOT = {
					has_war_with = PRC
				}
				has_war_with = event_target:WTT_current_china_leader				
			}
			if = {
				limit = {
					1030 = {
						has_state_flag = I_choose_this_state_to_DMZ
					}
				}
				1030 = {
					set_demilitarized_zone = no
					clr_state_flag = I_choose_this_state_to_DMZ
				}
			}
			if = {
				limit = {
					1053 = {
						has_state_flag = I_choose_this_state_to_DMZ
					}
				}
				1053 = {
					set_demilitarized_zone = no
					clr_state_flag = I_choose_this_state_to_DMZ
				}
			}
		}
	    if = {
			limit = {
				tag = NEA
				is_subject_of = CHI
				has_war_with = CHI
			}  
			CHI = {
				set_autonomy = {
					target = NEA
					autonomy_state = autonomy_free
				}
			}
			NEA = {
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_war_with = PRC
				}
				NEA = {
					white_peace = PRC
				}
			}	
		}
		if = {
			limit = {
				has_country_flag = not_join_civil_war_flag
                any_enemy_country = {
					OR = {
						is_warlord = yes 
                        tag = event_target:WTT_current_china_leader
					}
				}
			}
            clr_country_flag = not_join_civil_war_flag
		}
		if = {
			limit = {
				has_country_flag = joined_kmt_in_civil_war_flag
                OR = {
                    NOT = {
						has_war_together_with = event_target:WTT_current_china_leader
					}
					has_war_with = event_target:WTT_current_china_leader
				}
			}
            clr_country_flag = joined_kmt_in_civil_war_flag
		}
		if = {
			limit = {
				tag = EGY
				NOT = {
					is_subject_of = ENG
				}
			}  
			EGY = {
				drop_cosmetic_tag = yes
			}	
		}
		if = {
			limit = {
				original_tag = ENG
				has_guaranteed = BHU
				NOT = {
					RAJ = {
						is_subject_of = ROOT
					}
				}
				NOT = {
					has_global_flag = eng_lost_raj_flag
				}
			}  
			#diplomatic_relation = {
            #     country = BHU
            #     relation = guarantee 
			#	active = no 
            #}
			set_global_flag = eng_lost_raj_flag
		}
		if = {
			limit = {
				tag = PRC
				date > 1942.1.1
				date < 1949.1.1
				has_stability < 0.7
				is_ai = yes
			}  
			PRC = {
				add_stability = 0.1
			}	
		}

		if = {
			limit = {
				OR = {
					tag = ENG
					tag = USA
					has_war_with = JAP
				}
				is_ai = yes
				check_variable = { #block AI spam
					This.supply_condition < 50
				}
			}  
			add_to_variable = {
				var = This.supply_condition_base
				value = 50 
			}
		}
		
		#chiang retakes power
		if = {
			limit = {
				tag = CHI
				is_subject = no
				has_global_flag = li_is_in_charge_roc_flag
				OR = {
					GXC = {
						exists = no
					}
					GXC = {
						num_of_controlled_states < 6
					}
				}
				NOT = {
					has_global_flag = EFM_New_Guangxi.334_flag
				}
			}  
			country_event = EFM_New_Guangxi.334
		}
	}
}
	on_nuke_drop = {
		effect = {
			if = {
				limit = {
					FROM = {
						is_owned_by = JAP
						is_core_of = JAP #guo
					}
					has_global_flag = JAP_nuke_1
					NOT = {
						has_global_flag = JAP_nuke_2
					}
				}
				set_country_flag = I_drop_second_nuke
				set_global_flag = JAP_nuke_2
			}
			if = {
				limit = {
					FROM = {
						is_owned_by = JAP
						is_core_of = JAP #guo
					}
					NOT = {
						has_global_flag = JAP_nuke_1
					}
				}
				set_country_flag = I_drop_first_nuke
				set_global_flag = JAP_nuke_1
			}
			if = {
				limit = {
					FROM = {
						is_owned_by = JAP
						is_core_of = JAP #guo
					}
					has_global_flag = JAP_nuke_2
				}
				set_country_flag = I_drop_third_nuke
				set_global_flag = JAP_nuke_1
			}
		}
	}
	on_new_term_election = {
		random_events = {
			100 = rcmjapan.36
		}
		#random_events = {
		#	100 = rcmfrance.1
		#}
		random_events = {
			100 = rcmelection.18
		}
		random_events = {
			100 = rcmchina_elections.5
		}
	}
	#from is war target
	on_declare_war = {
		effect = {
			#remilitarize shanghai
			if = {
				limit = {
					tag = JAP
					FROM = {
						owns_state = 613
						NOT = {
							has_global_flag = no_shanghai_DMZ
						}
					}
					#NOT = {
					#	AND = {
					#		NOT = { 
					#			has_global_flag = JAP_battle_of_shanghai_happened
					#		}
					#		OR = {
					#			613 = {
					#				OWNER = {
					#					#tag = event_target:WTT_current_china_leader
					#					has_war_with = ROOT
					#				}
					#			}
					#			controls_state = 613
					#		}
					#	}
					#}
				}
				613 = {
					set_demilitarized_zone = yes
					set_global_flag = no_shanghai_DMZ
				}
			}
			if = {
				limit = {
					HMI = {
						has_cosmetic_tag = HMI_SIK
					}
					NOT = {
						has_country_flag = no_longer_sinkiang_flag
					}
					OR = {
						tag = HMI
						tag = SIK
					}
					FROM = {
						OR = {
							tag = HMI
							tag = SIK
						}
					}
				}
				HMI = {
					drop_cosmetic_tag = yes
					set_country_flag = no_longer_sinkiang_flag
				}
			}
			if = {
				limit = {
					KRS = {
						has_cosmetic_tag = KRS_SIK
					}
					NOT = {
						has_country_flag = no_longer_sinkiang_flag
					}
					OR = {
						tag = KRS
						tag = SIK
					}
					FROM = {
						OR = {
							tag = KRS
							tag = SIK
						}
					}
				}
				KRS = {
					drop_cosmetic_tag = yes
					set_country_flag = no_longer_sinkiang_flag
				}
			}
			if = {
				limit = {
					ATM = {
						has_cosmetic_tag = ATM_SIK
					}
					NOT = {
						has_country_flag = no_longer_sinkiang_flag
					}
					OR = {
						tag = ATM
						tag = SIK
					}
					FROM = {
						OR = {
							tag = ATM
							tag = SIK
						}
					}
				}
				ATM = {
					drop_cosmetic_tag = yes
					set_country_flag = no_longer_sinkiang_flag
				}
			}
			if = {
				limit = {
					FROM = { #guo
						tag = SOV
						has_civil_war = no
						is_ai = yes
						has_government = communism
						is_subject = no
	                    is_major = yes
					}
					ROOT = { is_major = yes }
				}
				SOV = { country_event = { id = rcmsoviet.46 days = 2 } }
			}
			#ccw china declare war instead
			if = {
				limit = {
					FROM = {
						OR = {
							tag = event_target:WTT_communist_china
							tag = event_target:WTT_current_china_leader
						}
					}
					OR = {
						tag = event_target:WTT_communist_china
						tag = event_target:WTT_current_china_leader
					}
					OR = { #NO NEED TO Negotiate with traitor/fascists
						event_target:WTT_current_china_leader = {
							OR = {
								is_in_faction_with = JAP
								has_government = fascism
							}
						}
						has_global_flag = CHI_no_longer_united_flag
					}
					NOT = {
						any_of_scopes = {
							array = global.small_china
							tooltip = small_china_tt
							is_controlled_by_jap_or_its_puppet = yes
						}
					}
				}
				event_target:WTT_communist_china = {
					country_event = RCM_chinese_civil_war.4
				}
			}
			#offensive war on Japan
			if = {
				limit = {
					tag = event_target:WTT_current_china_leader
					FROM = {
						OR = {
							tag = JAP
							is_subject_of = JAP
							is_in_faction_with = JAP
						}			
					}
				}
				set_global_flag = china_shot_first
				remove_ideas = appeasement_policy_0
				remove_ideas = appeasement_policy
				remove_ideas = appeasement_policy_2
				remove_ideas = appeasement_policy_2_a
				remove_ideas = appeasement_policy_2_b
				remove_ideas = appeasement_policy_2_c
				remove_ideas = appeasement_policy_2_d				
			}
			#encirclement campaign
			if = {
				limit = {
					NOT = {
						has_global_flag = CHI_no_longer_united_flag
					}
					FROM = {
						NOT = {
							has_completed_focus = PRC_War_of_Liberation
						}
						tag = event_target:WTT_communist_china
					}
					tag = event_target:WTT_current_china_leader
					has_completed_focus = CHI_Encirclement_Campaign_focus
					NOT = {
						has_global_flag = CHI_Encirclement_Campaign_has_begun
					}
				}
				add_ideas = CHI_Encirclement_Campaign_idea
				set_global_flag = CHI_Encirclement_Campaign_has_begun
			}
			#Warlords(ROOT) war CHI(FROM), generals return
			if = {
				limit = {
					any_unit_leader = {
						OWNER = { TAG = FROM }
						has_unit_leader_flag = allegiance_to_@ROOT
					}
				}
				every_unit_leader = {
					limit = {
						OWNER = { TAG = FROM }
						has_unit_leader_flag = allegiance_to_@ROOT #return when wars break out
					}
					set_nationality = ROOT
				}
			}
			#CHI(ROOT) war Warlord(FROM), generals return
			if = {
				limit = {
					any_unit_leader = {
						OWNER = { TAG = ROOT }
						has_unit_leader_flag = allegiance_to_@FROM
					}
				}
				every_unit_leader = {
					limit = {
						OWNER = { TAG = ROOT }
						has_unit_leader_flag = allegiance_to_@FROM #return when wars break out
					}
					set_nationality = FROM
				}
			}

			if = { #second sino_japanese_war
				limit = {
					FROM = {
						OR = {
							tag = event_target:WTT_current_china_leader
							AND = {
								is_legit_china = yes
								tag = event_target:WTT_communist_china
							}
						}
					}
					ROOT = {
						tag = JAP
						NOT = {
							has_global_flag = nineteen_thirtynine_start
						}
						OR = {
							NOT = {
								has_global_flag = jap_war_chi
							}
							has_global_flag = jap_war_chi_cd
						}
					}
				}
				set_global_flag = jap_war_chi
				set_global_flag = { flag = jap_war_chi_cd days = 2 value = 1 }
				USA = { set_country_flag = { flag = USA_china_window days = 60 value = 1 } }
				add_ideas = { idea = JAP_intervene_in_china_1 days = 270 }
				news_event = {
					hours = 1
					id = news.1303
				}
				set_global_flag = test_3
				############
				FROM = {
					country_event = {
						hours = 3 id = rcmchina.331 #emergenecy peace
					}
				}
				FROM = {
					set_global_flag = test_1
					country_event = {
						hours = 3 id = rcmchina.100 #form united front
					}
				}
				FROM = {
					if = {
						limit = {
							tag = event_target:WTT_current_china_leader
						}
						country_event = {
							days = 1 id = ccw.99 #military regions
						}
					}
				}
				############
				#if = {
				#	limit = {
				#		FROM = {
				#			NOT = { is_ally_with = JAP }
				#			is_subject = no
				#		}
				#		event_target:WTT_current_china_leader = {
				#			is_subject = no
				#			NOT = { is_ally_with = JAP }
				#			any_enemy_country = {
				#				is_subject = no
				#				NOT = { #prevent zhang lan
				#					tag = event_target:CDL_JAP_puppet
				#				}
				#				NOT = { is_ally_with = JAP }
				#				NOT = {
				#					original_tag = PREV
				#				}
				#				NOT = {
				#					is_ally_with = ROOT
				#				}
				#				is_literally_china = yes
				#				NOT = {
				#					tag = MAN
				#					tag = ECA
				#					tag = EHB
				#					tag = RFM
				#					tag = CCP
				#				}
				#			}
				#		}
				#	}
				#	set_global_flag = test_2
				#	FROM = {
				#		country_event = {
				#			hours = 3 id = rcmchina.331 #emergenecy peace
				#		}
				#	}
				#	else = {
				#		FROM = {
				#			set_global_flag = test_1
				#			country_event = {
				#				hours = 3 id = rcmchina.100 #form united front
				#			}
				#		}
				#	}
				#}
				every_other_country = {
					limit = {
						OR = {
							tag = MAN
							tag = EHB
							tag = ECA
						}
						is_subject_of = JAP
					}
					add_to_war = {
						targeted_alliance = JAP enemy = FROM
					}
				}				
			}
			
		}

	}
	#ROOT = attacking side
	#FROM = defending side
	#fired when two countries end up at war with each other (on_war is fired when a country goes to war against anyone and is not fired again when it enters war against another country unless it went to peace first)
	on_war_relation_added = {
		effect = {			
			if = {
				limit = {
					OR = {
						AND = {
							tag = CHI
							FROM = { tag = event_target:WTT_current_china_leader }
						}
					    AND = {
							tag = CHI
							FROM = { tag = NEA }
						}	
				    }
					NEA = {
						has_cosmetic_tag = NEA_bandit_supression_hq
					}
				}
				NEA = {
					drop_cosmetic_tag = yes
				}	
			}
			if = {
				limit = {
					OR = {
						AND = {
							tag = GXC
							FROM = { tag = event_target:WTT_current_china_leader }
						}
					    AND = {
							tag = event_target:WTT_current_china_leader
							FROM = { tag = GXC }
						}	
				    }
				}
				set_global_flag = liangguang_on_gxc_rebel 
				GXC = { complete_national_focus = GXC_Challenge_central_government }
			}
		    if = { #august storm
				limit = {
				always = no #guo
					NOT = {
						has_global_flag = had_august_storm_flag
					}
					FROM = {
						tag = SOV
						has_war_together_with = event_target:WTT_current_china_leader
					}
					tag = JAP
				}
				hidden_effect = {
					news_event = news.414
				}
				set_global_flag = had_august_storm_flag
			}
			if = {
				limit = {
					OR = {
						AND = {
							tag = SIK
							FROM = {
								tag = KHR
								has_idea = SIK_liu_bin_force
							}	
						}
						AND = {
							tag = KHR
							has_idea = SIK_liu_bin_force
							FROM = {
								tag = SIK
							}	
						}
					}
				}
				KHR = {
					country_event = Sinkiang_rebel.22
				}
				SIK = {
					country_event = Sinkiang_rebel.25
				}
			}
			if = {
				limit = {
					OR = {
						AND = {
							tag = SIK
							FROM = {
								OR = {
									tag = KHR
								    tag = HMI 
									tag = TNG
									tag = KRS 
									tag = ATM 
								}
							}	
						}
						AND = {
							OR = {
								tag = KHR
								tag = HMI 
								tag = TNG
								tag = KRS 
								tag = ATM 
							}
							FROM = {
								tag = SIK
							}	
						}
					}
				}
				SIK = {
					every_core_state = {
                        limit = {
							OR = {
								region = 252
								region = 145
							}
						}
						add_dynamic_modifier = { modifier = sik_battlefield_modifier }
					    add_dynamic_modifier = { modifier = sik_battlefield_modifier_2 scope = SIK }
					}
					if = {
						limit = {
							has_war_with = KHR
						}
						every_core_state = {
							limit = {
								OR = {
									region = 252
									region = 145
								}
							}
							add_dynamic_modifier = { modifier = sik_battlefield_modifier_2 scope = KHR }
						}
					}
					if = {
						limit = {
							has_war_with = TNG
						}
						every_core_state = {
							limit = {
								OR = {
									region = 252
									region = 145
								}
							}
							add_dynamic_modifier = { modifier = sik_battlefield_modifier_2 scope = TNG }
						}
					}
					if = {
						limit = {
							has_war_with = HMI
						}
						every_core_state = {
							limit = {
								OR = {
									region = 252
									region = 145
								}
							}
							add_dynamic_modifier = { modifier = sik_battlefield_modifier_2 scope = HMI }
						}
					}
					if = {
						limit = {
							has_war_with = KRS
						}
						every_core_state = {
							limit = {
								OR = {
									region = 252
									region = 145
								}
							}
							add_dynamic_modifier = { modifier = sik_battlefield_modifier_2 scope = KRS }
						}
					}
					if = {
						limit = {
							has_war_with = ATM
						}
						every_core_state = {
							limit = {
								OR = {
									region = 252
									region = 145
								}
							}
							add_dynamic_modifier = { modifier = sik_battlefield_modifier_2 scope = ATM }
						}
					}
				}
			}
            #civil war mission
			if = {
				limit = {
					has_global_flag = CHI_no_longer_united_flag
					OR = {
						AND = {
							tag = event_target:WTT_current_china_leader
							NOT = {
								has_completed_focus = CHI_the_fall_of_mainland
							}
							FROM = {
								tag = event_target:WTT_communist_china
							}	
						}
						AND = {
							tag = event_target:WTT_communist_china
							FROM = {
								tag = event_target:WTT_current_china_leader
								NOT = {
									has_completed_focus = CHI_the_fall_of_mainland
								}
							}	
						}
					}
					event_target:WTT_communist_china = {
						OR = {
							controls_state = 328
							controls_state = 716
							controls_state = 608
							controls_state = 597
							controls_state = 1015
						}
					}
				}
				#event_target:WTT_communist_china = {
				#	every_owned_state = {
                #        limit = {
				#			OR = {
				#				state = 328
				#				state = 716
				#				state = 608
				#				state = 597
				#				state = 1015
				#			}
				#		}
				#		set_state_flag = ccp_owned_at_start_flag
				#	}
				#}
                event_target:WTT_current_china_leader = {
					activate_mission = retake_important_cities
				}
			}
		}
	}
	on_justifying_wargoal_pulse = { #for china to know someone is justifying
		effect = {
			if = {
				limit = {
					FROM = {
						tag = CHI
					}
					OR = {
						num_of_factories > 50
						is_major = yes
					}
					NOT = {
						has_global_flag = justifying_on_china
					}
				}
				set_global_flag = justifying_on_china
			}
		}
	}
	#FROM is war target
	on_declare_war = {
		effect = {
			#MODDEDv
			if = { #civil war bois
				limit = {
					FROM = {
						num_of_factories > 10 #we are not that mean
					}
					num_of_factories > 10 #we are not that mean
					has_civil_war = yes
					NOT = {
						civilwar_target = ROOT #only old gov gets it
					}
					civilwar_target = FROM
				}
				FROM = {
					country_event = rcmgeneric.5
				}
				if = {
					limit = {
						original_tag = SPR #both franco and republican get it
					}
					country_event = rcmgeneric.5
				}
			}
			######
			if = {
				limit = {
					ROOT = { tag = JAP }
					FROM = {
						is_warlord = yes
					}
				}
				clr_global_flag = RRC_expand
			}
			if = {
				limit = {
					ROOT = { tag = JAP }
					FROM = {
						OR = {
							tag = FIC
							tag = HOL
							tag = INS
							tag = SIA
							tag = AUS
						}
					}
				}
				USA = { country_event = { days = 15 id = rcmjapan.9932 } }
			}
			if = { #block take national leadership decision when China is fighting a warlord
				limit = {
					ROOT = {
						is_warlord = yes
						is_faction_leader = yes
						is_subject = no
						NOT = {
							tag = event_target:WTT_communist_china
						}
					}
					FROM = {
						tag = event_target:WTT_current_china_leader
					}
					NOT = {
						has_global_flag = wtt_war_over_national_leadership
					}
				}
				set_global_flag = wtt_war_over_national_leadership
			}
			if = {
				limit = {
					FROM = {
						tag = event_target:RCM_japan_friendly_china
					}
					tag = JAP
				}
				event_target:RCM_japan_friendly_china = {
					clear_global_event_target = RCM_japan_friendly_china
				}
			}
			#MODDED^
		    if = {
				limit = {
					FROM = {
						tag = event_target:WTT_current_china_leader
					}
					tag = JAP
				}
				hidden_effect = { 
					add_shaan_stronghold = yes
					add_japanese_buffs_in_china = yes
				}
				hidden_effect = {
					if = {
						limit = {
							1019 = {
								is_controlled_by_jap_or_its_puppet = no
							}
						}
						1019 = { add_dynamic_modifier = { modifier = JAP_uninterested_states scope = JAP } }
					}
					if = {
						limit = {
							746 = {
								is_controlled_by_jap_or_its_puppet = no
							}
						}
						746 = { add_dynamic_modifier = { modifier = JAP_uninterested_states scope = JAP } }
					}
					if = {
						limit = {
							616 = {
								is_controlled_by_jap_or_its_puppet = no
							}
						}
						616 = { add_dynamic_modifier = { modifier = JAP_uninterested_states scope = JAP } }
					}
				}
			}
		}
	}
	on_coup_succeeded = {
		effect = {
			#MODDEDv
			random_other_country = {
				limit = {
					has_government = fascism
					original_tag = CHI
					original_tag = ROOT
				}
				remove_ideas = dai_li
				set_country_flag = daili_in_power
				create_country_leader = {
					name = dai_li
					desc = "Dai Li"
					picture = "Portrait_CHI_Dai_Li.dds"
					expire = "1965.1.1"
					ideology = fascism_ideology
					traits = {
						prince_of_terror
					}
				}
			}
			#MODDED^
		}
	}
	# ROOT is capitulated country, FROM is winner
	on_capitulation = {
		effect = {
			if = {
				limit = {
					tag = GER
					has_government = fascism
					FROM = {
						NOT = {
							original_tag = GER
						}
						NOT = {
							has_government = fascism
						}
					}
					NOT = {
						has_global_flag = had_yalta_conference
					}
				}
				set_global_flag = had_yalta_conference
			}
			#MODDEDv
			if = {
				limit = {
					is_subject = yes
					OVERLORD = {
						has_country_flag = peace_on_war_ends_flag
					}
					FROM = {
						is_subject = yes
						OVERLORD = {
							has_country_flag = peace_on_war_ends_flag
						}
					}
				}
				FROM = {
					OVERLORD = {
						save_event_target_as = event_target:loser_overlord
					}
				}
				OVERLORD = {
					every_other_country = {
						limit = {
							is_in_faction_with = PREV
							has_war_with = event_target:loser_overlord
						}
						white_peace = event_target:loser_overlord
					}
					white_peace = event_target:loser_overlord
				}
			}
		
		}
	}
	on_capitulation_immediate = {
		effect = {
			if = {
				limit = {
					original_tag = GER
					has_war_with = FRA
					FROM = { 
					    OR = {
						    is_ally_with = FRA 
						    NOT = { has_war_with = FRA }
						}
					}
				    has_country_flag = case_anton
					any_owned_state = {
						OR = {
							is_core_of = FRA
							is_on_continent = africa
						}
					}
				}
			    FRA = {
					every_core_state = { 
			            limit = {
			                is_owned_by = ROOT
		                }
			            FRA = { transfer_state = PREV }
		            }
					every_owned_state = { 
			            limit = {
			                is_on_continent = africa
			                is_owned_by = ROOT
		                }
			            FRA = { transfer_state = PREV }
		            }
			    }	
			}
		}
	}
	#ROOT is subject FROM is previous overlord
	on_subject_free = {
		effect = {
			#MODDEDv
			#MODDEDv
			if = {
				limit = {
					TAG = JAP
					FROM = {
						tag = USA
					}
				}
				drop_cosmetic_tag = yes
				#guoretire_country_leader = yes
			}
			if = {
				limit = {
					TAG = FIC
				}
				drop_cosmetic_tag = yes
				retire_country_leader = yes
			}
			if = {
				limit = {
					has_country_flag = im_rrc_now
				}
				set_cosmetic_tag = RRC
			}
			if = {
				limit = {
					tag = ECA
				}
				set_cosmetic_tag = MEN_MON
			}
			if = {
				limit = {
					tag = PLM
					has_cosmetic_tag = PLM_SUI
				}
				drop_cosmetic_tag = yes
				set_cosmetic_tag = PLM_suiyuan
				every_owned_state = {
					limit = {
						OR = {
							state = 621
							state = 746
							state = 1014
						}
					}
					#set_state_flag = chi_mon_autonomy_flag
					#add_dynamic_modifier = { modifier = chi_mon_autonomy }
				}
			}
			#MODDED^
		}
	}

	#ROOT is subject FROM is overlord
	on_subject_annexed = {
		#MODDEDv
		effect = {
			if = {
				limit = {
					OR = {
						is_literally_china = yes
						is_warlord = yes
						tag = RFM
						tag = ECA
						tag = MAN
						tag = PLM
						tag = EHB
						tag = CCP
						tag = NSG
						tag = SCG
					}
				}
				country_event = clique.1
			}
			#FROM = {
			#	country_event = { days = 10 id = core.1 }
			#}
		}
		#MODDED^
	}

	#used when puppeting in a peace conference
	#ROOT = nation being puppeted, FROM = overlord
	on_puppet = {		
		effect = {
			if = {
				limit = {
					TAG = SIK
					FROM = {
						tag = event_target:WTT_current_china_leader
					}
				}
				set_cosmetic_tag = SIK_KMT_puppet ####MODDED
				set_party_name = {
			    	ideology = neutrality
			    	long_name = CHI_neutrality_party_long
				}
				#create_country_leader = {
				#	name = "Zhang Zhizhong"
				#	desc = "POLITICS_ZHANG_ZHIZHONG_DESC"
				#	picture = "Portrait_Zhang_Zhizhong.dds"
				#	expire = "1965.1.1"
				#	ideology = despotism
				#	traits = {
				#	}
				#}
			    event_target:WTT_current_china_leader = { CHI_zhang_zhizhong = { set_nationality = ROOT } }
				retire_character = SIK_sheng_shicai
				retire_country_leader = yes
				CHI_zhang_zhizhong = { 
					add_country_leader_role = {
						promote_leader = yes
						country_leader = {
							expire = "1965.1.1"
							ideology = despotism
							traits = {
							}
						} 
					}
				}
			}
			if = {
				limit = {
					FROM = {
						has_government = communism
					}
					ROOT = {
						tag = JAP
					}
				}
				ROOT = {
					create_country_leader = { #triple cuz sometime they just retire
						name = Kyuichi_Tokuda
						desc = "desc_of_tokuda_tt"
						picture = "Portrait_Japan_Kyuichi_Tokuda.dds"
						expire = "1989.1.1"
						ideology = marxism
						traits = {
						}
					}
					create_country_leader = {
						name = Kyuichi_Tokuda
						desc = "desc_of_tokuda_tt"
						picture = "Portrait_Japan_Kyuichi_Tokuda.dds"
						expire = "1989.1.1"
						ideology = marxism
						traits = {
						}
					}
					create_country_leader = {
						name = Kyuichi_Tokuda
						desc = "desc_of_tokuda_tt"
						picture = "Portrait_Japan_Kyuichi_Tokuda.dds"
						expire = "1989.1.1"
						ideology = marxism
						traits = {
						}
					}
				}
			}
			#warlords tried to puppet warlords: instant annex
			if = { #macarthur
				limit = {
					FROM = {
						has_government = democratic
						OR = {
							tag = USA
							tag = ENG
							is_in_faction_with = ENG
						}
					}
					ROOT = {
						OR = {
						    tag = JAP
							original_tag = JAP
						}
					}
				}
				FROM = {
					if = {
						limit = {
							has_government = democratic
						}
						ROOT = {
							set_cosmetic_tag = OCC_JAP
							set_party_name = {
								ideology = democratic
								name = OCC_JAP_party_democratic
								long_name = OCC_JAP_party_democratic_long
							}
						}
					}
					if = {
						limit = {
							tag = USA
						}						
						ROOT = {							
							create_country_leader = {
								name = USA_douglas_macarthur
								desc = "POLITICS_Douglas_MacArthur_DESC"
								picture = "Portrait_Douglas_macarthur.dds"
								expire = "1989.1.1"
								ideology = conservatism
								traits = {
									refounder_of_japan
								}
							}
						}
					}
					if = {
						limit = {
							tag = ENG
						}						
						ROOT = {							
							create_country_leader = {
								name = John_Northcott
								desc = "POLITICS_John_Northcott_DESC"
								picture = "Portrait_Australia_John_Northcott.dds"
								expire = "1989.1.1"
								ideology = conservatism
								traits = {
								}
							}
						}
					}
					else = {
						ROOT = {							
							create_country_leader = {
								name = Supreme_Commander_of_Allied_Powers
								desc = "POLITICS_Douglas_MacArthur_DESC"
								picture = "Portrait_SCAP.dds"
								expire = "1989.1.1"
								ideology = conservatism
								traits = {
									#refounder_of_japan
								}
							}
						}
					}
				}
			}
			if = { #other MAN
				limit = {
					FROM = {
						has_government = democratic
						OR = {
							tag = USA
							tag = ENG
							is_in_faction_with = ENG
						}
					}
					ROOT = {
						tag = MAN
					}
				}
				FROM = {
					if = {
						limit = {
							has_government = democratic
						}
						ROOT = {
							set_cosmetic_tag = OCC_MAN
							set_party_name = {
								ideology = democratic
								name = OCC_MAN_party_democratic
								long_name = OCC_MAN_party_democratic_long
							}
						}
					}
					ROOT = {							
						create_country_leader = {
							name = Supreme_Commander_of_Allied_Powers
							desc = "POLITICS_SCAP_DESC"
							picture = "Portrait_SCAP.dds"
							expire = "1989.1.1"
							ideology = conservatism
							traits = {
								#refounder_of_japan
							}
						}
					}
				}
			}
			if = { #other MEN
				limit = {
					FROM = {
						has_government = democratic
						OR = {
							tag = USA
							tag = ENG
							is_in_faction_with = ENG
						}
					}
					ROOT = {
						tag = ECA
					}
				}
				FROM = {
					if = {
						limit = {
							has_government = democratic
						}
						ROOT = {
							set_cosmetic_tag = OCC_MEN
							set_party_name = {
								ideology = democratic
								name = OCC_MEN_party_democratic
								long_name = OCC_MEN_party_democratic_long
							}
						}
					}
					ROOT = {							
						create_country_leader = {
							name = Supreme_Commander_of_Allied_Powers
							desc = "POLITICS_SCAP_DESC"
							picture = "Portrait_SCAP.dds"
							expire = "1989.1.1"
							ideology = conservatism
							traits = {
								#refounder_of_japan
							}
						}
					}
				}
			}
			if = { #RRC puppeted
				limit = {
					FROM = {
						NOT = {
							tag = JAP
						}
					}
					ROOT = {
						OR = {
							is_rrc = yes
							tag = EHB
							tag = RFM
						}
					}
				}
				FROM = {
					if = {
						limit = {
							NOT = {
								has_government = communism
							}
						}
						ROOT = {
							set_cosmetic_tag = CHI
						}
					}
					else = {
						ROOT = {
							set_cosmetic_tag = PRC
						}
					}
				}
			}
			if = {
				limit = {
					is_literally_china = yes					
					FROM = {
						NOT = {
							tag = event_target:WTT_current_china_leader
						}
						is_literally_china = yes
					}
				}
				FROM = {
					annex_country = { #sorry that'll cause problems
						target = ROOT transfer_troops = no
					}
				}
			}

			if = {
				limit = {
					tag = CHI
					FROM = {
						has_government = communism
					}
				}
				set_cosmetic_tag = PRC
			}
			if = {
				limit = {
					tag = XSM
					FROM = {
						has_government = fascism
					}
				}
				set_cosmetic_tag = XSM_HUI
			}
			if = {
				limit = {
					tag = SIK
					FROM = {
						has_government = fascism
					}
				}
				create_country_leader = {
					name = SIK_muhammad_amin_bughra
					desc = "POLITICS_SHENG_SHICAI_DESC"
					picture = "Portrait_Sinkiang_Amin.dds"
					expire = "1970.1.7"
					ideology = fascism_ideology
					traits = {
						#
					}
				}
				drop_cosmetic_tag = yes
				set_cosmetic_tag = ETR
			}
			if = {
				limit = {
					tag = SIK
					FROM = {
						has_government = neutrality
					}
				}
				create_country_leader = {
					name = SIK_muhammad_amin_bughra
					desc = "POLITICS_AMIN_BUGHRA_DESC"
					picture = "Portrait_Sinkiang_Amin.dds"
					expire = "1970.1.7"
					ideology = despotism
					traits = {
						#
					}
				}
				drop_cosmetic_tag = yes
				set_cosmetic_tag = ETR
			}
			if = {
				limit = {
					tag = FIC
					is_subject_of = JAP
				}
				set_cosmetic_tag = FIC_JAP
				create_country_leader = {
					name = Isamu_Cho
					desc = ""
					picture = "Portrait_Indochina_Isamu_Cho.dds"
					expire = "1936.9.15"
					ideology = fascism_ideology
				}
			}
			if = {
				limit = {
					tag = FIC
					FROM = {
						original_tag = FRA
						has_government = fascism
					}
				}
				set_cosmetic_tag = FIC_FRA
			}
			
			########
			#MODDEDv #this huge section is for Japan to expand its current puppets in PC instead of spamming clique puppets like "yuNNAn eMiPiRe"

			#core first
			every_country = {
				limit = {
					is_subject_of = JAP
				}
				every_state = {
					limit = {
						is_owned_by = ROOT
						is_core_of = PREV
					}
					PREV = {
						transfer_state = PREV
					}
				}
			}
			#then claim
			every_country = {
				limit = {
					is_subject_of = JAP
				}
				every_state = {
					limit = {
						is_owned_by = ROOT
						is_claimed_by = PREV
					}
					PREV = {
						transfer_state = PREV
					}
				}
			}
			every_country = {
				limit = {
					tag = ROOT
					NOT = {
						tag = event_target:CACNL_JAP_puppet
						tag = event_target:CPC_JAP_puppet
						tag = event_target:CDL_JAP_puppet
					}
					OR = {
						original_tag = CHI
						is_originally_warlord = yes
						original_tag = PRC
						original_tag = HMI
						original_tag = TNG
					    original_tag = KHR
						original_tag = KRS
						original_tag = ATM
					}
					FROM = { original_tag = JAP }
				}
				#if = { #we have the decision for this
				#	limit = {
				#		616 = {
				#			controller = {
				#				OR = {
				#					tag = JAP
				#					is_subject_of = JAP
				#				}
				#			}
				#		}
				#		country_exists = ECA
				#	}
				#	ECA = {
				#		transfer_state = 616
				#	}
				#}
				random_other_country = {
					limit = {
						760 = {
							is_controlled_by_jap_or_its_puppet = yes
						}
						is_subject_of = JAP
						has_country_flag = im_jnc_now
					}
					transfer_state = 760
				}
				JAP = {
					if = {
						limit = {#any puppet
							any_other_country = {
								is_subject_of = JAP
							}
						}
						random_other_country = {#all cliques got annexed
							limit = {
								is_subject_of = JAP
								OR = {
									has_country_flag = im_rrc_now #only RRC
									AND = {
										NOT = {
											any_of_scopes = {
												array = JAP.subjects
												is_rrc = yes
											}
											any_country = {
												is_subject_of = JAP
												is_rrc = yes
											}
										}
										OR = {
											AND = {#only rfm
												has_global_flag = rfm_exists
												NOT = {
													has_global_flag = jnc_exists
												}
												original_tag = RFM
												owns_state = 613
											}
											AND = {#only jnc
												owns_state = 608
												OR = {
													original_tag = HPC
													original_tag = EHB
												}
												NOT = {
													country_exists = RFM
												}
											}
											AND = {#only ehb
												NOT = {
													has_global_flag = jnc_exists
													has_global_flag = rfm_exists
												}
												country_exists = EHB
												original_tag = EHB
											}
										}
									}
								}
							}
							annex_country = {
								target = ROOT transfer_troops = yes
							}
						}
						random_other_country = {#split cliques RFM
							limit = {
								ROOT = {
									OR = {
										original_tag = XIK
										original_tag = SIC
										original_tag = GXC
										original_tag = GUD
										original_tag = CHI
										original_tag = YUN
									}
								}
								any_other_country = {
									is_subject_of = JAP
									has_country_flag = im_jnc_now
								}
								original_tag = RFM
							}
							annex_country = {
								target = ROOT transfer_troops = yes
							}
						}
						random_other_country = {#split cliques EHB/HPC
							limit = {#
								ROOT = {
									OR = {
										original_tag = SHC
										original_tag = GSM
										original_tag = EGM
										original_tag = NXM
										original_tag = SHD
										original_tag = SHX
										original_tag = PLM
										original_tag = XSM
										original_tag = PRC
										original_tag = NEA
									}
								}

								any_other_country = {
									owns_state = 613
									original_tag = RFM
								}
								is_subject_of = JAP
								owns_state = 608
								OR = {
									original_tag = HPC
									original_tag = EHB
								}
							}
							annex_country = {
								target = ROOT transfer_troops = yes
							}
						}
					}
					if = {#no puppets, only smol EHB
						limit = {
							EHB = {
								is_subject_of = JAP
							}
							NOT = {
								AND = {
									country_exists = CCP
									country_exists = RFM
								}
							}
							NOT = {
								has_global_flag = jnc_exists
							}
							NOT = {
								has_global_flag = rfm_exists
							}
							NOT = {
								has_global_flag = rrc_exists
							}
						}
						EHB = {
							annex_country = {
								target = ROOT transfer_troops = yes
							}
						}
					}
				}
			}
			#MODDED^
		}
	}

	#used when puppeting through the occupied territories menu during peace time (or when releasing from non-core but owned territory, f.e. Britain releasing Egypt)
	#ROOT = nation being released, FROM = overlord
	on_release_as_puppet = {
		effect = {
			#MODDEDv
			if = {
				limit = {
					TAG = XIA
					FROM = {
						tag = CHI
					}
				}				
				FROM = {
					delete_unit_template_and_units = { #remove when war breaks out
						division_template = "Hunan Luchün Shih"
						disband = no
					}
					#delete_unit_template_and_units = {
					#	division_template = "Hunan T'iaocheng Shih"
					#	disband = no
					#}
					#delete_unit_template_and_units = {
					#	division_template = "Hunan Chengli Shih"
					#	disband = no
					#}
					delete_unit_template_and_units = {
						division_template = "Hunan Tuli Lü"
						disband = no
					}
					#delete_unit_template_and_units = {
					#	division_template = "Hunan Paoan T'uan"
					#	disband = no
					#}
				}
				load_oob = XIA_1936
				load_focus_tree = { tree = china_warlord_focus keep_completed = yes }
				delete_unit_template_and_units = { #remove when war breaks out
					division_template = "Hunan Luchün Shih 2"
					disband = no
				}
				#delete_unit_template_and_units = {
				#	division_template = "Hunan T'iaocheng Shih 2"
				#	disband = no
				#}
				#delete_unit_template_and_units = {
				#	division_template = "Hunan Chengli Shih 2"
				#	disband = no
				#}
				delete_unit_template_and_units = {
					division_template = "Hunan Tuli Lü 2"
					disband = no
				}
				#delete_unit_template_and_units = {
				#	division_template = "Hunan Paoan T'uan 2"
				#	disband = no
				#}
			}
			if = {
				limit = {
					TAG = XSM
				}
				set_cosmetic_tag = XSM_HUI
			}
			if = {
				limit = {
					TAG = SIK
					FROM = {
						tag = event_target:WTT_current_china_leader
					}
				}
				set_cosmetic_tag = SIK_KMT_puppet ####MODDED
		        event_target:WTT_current_china_leader = { CHI_zhang_zhizhong = { set_nationality = SIK } }
                retire_character = SIK_sheng_shicai
				retire_country_leader = yes
				CHI_zhang_zhizhong = { 
					add_country_leader_role = {
						promote_leader = yes
						country_leader = {
							expire = "1965.1.1"
							ideology = despotism
							traits = {
							}
						} 
					}
				}
			}
			if = {
				limit = {
					AND = {
						TAG = FIC
						is_subject_of = JAP
					}
				}
				set_cosmetic_tag = FIC_JAP
				create_country_leader = {
					name = Isamu_Cho
					desc = ""
					picture = "Portrait_Indochina_Isamu_Cho.dds"
					expire = "1936.9.15"
					ideology = fascism_ideology
				}
			}
			if = {
				limit = {
					tag = FIC
					FROM = {
						original_tag = FRA
						has_government = fascism
					}
				}
				set_cosmetic_tag = FIC_FRA
			}
			if = {
				limit = {
					tag = CHI
					FROM = {
						has_government = communism
					}
				}
				set_cosmetic_tag = PRC
			}
			#MODDED^
		}
	}
	#ROOT is free nation FROM is releaser
	on_release_as_free = {
		effect = {
			#MODDEDv
			if = {
				limit = {
					TAG = XIA
					FROM = {
						tag = CHI
					}
				}				
				FROM = {
					delete_unit_template_and_units = { #remove when war breaks out
						division_template = "Hunan Luchün Shih"
						disband = no
					}
					#delete_unit_template_and_units = {
					#	division_template = "Hunan T'iaocheng Shih"
					#	disband = no
					#}
					#delete_unit_template_and_units = {
					#	division_template = "Hunan Chengli Shih"
					#	disband = no
					#}
					delete_unit_template_and_units = {
						division_template = "Hunan Tuli Lü"
						disband = no
					}
					#delete_unit_template_and_units = {
					#	division_template = "Hunan Paoan T'uan"
					#	disband = no
					#}
				}
				load_oob = XIA_1936
				load_focus_tree = { tree = china_warlord_focus keep_completed = yes }
				delete_unit_template_and_units = { #remove when war breaks out
					division_template = "Hunan Luchün Shih 2"
					disband = no
				}
				#delete_unit_template_and_units = {
				#	division_template = "Hunan T'iaocheng Shih 2"
				#	disband = no
				#}
				#delete_unit_template_and_units = {
				#	division_template = "Hunan Chengli Shih 2"
				#	disband = no
				#}
				delete_unit_template_and_units = {
					division_template = "Hunan Tuli Lü 2"
					disband = no
				}
				#delete_unit_template_and_units = {
				#	division_template = "Hunan Paoan T'uan 2"
				#	disband = no
				#}
			}
			if = {
				limit = {
					AND = {
						TAG = FIC
					}
				}
				drop_cosmetic_tag = yes
				retire_country_leader = yes
			}
			if = {
				limit = {
					tag = CHI
					FROM = {
						has_government = communism
					}
				}
				set_cosmetic_tag = PRC
			}
			#MODDED^
		}
	}
	#ROOT WINNER
	on_peaceconference_ended = {
		effect = {
			if = {
				limit = {
					has_global_flag = CHI_no_longer_united_flag
					ROOT = {
						is_literally_china = yes
					    owns_state = 1015
					    is_neighbor_of = FROM
					}
					FROM = {
						tag = event_target:WTT_communist_china
					}
				}
				annex_country = {
					target = FROM transfer_troops = no
				}
			}
			if = {
				limit = {
					ROOT = {
						is_ai = yes
						OR = {
							tag = SOV
							is_literally_china = yes
						}
					}
					FROM = {
						is_subject_of = ROOT
						OR = {
							tag = MAN
							tag = ECA
							tag = EHB
							tag = RFM
						}
					}
				}
				annex_country = {
					target = FROM transfer_troops = no
				}
			}
			if = {
				limit = {
					ROOT = {
						is_ai = yes
						tag = SIK
					}
					FROM = {
						OR = {
							tag = XSM
							tag = GSM
							tag = NXM
							tag = EGM
						}
					}
				}
				annex_country = {
					target = FROM transfer_troops = no
				}
			}
			if = {
				limit = {
					has_global_flag = had_yalta_conference
					#ROOT = {
					#	
					#	#tag = event_target:yalta_origin
					#}
					FROM = {
						tag = GER
						has_government = fascism
					}
				}
				#GER = {
				#	every_owned_state = {
				#		OCCUPIED = {
				#			transfer_state = PREV
				#		}
				#	}
				#	release = WGR
				#}
			}
			if = { #clear core
				limit = {
					FROM = {
						OR = {
							is_literally_china = yes
							is_warlord = yes
							tag = RFM
							tag = ECA
							tag = MAN
							tag = PLM
							tag = EHB
							tag = NSG
							tag = SCG
						}
					}
				}
				country_event = clique.1
			}
			if = { #chi get cleared out when being puppeted
				limit = {
					ROOT = {
						tag = JAP
					}
					FROM = {
						tag = event_target:WTT_current_china_leader
						is_subject_of = JAP
					}
				}
				###### RFM or RRC annex puppeted CHI
				random_other_country = {
					limit = {
						is_in_faction_with = JAP
						is_subject_of = JAP
						OR = {
							has_country_flag = im_rrc_now
							tag = RFM
						}
					}
					annex_country = {
						target = event_target:WTT_current_china_leader transfer_troops = yes
					}
				}
				#####
				###### EHB annex puppeted CHI
				if = {
					limit = {
						country_exists = event_target:WTT_current_china_leader
					    date < 1944.11.1
					}
					random_other_country = {
						limit = {
							is_in_faction_with = JAP
							is_subject_of = JAP
							tag = EHB
							NOT = {
								any_other_country = {
									has_country_flag = im_rrc_now
									tag = RFM
								}
							}
						}
						annex_country = {
							target = CHI transfer_troops = yes
						}
						set_country_flag = im_rrc_now
						set_global_flag = jnc_exists
						set_global_flag = rfm_exists
						set_global_flag = rrc_exists
						set_cosmetic_tag = RRC
						if = {
						    limit = { 
						        1015 = {
			                        is_controlled_by_jap_or_its_puppet = yes
		                        }
						    }
						    set_capital = { state = 1015 }
						}
						create_country_leader = {
							name = Wang_Jingwei
							desc = "POLITICS_WANG_JINGWEI_DESC"
							picture = "gfx/leaders/RRC/Portrait_Wang.dds"
							expire = "1965.1.1"
							ideology = collaborationism
							traits = {
							}
						}
					}
				}
			}
			###WARLORD WIN WAR AGAINST CHI(non power struggle), trigger new national leadership/ if OLDLEADER WIN, clear flag
			if = {
				limit = {
					OR = {
						AND = {
							event_target:WTT_current_china_leader = { tag = FROM }
							ROOT = {
								is_warlord = yes
							}
						}
						AND = {
							ROOT = {
								tag = NEA
								is_faction_leader = yes
							}
							FROM = {
								tag = event_target:WTT_current_china_leader
							}
						}
					}
				}
				if = {
					limit = {
						NOT = { #if it isn't predetermined
							country_exists = event_target:scp_war_opposition_leader
							event_target:WTT_current_china_leader = {
								OR = {
									has_war_with = JAP
									owns_state = 1015
								}
								NOT = {
									has_war_with = ROOT
								}
							}
						}
					}
					if = {#to choose the most suitable warlord
						limit = {
							NOT = {
								has_global_flag = new_china_determined
								is_ally_with = event_target:WTT_current_china_leader
								any_of_scopes = {
									array = global.literally_china_countries
									NOT = {
										tag = MAN
									}
									NOT = {
										tag = PRC
									}
									strength_ratio = {
									    tag = ROOT
									    ratio > 1
									}
								}
							}	
						}
						country_event = nea.3
						set_global_flag = new_china_determined
					}
				}
				else_if = { #if it's predetermined
					limit = {
					    tag = event_target:scp_war_opposition_leader
						NOT = {
							event_target:WTT_current_china_leader = {
								OR = {
									has_war_with = JAP
									owns_state = 1015
								}
								NOT = {
									has_war_with = ROOT
								}
							}
						}
					}
					country_event = nea.3
					clear_global_event_target = scp_war_opposition_leader
					set_global_flag = new_china_determined
				}
				else_if = { #if it's NEA
					limit = {
						ROOT = {
							tag = NEA
							is_faction_leader = yes
						}
						FROM = {
							tag = CHI
						}
					}
					country_event = nea.3
					set_global_flag = new_china_determined
				}
			}
			#if OLDLEADER WIN, clear flag
			if = {
				limit = {
					event_target:WTT_current_china_leader = { tag = ROOT }
					FROM = {
						is_warlord = yes
						OR = {
							is_faction_leader = yes
							tag = event_target:scp_war_opposition_leader
						}
					}
				}
				clr_global_flag = wtt_national_leadership_takeover_in_progress
				clr_global_flag = wtt_war_over_national_leadership
			}
			####DROP CC Clique tag & warlord change color(Doesn't work here, need to edit original file)
			#if = {
			#	limit = {
			#		event_target:WTT_current_china_leader = { tag = ROOT }
			#		FROM = { has_country_flag = wtt_refused_giving_leadership }
			#	}
			#	set_cosmetic_tag = CHI_warlord_leader
			#}
			#else_if = {
			#	limit = {
			#		has_country_flag = wtt_refused_giving_leadership
			#		event_target:WTT_current_china_leader = { tag = FROM }
			#	}
			#	drop_cosmetic_tag = yes
			#}
			#####
			if = { #this is done through decisions?
				limit = {					
					tag = JAP
					FROM = {
						is_literally_china = yes
					}
					is_in_faction_with = event_target:WTT_current_china_leader
					event_target:WTT_current_china_leader = {
						is_subject = no
					}
					has_completed_focus = JAP_unite_china_focus
					NOT = {						
						has_completed_focus = JAP_unite_china_sol_focus
					}
				}
				event_target:WTT_current_china_leader = {
					annex_country = {
						target = FROM transfer_troops = no
					}
				}
				for_each_scope_loop = {
					array = global.big_china
					if = {
						limit = {
							state_should_be_transferred_to_china = yes
						}
						event_target:WTT_current_china_leader = {
							transfer_state = FROM
						}
					}
				}
			}
			if = { #this is done through decisions?
				limit = {					
					tag = JAP
					FROM = {
						is_literally_china = yes
					}
					is_in_faction_with = event_target:WTT_communist_china
					has_completed_focus = JAP_unite_china_focus
					has_completed_focus = JAP_unite_china_sol_focus
				}
				event_target:WTT_communist_china = {
					annex_country = {
						target = FROM transfer_troops = no
					}
				}
				for_each_scope_loop = {
					array = global.big_china
					if = {
						limit = {
							state_should_be_transferred_to_china = yes
						}
						event_target:WTT_communist_china = {
							transfer_state = FROM
						}
					}
				}				
			}
		}
	}
	#ROOT is winner #FROM gets annexed - This fires just before FROM gets annexed, meaning the country and everything it owns still exists. It will also fire on_annex and on_civil_war_end
	on_civil_war_end_before_annexation = {
		effect = {
			if = {
				limit = {
					original_tag = SIK
					has_government = communism
					NOT = {
						has_country_leader = {
							character = SIK_sheng_shicai ruling_only = yes
						}
					}
				}
				drop_cosmetic_tag = yes
				set_cosmetic_tag = ETR
			}
		}
	}
		#ROOT is winner #FROM gets annexed - For civil wars on_civil_war_end is also fired
	on_civil_war_end = { #ROOT is winner #FROM gets annexed, Korean war
		effect = {
			if = {
				limit = {
					HMI = {
						NOT = {
							has_country_flag = dont_drop_tag_again
						}
					}
					ROOT = {
						original_tag = SIK
					}
					any_country_with_original_tag = {
						original_tag_to_check = SIK
						NOT = {
							has_country_leader = {
								character = SIK_sheng_shicai ruling_only = yes
							}
						}
					}
					country_exists = HMI
				}
				HMI = {
					drop_cosmetic_tag = yes
				}
				set_country_flag = dont_drop_tag_again
			}
		}
	}
	on_annex = { #root winner
		effect = {
			
            if = {
				limit = {
					FROM = {
						is_literally_china = yes
						any_of_scopes = {
							array = global.small_china
							OR = {
								has_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
								has_dynamic_modifier = { modifier = military_region_2_modifier scope = PREV }
								has_dynamic_modifier = { modifier = military_region_3_modifier scope = PREV }
								has_dynamic_modifier = { modifier = military_region_4_modifier scope = PREV }
								has_dynamic_modifier = { modifier = military_region_5_modifier scope = PREV }
								has_dynamic_modifier = { modifier = military_region_6_modifier scope = PREV }
								has_dynamic_modifier = { modifier = military_region_7_modifier scope = PREV }
								has_dynamic_modifier = { modifier = military_region_8_modifier scope = PREV }
								has_dynamic_modifier = { modifier = military_region_9_modifier scope = PREV }
								has_dynamic_modifier = { modifier = military_region_10_modifier scope = PREV }
							}
						}
					}	
				}
				FROM = {
					for_each_scope_loop = {
						array = global.small_china
						if = {
							limit = {
								OR = {
									has_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
									has_dynamic_modifier = { modifier = military_region_2_modifier scope = PREV }
									has_dynamic_modifier = { modifier = military_region_3_modifier scope = PREV }
									has_dynamic_modifier = { modifier = military_region_4_modifier scope = PREV }
									has_dynamic_modifier = { modifier = military_region_5_modifier scope = PREV }
									has_dynamic_modifier = { modifier = military_region_6_modifier scope = PREV }
									has_dynamic_modifier = { modifier = military_region_7_modifier scope = PREV }
									has_dynamic_modifier = { modifier = military_region_8_modifier scope = PREV }
									has_dynamic_modifier = { modifier = military_region_9_modifier scope = PREV }
									has_dynamic_modifier = { modifier = military_region_10_modifier scope = PREV }
								}
							}
							remove_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
							remove_dynamic_modifier = { modifier = military_region_2_modifier scope = PREV }
							remove_dynamic_modifier = { modifier = military_region_3_modifier scope = PREV }
							remove_dynamic_modifier = { modifier = military_region_4_modifier scope = PREV }
							remove_dynamic_modifier = { modifier = military_region_5_modifier scope = PREV }
							remove_dynamic_modifier = { modifier = military_region_6_modifier scope = PREV }
							remove_dynamic_modifier = { modifier = military_region_7_modifier scope = PREV }
							remove_dynamic_modifier = { modifier = military_region_8_modifier scope = PREV }
							remove_dynamic_modifier = { modifier = military_region_9_modifier scope = PREV }
							remove_dynamic_modifier = { modifier = military_region_10_modifier scope = PREV }
						}
					}
				}
			}

			if = { #transfer generals
				limit = {
					is_literally_china = yes
					has_government = FROM
					tag = event_target:scp_war_opposition_leader
					FROM = {
						tag = event_target:scp_war_old_leader
					}
				}
				FROM = {
					every_unit_leader = {
						set_nationality = ROOT
					}
				}
			}
			if = { #in case puppet gov claim china
				limit = {
					is_literally_china = yes
					FROM = {
						OR = {
							tag = MAN
							has_country_flag = im_jnc_now
							tag = RFM
							has_country_flag = im_rrc_now
						}
						tag = event_target:WTT_current_china_leader
					}
				}
				FROM = { set_variable = { global.previous_china_leader = THIS } }
				clear_global_event_target = WTT_current_china_leader #fomer china not us
				save_global_event_target_as = WTT_current_china_leader
			}
			#
			if = { #clear core
				limit = {
					FROM = {
						OR = {
							is_literally_china = yes
							is_warlord = yes
							tag = RFM
							tag = ECA
							tag = MAN
							tag = PLM
							tag = EHB
							tag = CCP
							tag = NSG
							tag = SCG
						}
					}
				}
				country_event = clique.1
			}
			if = {
				limit = { #New leadership takeover
					FROM = { has_country_flag = wtt_refused_giving_leadership }
					ROOT = {
						is_warlord = yes
					}
				}
				if = {
					limit = {
						has_country_flag = cooperation_with_nationalist_flag
					}
					set_cosmetic_tag = CHI_warlord_leader
				}
				if = {
					limit = {
						has_country_flag = cooperation_with_communist_flag
					}
					set_cosmetic_tag = CHI_warlord_PRC
				}
				FROM = { #in case other people release China
					remove_ideas = CHI_illegal_regime
					clr_country_flag = wtt_refused_giving_leadership
					drop_cosmetic_tag = yes
				}
			}
			if = { 
				limit = {
					FROM = {
						tag = GXC
					    has_template = "Mint'uan"
					}
				}
				FROM = {
					delete_unit_template_and_units = {
						division_template = "Mint'uan"
						disband = yes #will refund equipment and manpower
					}
				}
			}
			if = { 
				limit = {
					FROM = {
						tag = GXC
					    has_template = "Fei Chêngkuei Chün"
					}
				}
				FROM = {
					delete_unit_template_and_units = {
						division_template = "Fei Chêngkuei Chün"
						disband = yes #will refund equipment and manpower
					}
				}
			}
			if = { #transfer generals
				limit = {
					#has_government = FROM
					tag = event_target:WTT_current_china_leader
					FROM = {
						OR = {
							tag = GXC
							tag = GUD
						}
					}
				}
				FROM = {
					every_unit_leader = {
						limit = {
							OR = {
								is_character = GXC_li_zongren
								is_character = GUD_chen_jitang
							}
						}
						set_nationality = ROOT
						#remove_unit_leader_role = yes
						remove_country_leader_role = {
							ideology = despotism
							ideology = fascism_ideology
							ideology = conservatism
							ideology = marxism
							ideology = n_socialism_ideology
						}
					}
				}
			}
		}
	}
	on_subject_free = { #ROOT is subject FROM is previous overlord
		effect = {
			if = { #change Korea country name and flag
				limit = {
					tag = DPR
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					original_tag = KOR
					NOT = {
						tag = KOR
					}
				}
				set_cosmetic_tag = DPR
			}
		}
	}
	#ROOT is new controller #FROM is old controller #FROM.FROM is state ID
	on_state_control_changed = {
		effect = {		
			#civil war debuff for chi
			if = {
				limit = {
					event_target:WTT_current_china_leader = {
						NOT = {
							has_active_mission = retake_important_cities
							#has_war_with = JAP
							has_country_flag = im_read_ccw19_flag
						}
						has_global_flag = CHI_no_longer_united_flag
						has_war_with = event_target:WTT_communist_china
						any_core_state = {
							OR = {
								state = 328
								state = 716
								state = 608
								state = 615
								state = 1015
							}
							is_controlled_by = event_target:WTT_communist_china
							NOT = {
								has_state_flag = took_by_ccp_flag
							}
						}
						NOT = {
							has_completed_focus = CHI_the_fall_of_mainland
						}
					}
					FROM.FROM = {
						OR = {
							state = 328
							state = 716
							state = 608
							state = 597
							state = 1015
						}
						is_controlled_by = event_target:WTT_communist_china
						NOT = {
							has_state_flag = took_by_ccp_flag
						}
					}
				}	
				FROM.FROM = {
					set_state_flag = took_by_ccp_flag
				}
				event_target:WTT_current_china_leader = {
					country_event = ccw.19
				}
			}				
			
			if = {
				limit = {
					event_target:WTT_current_china_leader = {
						NOT = {
							has_active_mission = retake_important_cities
							#has_war_with = JAP
							has_country_flag = im_read_ccw19_flag
						}
						has_global_flag = CHI_no_longer_united_flag
						has_war_with = event_target:WTT_communist_china
						any_core_state = {
							OR = {
								state = 328
								state = 716
								state = 608
								state = 615
								state = 1015
							}
							NOT = {
								is_controlled_by = event_target:WTT_communist_china
							}
							has_state_flag = took_by_ccp_flag
						}
						NOT = {
							has_completed_focus = CHI_the_fall_of_mainland
						}
					}
					FROM.FROM = {
						OR = {
							state = 328
							state = 716
							state = 608
							state = 597
							state = 1015
						}
						NOT = {
							is_controlled_by = event_target:WTT_communist_china
						}
						has_state_flag = took_by_ccp_flag
					}
				}	
				FROM.FROM = {
					clr_state_flag = took_by_ccp_flag
				}
				event_target:WTT_current_china_leader = {
					country_event = ccw.19
				}
			}	
			if = { #second victory
			    limit = {
					tag = PRC
					NOT = {
						has_country_flag = PRC_west_expedition_victory
					}
					FROM.FROM.FROM = {
						state = 1044
					}
			    }
				XSM = {
					country_event = qng.2
				}
			    set_country_flag = PRC_west_expedition_victory
		    }
			if = {
				limit = {
					FROM.FROM = {
						state = 1030
						is_capital = no
						is_owned_by = ROOT
					}
					tag = PRC
					num_of_controlled_states < 5
					NOT = {
						has_country_flag = RCM_comchina.44_flag
					}
				}
				country_event = RCM_comchina.44
			}
			
			if = {
				limit = {
					has_global_flag = prc_chihtan_flag
					FROM.FROM = {
						state = 622
					}
					FROM = {
						tag = PRC
					}	
				}
				set_province_name = { id = 13402 name = VICTORY_POINTS_13402 } 
			}
            
			if = {
				limit = {
					has_global_flag = prc_chihtan_flag
					FROM.FROM = {
						state = 622
					}
					tag = PRC
				}
				set_province_name = { id = 13402 name = VICTORY_POINTS_chihtan }
			}

			if = {
				limit = {
					FROM.FROM = {
						state = 525
						is_capital = no
					}
					OR = {
						original_tag = DPR
						original_tag = KOR
					}
					OR = { 
						is_ally_with = USA
						is_ally_with = ENG
						NOT = { has_government = communism }
					}
				}
				ROOT = {
					set_capital = { state = 525 }
				}	
			}
			
			if = {
				limit = {
					FROM.FROM = {
						is_core_of = ECA
						NOT = {
							has_state_flag = JAP_chumogun_flag
							OR = {
								state = 621
								state = 746
								state = 1019
								is_core_of = NXM
							}
						}
					}
					OR = {
						tag = JAP
						tag = ECA
						is_ally_with = JAP
					}
				}
				FROM.FROM = {
					set_state_flag = JAP_chumogun_flag
					add_dynamic_modifier = { modifier = JAP_chumogun scope = ECA }
					add_dynamic_modifier = { modifier = JAP_chumogun scope = JAP }
					add_dynamic_modifier = { modifier = JAP_chumogun_ehb scope = EHB }
					add_dynamic_modifier = { modifier = JAP_chumogun_man scope = MAN }
				}	
			}

			#if = {
			#	limit = {
			#		FROM.FROM = {
			#			has_state_flag = chi_mon_autonomy_flag
			#			OR = {
			#				has_dynamic_modifier = { modifier = chi_mon_autonomy }
			#				has_dynamic_modifier = { modifier = chi_mon_autonomy_weak }
			#			}
			#		}
			#		OR = {
			#			tag = JAP
			#			tag = ECA
			#			#is_ally_with = JAP
			#		}
			#	}
			#	FROM.FROM = {
			#		#clr_state_flag = chi_mon_autonomy_flag
			#		remove_dynamic_modifier = { modifier = chi_mon_autonomy }
			#		remove_dynamic_modifier = { modifier = chi_mon_autonomy_weak }
			#	}	
			#}

			#if = {
			#	limit = {
			#		FROM.FROM = {
			#			has_state_flag = chi_mon_autonomy_flag
			#			NOT = {
			#				has_state_flag = weakened_mon_autonomy_flag
			#				has_dynamic_modifier = { modifier = chi_mon_autonomy }
			#			}
			#		}
			#		tag = SUY
			#	}
			#	FROM.FROM = {
			#		#set_state_flag = chi_mon_autonomy_flag
			#		add_dynamic_modifier = { modifier = chi_mon_autonomy }
			#	}	
			#}

			#if = {
			#	limit = {
			#		FROM.FROM = {
			#			has_state_flag = weakened_mon_autonomy_flag
			#			NOT = {	
			#				has_dynamic_modifier = { modifier = chi_mon_autonomy_weak }
			#			}
			#		}
			#		tag = SUY
			#	}
			#	FROM.FROM = {
			#		#set_state_flag = chi_mon_autonomy_flag
			#		add_dynamic_modifier = { modifier = chi_mon_autonomy_weak }
			#	}	
			#}
			
			if = {
				limit = {
					OR = {
						tag = JAP
						is_subject_of = JAP
					}
					FROM = {
						is_literally_china = yes
					}
					FROM.FROM = {
						is_core_of = ROOT
						is_in_array = {
							global.small_china = this.id
						}
					}
				}
				FROM.FROM = {
					set_state_province_controller = {
						controller = ROOT
						limit = {
							is_ally_with = ROOT
						}
					}
				}
			}
			if = { #fixes weird bug where Man would control state on map but MEN control in game
				limit = {
					FROM.FROM = {
						state = 1014
					}
					is_ally_with = JAP
					FROM = {
						is_ally_with = JAP
					}
				}
				FROM.FROM = {
					get_correct_controller_of_state = yes
				}
				if = {
					limit = {
						event_target:correct_controller = {
							NOT = {
								tag = ROOT
							}
						}
					}
					FROM.FROM = {
						set_state_province_controller = {
							controller = ROOT
							limit = {
								is_ally_with = ROOT
							}
						}
					}
				}
			}
			if = {
				limit = {
					ROOT = {
						OR = {
							tag = JAP
							is_puppet_of = JAP
						}
					}
					FROM = {
						is_literally_china = yes
						tag = event_target:WTT_current_china_leader
					}
				}
				if = {
					limit = {
						FROM = {
							surrender_progress > 0.4
						}
						NOT = {
							has_global_flag = CHI_40_percent_lost
						}
					}
					set_global_flag = CHI_40_percent_lost
				}
				if = {
					limit = {
						FROM = {
							surrender_progress > 0.5
						}
						NOT = {
							has_global_flag = CHI_50_percent_lost
						}
					}
					set_global_flag = CHI_50_percent_lost
				}
				if = {
					limit = {
						FROM = {
							surrender_progress > 0.6
						}
						NOT = {
							has_global_flag = CHI_60_percent_lost
						}
					}
					set_global_flag = CHI_60_percent_lost
				}				
			}
			if = {
				limit = {
					FROM.FROM = {
						is_capital = yes
						is_core_of = FROM
					}
					FROM = {
						#has_capitulated = yes
						#surrender_progress > 0.99
						owns_state = FROM.FROM
						has_war_together_with = JAP
						is_subject_of = JAP
					}
					OR = {
						original_tag = CHI
						original_tag = PRC
						is_originally_warlord = yes
					}
				}
				for_each_scope_loop = {
					array = global.states_for_liberation
					clr_state_flag = hanjian_captured_@FROM
				}
				clear_global_event_target = captured_hanjian
				clear_global_event_target = hanjian_captured_state
				FROM = {
					set_country_flag = i_capitulated_@FROM
					save_global_event_target_as = captured_hanjian					
				}
				FROM.FROM = {
					set_state_flag = hanjian_captured_@FROM
					save_global_event_target_as = hanjian_captured_state
					if = {
						limit = {#NO COMMIE MILITIA/Im already commie LUL
							OR = {
								has_state_flag = we_will_help_the_legit_government
								NOT = {
									is_core_of = event_target:WTT_communist_china
									#has_state_flag = commie_amassed_support
								}
								ROOT = {
									tag = event_target:WTT_communist_china
								}
							}
						}
						ROOT = {
							if = {
								limit = {
									tag = event_target:WTT_communist_china
								}
								every_other_country = {
									limit = {
										OR = {
											is_literally_china = yes
											has_war_with = JAP
										}
										NOT = {
											has_government = communism
										}
									}
									country_event = {
										hours = 4 id = prc.7 #oh no!
									}
								}
							}
							if = {
								limit = {
									event_target:captured_hanjian = {
										surrender_progress < 0.99
										num_of_controlled_states > 0
									}
								}
								event_target:hanjian_captured_state = {
									set_state_owner = PREV
								}
								event_target:hanjian_captured_state = {
									set_state_province_controller = {
										controller = ROOT
										limit = {
											has_war_together_with = ROOT
										}   
									}
								}
								if = { #Buy Nanking, give Shanghai free (so RRC don't capitulate)
									limit = {
										event_target:hanjian_captured_state = {
											state = 1015
										}
									}
									set_state_owner = 613
								}								
							}
							else = {
								set_global_flag = wtf_pdx
								capture_collaborators = yes
							}
							country_event = {
								id = prc.6 #Kill THE HANJIAN!
							}
						}
						else = {#COMMIE MILITIA RAMPANT
							get_correct_controller_of_state = yes
							event_target:correct_controller = {
								if = {
									limit = {
										OR = {
											is_originally_warlord = yes
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								country_event = {
									hours = 5 id = prc.7 #oh no!
								}
								event_target:WTT_communist_china = {
									if = {
										limit = {
											event_target:captured_hanjian = {
												surrender_progress < 0.99
												num_of_controlled_states > 0
											}
										}
										event_target:hanjian_captured_state = {
											set_state_owner = PREV
										}
										event_target:hanjian_captured_state = {
											set_state_province_controller = {
												controller = ROOT
												limit = {
													has_war_together_with = ROOT
												}
											}
										}
										if = { #Buy Nanking, give Shanghai free (so RRC don't capitulate)
											limit = {
												event_target:hanjian_captured_state = {
													state = 1015
												}
											}
											set_state_owner = 613
										}										
									}
									else = {
										capture_collaborators = yes
									}							
									country_event = prc.8 #Kill THE HANJIAN!(Remotely cuz I can)
								}
							}
						}	
					}
				}
				FROM = {
					if = {
						limit = {
							surrender_progress > 0.99
							num_of_controlled_states < 1
						}
						for_each_scope_loop = { #transfer controller to Japan
						array = global.small_china
							if = {
								limit = {
									is_core_of = event_target:captured_hanjian
									controller = {
										OR = {
											NOT = {
												is_ally_with = JAP
											}
											tag = event_target:captured_hanjian
										}
									}
								}
								set_state_province_controller = {
									controller = JAP
									limit = {
										is_ally_with = JAP
									}
								}
							}																
						}
					}
				}			
			}

            if = {
				limit = {
					tag = DPR
					NOT = {
						has_government = communism 
					}
					FROM = {
						tag = KOR
					}
					FROM.FROM = {
						is_SK_state = yes
						is_core_of = KOR
						NOT = {
							is_owned_by = ROOT
						}
					}
				}
				transfer_state = FROM.FROM
			}

			if = {
				limit = {
					OR = {
					    tag = DPR
						original_tag = KOR
					}
					has_government = communism 
					NOT = {
						tag = KOR
					}
					FROM = {
						tag = KOR
					}
					FROM.FROM = {
						is_NK_state = yes
						is_core_of = KOR
						NOT = {
							is_owned_by = ROOT
						}
					}
				}
				transfer_state = FROM.FROM
			}
			
			if = {
				limit = {
					original_tag = RAJ
					JAP = { has_completed_focus = Second_indian_focus }
					is_subject_of = JAP
					NOT = {
						tag = RAJ
					}
					FROM = {
						tag = RAJ
					}
					FROM.FROM = {
						is_core_of = RAJ
						NOT = {
							is_owned_by = ROOT
						}
					}
				}
				transfer_state = FROM.FROM
			}
			
			if = {
				limit = {
					tag = RAJ
					has_war_with = JAP 
					FROM = {
						original_tag = RAJ
						is_subject_of = JAP 
					}
					FROM.FROM = {
						is_core_of = RAJ
						NOT = {
							is_owned_by = ROOT
						}
					}
				}
				transfer_state = FROM.FROM
			}
			
			#this is not yours! #this will cause problems, uncontrolled land will be taken
			#if = {
			#	limit = {
			#		is_puppet_of = JAP
			#		FROM = {
			#			is_literally_china = yes
			#		}
			#		FROM.FROM = {
			#			is_core_of = CHI
			#			NOT = {
			#				is_core_of = ROOT
			#			}
			#		}
			#		any_allied_country = {
			#			FROM.FROM = {
			#				is_core_of = PREV
			#			}
			#		}
			#	}
			#	random_other_country = {
			#		limit = {
			#			is_in_faction_with = ROOT
			#			has_war_together_with = ROOT
			#			FROM.FROM = {
			#				is_core_of = PREV
			#			}
			#		}
			#		set_state_controller = FROM.FROM
			#	}
			#}
			#SOV is tough
			if = {
				limit = {
					FROM = {
						tag = SOV
					}
					FROM.FROM = {
						is_core_of = SOV
						is_owned_by = SOV
					}
					NOT = {
						has_idea = RCM_general_frost
					}
				}
				#country_event = rcmsoviet.30
			}
			if = { #civil war liberation events
				limit = {
					has_global_flag = PRC_civil_war_started#guo
					
					FROM = {
						num_of_controlled_states > 0
						tag = event_target:WTT_current_china_leader
						NOT = {
							has_idea = CHI_communist_in_government
						}
						NOT = {
							OR = {
								has_government = communism
								has_government = n_socialism
							}
						}
					}
					tag = event_target:WTT_communist_china
					has_government = communism
				}
				FROM.FROM = {
					state_event = prc_states_liberated_state.1
				}
				#FROM = {
				#
				#}
				#ROOT = {
				#	state_event = prc_states_liberated.1
				#}
			}
			if = { #civil war reclamation events
				limit = {
					has_global_flag = PRC_civil_war_started#guo
					
					tag = event_target:WTT_current_china_leader
					NOT = {
						OR = {
							has_government = communism
							has_government = n_socialism
						}
					}
					FROM = {
						num_of_controlled_states > 0
						tag = event_target:WTT_communist_china
						has_government = communism
					}
				}
				FROM.FROM = {
					state_event = prc_states_liberated_state.2
				}
			}
			if = {
				limit = {
					is_literally_china = yes
					has_war_with = JAP
					any_neighbor_country = {
						has_war_with = ROOT
					}
					NOT = {
						owns_state = FROM.FROM
					}
					FROM.FROM = {
						is_in_array = {
							global.small_china = This.id
						}
						owner = {
							has_war_with = ROOT
						}
						#OR = {
						#	is_claimed_by = ROOT
						#	is_core_of = ROOT
						#}
						NOT = {
							AND = {
								is_capital = yes
								owner = {
									is_subject_of = JAP
								}
							}
						}
					}

				}
				FROM.FROM = {
					if = {#NO COMMIE MILITIA
						limit = {
							ROOT = {
								has_war_together_with = event_target:WTT_current_china_leader
							}
							NOT = { is_core_of = SHX }
							NOT = {
								AND = {
									is_core_of = HPC
									HPC = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							NOT = {
								AND = {
									is_core_of = PLM
									PLM = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							NOT = {
								AND = {
									is_core_of = SUY
									SUY = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							NOT = { is_core_of = event_target:WTT_communist_china } #now they gotta amass support before they can take over it directly
						}
						#event_target:WTT_current_china_leader = { set_state_owner = PREV }
						#set_state_province_controller = {
						#	controller = event_target:WTT_current_china_leader
						#	limit = {
						#		has_war_together_with = event_target:WTT_current_china_leader
						#	}
						#}
						#save_event_target_as = from_from_state
						get_correct_controller_of_state = yes
						if = {
							limit = {
								ROOT = { #only get correct controller when [global.GetCPC] is the in-game one
									tag = event_target:WTT_communist_china
								}
								event_target:correct_controller = { #if the correct controller is PRC, check core
									NOT = {
										tag = event_target:WTT_communist_china
									}
								}
							}						#
							event_target:correct_controller = { set_state_owner = PREV }
							set_state_province_controller = {
								controller = event_target:correct_controller
								limit = {
									has_war_together_with = event_target:correct_controller
								}
							}							
						}
						else_if = {
							limit = {
								ROOT = { #only get correct controller when [global.GetCPC] is the in-game one
									tag = event_target:WTT_communist_china
								}
								OCCUPIED = {
									NOT = {
										has_war_together_with = JAP
									}
									NOT = {
										tag = event_target:WTT_communist_china
									}
								}
								event_target:correct_controller = { #if the correct controller is PRC, check core
									tag = event_target:WTT_communist_china
								}
							}
							OCCUPIED = { set_state_owner = PREV }
							set_state_province_controller = {
								controller = OCCUPIED
								limit = {
									has_war_together_with = OCCUPIED
								}
							}							
						}
						else = {
							if = {
								limit = {
									ROOT = {
										NOT = {
											tag = event_target:WTT_communist_china
										}
									}
								}
								add_core_of = ROOT
							}
							ROOT = { set_state_owner = PREV }
							set_state_province_controller = {
								controller = ROOT
								limit = {
									has_war_together_with = ROOT
								}
							}							
						}
					}
					if = {#COMMIE MILITIA AMASSED SUPPORT
						limit = {
							NOT = { is_core_of = SHX }
							NOT = {
								AND = {
									is_core_of = HPC
									HPC = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							NOT = {
								AND = {
									is_core_of = PLM
									PLM = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							NOT = {
								AND = {
									is_core_of = SUY
									SUY = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							is_core_of = event_target:WTT_communist_china
							#has_state_flag = commie_ridden_states
						}
						event_target:WTT_communist_china = { set_state_owner = PREV }
						set_state_province_controller = {
							controller = event_target:WTT_communist_china
							limit = {
								has_war_together_with = event_target:WTT_communist_china
							}
						}						
						clr_state_flag = commie_ridden_states
					}
					if = {#COMMIE MILITIA AMASSED SUPPORT
						limit = {
							NOT = { is_core_of = SHX }
							NOT = {
								AND = {
									is_core_of = HPC
									HPC = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							is_core_of = PLM
							PLM = {
								is_ally_with = event_target:WTT_current_china_leader
							}
							NOT = { is_core_of = event_target:WTT_communist_china }
							#has_state_flag = commie_ridden_states
						}
						PLM = { set_state_owner = PREV }
						set_state_province_controller = {
							controller = PLM
							limit = {
								has_war_together_with = PLM
							}
						}		
					}
					if = {#COMMIE MILITIA AMASSED SUPPORT
						limit = {
							NOT = { is_core_of = SHX }
							NOT = {
								AND = {
									is_core_of = HPC
									HPC = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							is_core_of = SUY
							SUY = {
								is_ally_with = event_target:WTT_current_china_leader
							}
							NOT = { is_core_of = event_target:WTT_communist_china }
							#has_state_flag = commie_ridden_states
						}
						SUY = { set_state_owner = PREV }
						set_state_province_controller = {
							controller = SUY
							limit = {
								has_war_together_with = SUY
							}
						}		
					}
					if = {#COMMIE MILITIA AMASSED SUPPORT
						limit = {
							is_core_of = SHX
							NOT = {
								AND = {
									is_core_of = HPC
									HPC = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							NOT = {
								AND = {
									is_core_of = PLM
									PLM = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							NOT = {
								AND = {
									is_core_of = SUY
									SUY = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							NOT = { is_core_of = event_target:WTT_communist_china }
							#has_state_flag = commie_ridden_states
						}
						SHX = { set_state_owner = PREV }
						set_state_province_controller = {
							controller = SHX
							limit = {
								has_war_together_with = SHX
							}
						}		
					}
					if = {#COMMIE MILITIA AMASSED SUPPORT
						limit = {
							NOT = { is_core_of = SHX }
							is_core_of = HPC
							HPC = {
								is_ally_with = event_target:WTT_current_china_leader
							}
							NOT = {
								AND = {
									is_core_of = PLM
									PLM = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							NOT = {
								AND = {
									is_core_of = SUY
									SUY = {
										is_ally_with = event_target:WTT_current_china_leader
									}
								}
							}
							NOT = { is_core_of = event_target:WTT_communist_china }
							#has_state_flag = commie_ridden_states
						}
						HPC = { set_state_owner = PREV }
						set_state_province_controller = {
							controller = HPC
							limit = {
								has_war_together_with = HPC
							}
						}		
					}
				}
			}
			if = { #Japan get owner of core lands
				limit = {
					OR = {
						tag = JAP
						is_subject_of = JAP
					}					
					FROM.FROM = {
						is_in_array = {
							global.small_china = This.id
						}
						any_of_scopes = {
							array = JAP.subjects
							PREV = {
								is_core_of = PREV
							}
						}
						OWNER = {
							is_literally_china = yes
							has_war_with = ROOT
						}
					}
				}
				FROM = {
					save_event_target_as = from_scope_enemy
				}
				FROM.FROM = {
					save_event_target_as = from_from_state
					for_each_scope_loop = {
						array = JAP.subjects
						if = {
							limit = {
								OR = {
									tag = ECA
									tag = MAN
									AND = {
										OR = {
											is_rrc = yes
											tag = EHB
											has_country_flag = im_jnc_now
										}
										PREV = {
											OR = {
												state = 609
												state = 608
											}
										}
									}
									AND = {
										OR = {
											is_rrc = yes
											tag = RFM
										}
										PREV = {
											OR = {
												state = 613
												state = 1015
											}
										}
									}
								}
								#NOT = { PREV = { is_owned_by = PLM }  }
								OR = { #not enemy's capital
									PREV = { is_capital = no } 
									capital_scope = { state = event_target:from_from_state }
								}
								PREV = {									
									is_core_of = PREV
								}
							}
							if = { #readd commie militia
								limit = {
									event_target:from_scope_enemy = {
										tag = event_target:WTT_communist_china
									}
								}
								set_state_flag = commie_ridden_states
							}
							set_state_owner = PREV
							PREV = {
								set_state_province_controller = {
									controller = PREV
									limit = {
										is_ally_with = PREV
									}
								}
							}
						}						
					}					
				}
			}
		}
	}
	on_uncapitulation = {
		effect = {
		}
	}
	on_startup = {
		effect = {
			CHI = {
				RCM_create_hunan_1936_oob = yes
			}
			PRC = {
				RCM_create_prc_1936_oob = yes
			}
			if = {
				limit = {
					PRC = {
						is_ai = no
					}
				}
				#GUOPRC = {
				#	load_oob = PRC_1936_free_template
				#}
			}
			if = {
				limit = {
					EGM = {
						is_ai = yes
					}
					PRC = {
						is_ai = yes
					}
				}
				EGM = {
				    add_timed_idea = {
						idea = EGM_war_weariness_for_ai days = 365
					}
				}
			}
			CHI = {
				every_core_state = {
					limit = {
                        OR = {
							state = 592
							state = 613
							#state = 608
							state = 1015
							state = 1034
						}
					}
					add_dynamic_modifier = { modifier = chi_Customs_modifier }
				}
			}
			
			1054 = {
				add_resource = {
					type = steel
					amount = 8
				}
			}
			618 = {
				add_resource = {
					type = steel
					amount = 5
				}
			}
			591 = { add_dynamic_modifier = { modifier = hainan_independent_column_modifier } }
			591 = { add_dynamic_modifier = { modifier = prc_hainan_independent_column_modifier scope = event_target:WTT_communist_china } }
			CHI = {
				#set_division_template_lock = { #remove when war breaks out
				#	division_template = "Hunan Luchün Shih"
				#	is_locked = yes
				#}
				#set_division_template_lock = {
				#	division_template = "Hunan T'iaocheng Shih"
				#	is_locked = yes
				#}
				#set_division_template_lock = {
				#	division_template = "Hunan Chengli Shih"
				#	is_locked = yes
				#}
				#set_division_template_lock = {
				#	division_template = "Hunan Tuli Lü"
				#	is_locked = yes
				#}
				#set_division_template_lock = {
				#	division_template = "Hunan Paoan T'uan"
				#	is_locked = yes
				#}
			}
		    JAP = { 
				activate_mission = JAP_form_MEN
				if = {
					limit = {
						JAP = {
							is_ai = yes
						}
					}
			        add_equipment_to_stockpile = {
                        type = infantry_equipment_1
                        amount = 26000
                    }
                    add_equipment_to_stockpile = {
                        type = artillery_equipment
                        amount = 6000
                    }
                    add_equipment_to_stockpile = {
                        type = support_equipment
                        amount = 7500
                    }
                }
            }	
		
		    JAP = { 
                if = {
					limit = {
						JAP = {
							is_ai = no
						}
					}
			        add_equipment_to_stockpile = {
                        type = infantry_equipment_1
                        amount = 10000
                    }
                    add_equipment_to_stockpile = {
                        type = artillery_equipment
                        amount = 1500
                    }
                    add_equipment_to_stockpile = {
                        type = support_equipment
                        amount = 1500
                    }
                }
            }	
			
		    SOV = { 
                if = {
					limit = {
						SOV = {
							is_ai = yes
						}
					}
                    add_ideas = balance_idea_allies_3
					#add_offsite_building = { type = industrial_complex level = 15 }
				    #add_offsite_building = { type = arms_factory level = 12 }
					random_owned_controlled_state = {
						limit = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
						}
						add_extra_state_shared_building_slots = 1
						add_building_construction = {
							type = industrial_complex
							level = 1
							instant_build = yes
						}
					}
					random_owned_controlled_state = {
						limit = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
						}
						add_extra_state_shared_building_slots = 1
						add_building_construction = {
							type = industrial_complex
							level = 1
							instant_build = yes
						}
					}
					random_owned_controlled_state = {
						limit = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
						}
						add_extra_state_shared_building_slots = 1
						add_building_construction = {
							type = industrial_complex
							level = 1
							instant_build = yes
						}
					}
					random_owned_controlled_state = {
						limit = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
						}
						add_extra_state_shared_building_slots = 1
						add_building_construction = {
							type = industrial_complex
							level = 1
							instant_build = yes
						}
					}
					random_owned_controlled_state = {
						limit = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
						}
						add_extra_state_shared_building_slots = 1
						add_building_construction = {
							type = industrial_complex
							level = 1
							instant_build = yes
						}
					}
                }
            }	
			
			PRC = { 
                if = {
					limit = {
						PRC = {
							is_ai = yes
						}
					}
			        add_stability = 0.2
                }
            }
			
			PRC = { 
                if = {
					limit = {
						is_historical_focus_on = yes
						PRC = {
							is_ai = yes
						}
					}
			        hidden_effect = {
	                    #add_ideas = {	
	                    #    prc_zhang_wentian
                        #}
                    }
                }
            }

			SHC = {
				country_event = { #jing yuexiu
					id = shc.1 days = 30 
				}
				country_event = { #give up land
					id = shc.6 days = 623 
				}
			}

            XSM = {
				country_event = { #ma bufang becomes leader
					id = qng.1 days = 128 #1936年5月10日 馬步芳代理省主席
				}
			}

			SHX = { 
                if = {
					limit = {
						SHX = {
							is_ai = yes
						}
						
					}
					add_ideas = {	
						northwest_industrial_company
					}
                }
            }
			
			CHI = { 
                if = {
					limit = {
						CHI = {
							is_ai = yes
						}
						JAP = {
							is_ai = no
						}
					}
			        add_ideas = balance_idea
                }
            }
			
			CHI = {
				country_event = { id = CHI_chiang_paili_dead.2 days = 1038 }
				country_event = { id = song_zheyuan_dead.1 days = 1549 }
			    country_event = { id = zhu_peide_dead.1 days = 412 }
				country_event = { id = hu_hanmin_dead.1 days = 131 }
			}
			
			HPC = {
				country_event = { id = song_zheyuan_dead.1 days = 1549 }
			}
			
			MON = {
				country_event = { id = gelegdorjiin_demid_dead.1 days = 599 }
			}			

			if = {
				limit = {
					has_game_rule = {
						rule = RCM_SIC_AI_BEHAVIOR
						option = SIC_LX_ALWAYS_DIE
					}
				}
			    SIC = {
                    country_event = { id = rcmchina.316 days = 749 }
			    }
			}

			every_country = {
			    add_ideas = CHI_militia_idea
			}
			
			#40 = { level_6_infra = yes }
			#654 = { level_6_infra = yes }
			for_each_scope_loop = {
				array = MAN.core_states
				set_state_flag = MAN_states
			}	
			RAJ = {
				if = {
					limit = { has_dlc = "Together for Victory" }
					
					set_variable = { RAJ_agrarian_society_value = -0.05 } #MODDED as this thing was removed in the older EYWOR versions
					add_dynamic_modifier = { modifier = RAJ_agrarian_society_dynamic }
					remove_ideas = RAJ_agrarian_society #For startup screen
				}
			}
			SPM = {
				remove_state_claim = 735
			}
			for_each_scope_loop = {
				array = FRA.core_states
				remove_core_of = OCC
			    remove_core_of = BRI
			    remove_core_of = SPM
			    remove_core_of = NAV
			}
			for_each_scope_loop = {
				array = GER.core_states
				remove_core_of = SIL
			    remove_core_of = KSH
			}
			for_each_scope_loop = {
				array = POL.core_states
				remove_core_of = KSH
			}
			for_each_scope_loop = {
				array = ROM.core_states
				remove_core_of = TRA
			}
			for_each_scope_loop = {
				array = ITA.core_states
				remove_core_of = LBV
			    remove_core_of = SPM
			    remove_core_of = TOS
			    remove_core_of = PAP
			    remove_core_of = TTS
			}
			for_each_scope_loop = {
				array = YUG.core_states
				remove_core_of = LBV
			    remove_core_of = TRA
			}
			every_country = {
			limit = {
				OR = {
					capital_scope = {
						OR = {
							is_on_continent = europe
							is_on_continent = north_america
							is_on_continent = oceania
						}
					}
					is_subject_of = ENG
					is_subject_of = HOL
					is_subject_of = FRA
					tag = FIC
				}
			}
			add_ideas = {
				generic_wartime_propagantist_europe
				generic_staunch_patriot_europe
				generic_progressive_activist_europe
				generic_revolutionary_syndicalist_europe
				generic_robber_baron_europe
			}
			set_country_flag = european_country_flag
			remove_ideas = {
				generic_wartime_propagantist_europe
				generic_staunch_patriot_europe
				generic_progressive_activist_europe
				generic_revolutionary_syndicalist_europe
				generic_robber_baron_europe
			}
		}
		every_country = {
			limit = {
				OR = {
					AND = {
						capital_scope = { is_on_continent = asia }
						is_subject = no
					}
					is_subject_of = JAP
					is_warlord = yes
					tag = HPC
					tag = GUD
					tag = XIK
					tag = SIC
					tag = EHB
					tag = ECA
					tag = RFM
					tag = MAL
					tag = SAR
					tag = PLM
					tag = NEA
					tag = SCG
					tag = NSG
				}
			}
			add_ideas = {
				generic_wartime_propagantist_asia
				generic_staunch_patriot_asia
				generic_progressive_activist_asia
				generic_revolutionary_syndicalist_asia
				generic_robber_baron_asia
			}
			set_country_flag = asian_country_flag
			remove_ideas = {
				generic_wartime_propagantist_asia
				generic_staunch_patriot_asia
				generic_progressive_activist_asia
				generic_revolutionary_syndicalist_asia
				generic_robber_baron_asia
			}
		}
		every_country = {
			limit = {
				capital_scope = { is_on_continent = middle_east }
				is_subject = no
			}
			add_ideas = {
				generic_wartime_propagantist_arab
				generic_staunch_patriot_arab
				generic_progressive_activist_arab
				generic_revolutionary_syndicalist_arab
				generic_robber_baron_arab
			}
			set_country_flag = arab_country_flag
			remove_ideas = {
				generic_wartime_propagantist_arab
				generic_staunch_patriot_arab
				generic_progressive_activist_arab
				generic_revolutionary_syndicalist_arab
				generic_robber_baron_arab
			}
		}
		every_country = {
			limit = {
				AND = {
					capital_scope = { is_on_continent = africa }
					is_subject = no
				}
			}
			add_ideas = {
				generic_wartime_propagantist_africa
				generic_staunch_patriot_africa
				generic_progressive_activist_africa
				generic_revolutionary_syndicalist_africa
				generic_robber_baron_africa
			}
			set_country_flag = africa_country_flag
			remove_ideas = {
				generic_wartime_propagantist_africa
				generic_staunch_patriot_africa
				generic_progressive_activist_africa
				generic_revolutionary_syndicalist_africa
				generic_robber_baron_africa
			}
		}
			every_country = {
				limit = {
					OR = {
						AND = {
							capital_scope = { is_on_continent = south_america }
							is_subject = no
						}
						tag = PHI
					}
				}
				add_ideas = {
					generic_wartime_propagantist_south_america
					generic_staunch_patriot_south_america
					generic_progressive_activist_south_america
					generic_revolutionary_syndicalist_south_america
					generic_robber_baron_south_america
				}
				set_country_flag = south_america_country_flag
				remove_ideas = {
					generic_wartime_propagantist_south_america
					generic_staunch_patriot_south_america
					generic_progressive_activist_south_america
					generic_revolutionary_syndicalist_south_america
					generic_robber_baron_south_america
				}
			}
						
			every_country = {
				limit = {
					is_ai = no
				}
				#country_event = RCM_difficulty.1
			    country_event = rcmgeneric.17
			}
			every_country = {
				limit = {
					is_ai = no
				}
				country_event = rcmgeneric.14 
				
			}
			#if = { #make the border wars winnable for players
			#	limit = {
			#		NXM = {
			#			is_ai = yes
			#		}
			#	}
			#	NXM = {
			#		#load_oob = NXM_1936_ai
			#	    add_ideas = spare_the_players_some_braincells
			#	}
			#}	
			if = {
				limit = {
					has_dlc = "Waking the Tiger"
				}
				set_variable = {
					global.PRC_national_focus_cost = 6.43
				}
				else = {
					set_variable = {
						global.PRC_national_focus_cost = 10
					}
				}
			}
			JAP = {
				if = {
					limit = {
						has_dlc = "Man the Guns"
						date < 1939.1.1
					}
					country_event = {
						days = 15 id = rcmjapan_leave_lnc.1
					}
				}
				else = {
					set_country_flag = okada_stronk
				}
				country_event = rcm_japan_imperial_war_conference.1
				if = {
					limit = {
						is_ai = yes			
					}
					create_import = {
						resource = oil
						factories = 5
						exporter = USA
					}
				}
			}
			CHI = {
				mark_land_connected_states = yes #yard1's super checker
			}
			every_country = {
				limit = {
					exists = yes
					NOT = {
						has_country_flag = I_have_supply_conditions
					}
				}
				add_dynamic_modifier = {
					modifier = RCM_supply_condition
				}
				set_variable = {
					This.supply_condition = 50
				}
				set_variable = {
					This.supply_condition_base = 50
				}
				set_variable = {
					This.supply_condition_weeky = 0
				}
				set_variable = {
					This.supply_condition_daily = 0
				}
				set_variable = {
					This.foreign_aid_ver_big = 0
				}
				set_variable = {
					This.foreign_aid_big = 0
				}
				set_variable = {
					This.foreign_aid_med = 0
				}
				set_variable = {
					This.foreign_aid_sml = 0
				}
				set_variable = {
					This.foreign_aid_ver_sml = 0
				}
				set_country_flag = I_have_supply_conditions
				supply_on_daily_effect = yes
			}
			every_country = {
				limit = {
					is_literally_china = yes
				}
				set_variable = {
					This.insult_cd = 30
				}
				set_variable = {
					This.insult_cost = 75
				}
			}
			CHI = {
				activate_mission = RCM_constitutionalization_pressure
				set_variable = {
					chi_constitutionalization_pressure = 30
				}
				set_variable = {
					chi_support_blue_shirts = 10
				}
				set_variable = {
					chi_support_CC = 20
				}				
			}
			every_country = { #warlord array
				limit = {
					OR = {
						tag = CHI
						is_warlord = yes
					}
				}
				set_variable = {
					This.reform_admin_cost = 50
				}
				set_variable = {
					This.reform_admin_cost_time = 30
				}				
				add_to_array = {
					global.warlord_states = THIS
				}
			}
			event_target:WTT_current_china_leader = {
				if = {
					limit = {
						has_dlc = "Waking the Tiger"
					}
					add_dynamic_modifier = {
						modifier = china_government_legitimacy
					}
				}
			}
			
			#can't use history, cause build_ic_cost doesn't work there
			JAP = {
				if = {
					limit = {
						is_ai = yes
					}
					add_to_variable = {
						This.supply_condition_base = 20
					}
				}
				
			}
			SIK = {
				add_to_variable = {
					This.supply_condition_base = 50
				}
			}
			every_state = {
				limit = {
					is_core_of = CHI
				}
				set_state_flag = china_core_state
			}
			every_state = {
				limit = {
					is_claimed_by = CHI
				}
				set_state_flag = china_claimed_state
			}
			CHI = {
				set_variable = {
					var = DAYS_OF_PROMISED_ELECTION
					value = 180
				}
				if = {
					limit = {
						date > 1937.1.1
					}
					add_ideas = {
						incompetent_heavy_industry
						iliterate_population
						no_proper_equipment_design
					}
				}
			}
			every_country = {
				limit = {
					OR = {
						is_warlord = yes
						tag = PRC
						AND = {
							tag = CHI
							date < 1937.1.1
						}
						AND = {
							OR = {
								tag = RFM
								tag = EHB
							}
							has_dlc = "Waking the Tiger"
						}
					}
				}
				add_ideas = {
					incompetent_heavy_industry
					unbalanced_industry
					iliterate_population
					no_proper_equipment_design
				}
			}
			CHI = {
				add_ideas = {
					the_blueshirts
					central_club
				}
			}
			
		    #KOR = {
            #    become_exiled_in = {
            #        target = CHI
            #        legitimacy = 90 
            #    }
            #}
			
			if = {
				limit = {
					date < 1937.1.1
				}
				#CHI = {
				#	add_ideas = {
				#		CHI_nanking_decade_idea
				#	}
				#}
			}
			every_country = {
				limit = {
					OR = {
						is_warlord = yes
						#tag = PRC
						tag = RFM
						tag = EHB
						AND = {
							tag = CHI
							date < 1937.1.1
						}
					}
					has_dlc = "Waking the Tiger"
				}
				add_ideas = {
					CHI_hyper_inflation_1
				}
			}
			every_country = {
				limit = {
					OR = {
						is_warlord = yes
						tag = PRC
						AND = {
							tag = CHI
							date > 1937.1.1
						}
					}
					OR = {
						has_war_together_with = CHI
						tag = CHI
					}
					#has_dlc = "Waking the Tiger"
				}
				add_ideas = CHI_inch_blood_1
			}
			#starting supply
			FRA = {
				subtract_from_variable = {
					var = This.supply_condition
					value = 25
				}
				subtract_from_variable = {
					var = This.supply_condition_base
					value = 25
				}
			}
			SOV = {
				add_to_variable = {
					var = This.supply_condition
					value = 20
				}
				add_to_variable = {
					var = This.supply_condition_base
					value = 20
				}
			}
			USA = {
				subtract_from_variable = {
					var = This.supply_condition
					value = 25
				}
				subtract_from_variable = {
					var = This.supply_condition_base
					value = 25
				}
			}
			ITA = { #so they don't get rekt
				add_to_variable = {
					var = This.supply_condition
					value = 20
				}
				add_to_variable = {
					var = This.supply_condition_base
					value = 20
				}
			}
			SOV = {
				add_to_variable = {
					var = This.supply_condition
					value = 15
				}
				add_to_variable = {
					var = This.supply_condition_base
					value = 15
				}
			}
			SOV = {
				if = {
				    limit = {
					    SOV = { is_ai = yes }
					}
				    add_to_variable = {
					    var = This.supply_condition
					    value = 50 #MODDED
				     }
				    add_to_variable = {
					    var = This.supply_condition_base
					    value = 50 #MODDED
				    }
			    }
			}
			GER = {
				add_to_variable = {
					var = This.supply_condition
					value = 15 #MODDED
				}
				add_to_variable = {
					var = This.supply_condition_base
					value = 15 #MODDED
				}
			}
			GER = {
				if = {
				    limit = {
					    GER = { is_ai = yes }
					}
				    add_to_variable = {
					    var = This.supply_condition
					    value = 500 #MODDED
				     }
				    add_to_variable = {
					    var = This.supply_condition_base
					    value = 500 #MODDED
				    }
			    }
			}
			PRC = {
				add_to_variable = {
					This.supply_condition_base = 20
				}
				add_to_variable = {
					This.supply_condition = 20
				}
			}
			if = {
				limit = {
					any_country = {
						is_literally_china = yes
						NOT = {
							OR = {
								tag = CHI
								tag = MAN
								is_puppet_of = JAP
							}
						}
						is_ai = no
					}
					CHI = {
						is_ai = yes
					}
				}
				CHI = { #so they don't get rekt
					add_to_variable = {
						var = This.supply_condition
						value = 20
					}
					add_to_variable = {
						var = This.supply_condition_base
						value = 20
					}
				}
			}
		}
	}
	on_daily = {
		effect = {			
			for_each_scope_loop = {
				array = global.AI_difficulty_enemy_spawn
				if = {
					limit = {
						OR = {
							is_ai = no
							any_of_scopes = {
								array = faction_members
								has_war_together_with = ROOT
								is_ai = no
							}
						}
					}
					delete_unit_template_and_units = { division_template = "Reserve Infantry Division" }
					delete_unit_template_and_units = { division_template = "Reserve Light Tank Division" }
					delete_unit_template_and_units = { division_template = "Reserve Medium Tank Division" }
					delete_unit_template_and_units = { division_template = "Reserve Modern Tank Division" }
					remove_from_array = { global.AI_difficulty_enemy_spawn = THIS }
				}
			}
			if = {
				limit = {
					country_exists = MAN
				}
				if = { #fixes weird bug where Man would control state on map but MEN control in game
					limit = {
						1014 = {
							controller = {
								is_ally_with = MAN
							}
						}
						MAN = {
							NOT = {
								owns_state = 1014
							}
							NOT = {
								controls_state = 1014
							}
							controls_province = 4525
						}

					}
					1014 = {
						CONTROLLER = {
							set_temp_variable = {
								global.controller_of_state = THIS
							}
						}
						set_state_province_controller = {
							controller = var:global.controller_of_state
							limit = {
								is_ally_with = var:global.controller_of_state
							}
						}
					}
				}
			}
			#for_each_scope_loop = {
			#	array = global.states_for_liberation
			#	if = {
			#		limit = {
			#			OWNER = {
			#				tag = event_target:WTT_communist_china
			#				has_war_together_with = CONTROLLER
			#				is_in_faction_with = CONTROLLER
			#			}
			#		}
			#		set_state_province_controller = {
			#			controller = event_target:WTT_communist_china
			#			limit = {
			#				has_war_together_with = event_target:WTT_communist_china
			#				is_in_faction_with = event_target:WTT_communist_china
			#			}
			#		}
			#	}
			#}
			if = {
				limit = {
					tag = JAP
					has_completed_focus = JAP_fund_the_unitarian_church_focus
				}
				JAP = {
					set_temp_variable = {
        			    total_current_christian_acceptance = 0
        			}
					set_temp_variable = {
						total_christian_state_pop = 0
					}
					for_each_scope_loop = {
						array = JAP.core_states
						if = {
							limit = {
								is_not_irrelevant_states = yes
								is_owned_and_controlled_by = ROOT
							}
							if = {
								limit = {
									JAP = {
										NOT = {
											any_owned_state = {
												has_state_flag = This_state_has_backlash
											}
										}
										has_country_flag = constitional_religious_freedom
										has_country_flag = persecution_banned
									}
								}
								clamp_variable = {
    							    var = This.Local_christian_acceptance
    							    min = 0
    							    max = 100
    							}
							}
							else_if = {
								limit = {
									JAP = {
										NOT = {
											any_owned_state = {
												has_state_flag = This_state_has_backlash
											}
										}
										has_country_flag = persecution_banned
									}
								}
								clamp_variable = {
    							    var = This.Local_christian_acceptance
    							    min = 0
    							    max = 60
    							}
							}	
							else = {
								clamp_variable = {
    							    var = This.Local_christian_acceptance
    							    min = 0
    							    max = 40
    							}
							}
							set_variable = {
           					    This.state_population_christian_M = This.state_population_k
           					}
           					divide_variable = {
           					    This.state_population_christian_M = 1000
           					}
							set_variable = {
								This.weighted_christian_acceptance = This.Local_christian_acceptance
							}
							multiply_variable = {
								This.weighted_christian_acceptance = This.state_population_christian_M
							}
							add_to_temp_variable = {
								total_christian_state_pop = This.state_population_christian_M
							}
							add_to_temp_variable = {
								total_current_christian_acceptance = This.weighted_christian_acceptance
							}					
						}
					}
					divide_temp_variable = {
						total_current_christian_acceptance = total_christian_state_pop
					}
					#advisor boosts
					#set_variable = {
					#	JAP.christian_boost = 0
					#}
					if = {
						limit = { #low
							NOT = { the_overall_cap_is_reached = yes }
							NOT = { has_idea = suzuki_bunji }
							NOT = { has_idea = katayama_testu }
						}
						set_variable = {
							This.christian_boost = 0.1
						}
					}
					else_if = {
						limit = {
							NOT = { the_overall_cap_is_reached = yes }
							OR = { #mid
								has_idea = suzuki_bunji
								has_idea = katayama_testu
							}
							NOT = {
								AND = { #high
									has_idea = suzuki_bunji
									has_idea = katayama_testu
								}
							}
						}
						set_variable = {
							This.christian_boost = 0.2
						}
					}
					else_if = {
						limit = {
							NOT = { the_overall_cap_is_reached = yes }
							AND = { #high
								has_idea = suzuki_bunji
								has_idea = katayama_testu
							}
						}
						set_variable = {
							This.christian_boost = 0.3
						}
					}
					else_if = {
						limit = {
							the_overall_cap_is_reached = yes
						}
						set_variable = {
							This.christian_boost = 0
						}
					}
					divide_variable = {
						This.christian_boost = 7
					}
					add_to_variable = {
						This.total_christian_boost = This.christian_boost
					}
					set_variable = {
						Root.current_christian_acceptance = total_current_christian_acceptance
					}
					add_to_variable = {
						Root.current_christian_acceptance = This.total_christian_boost
					}

				}
			}
			
			if = {#GUO #weiguo
				limit = {
					tag = SOV
					surrender_progress > This.surrender_progress_max
					surrender_progress < 0.50#GUO
				}
				set_variable = {
					This.surrender_progress_max = This.surrender_progress
				}
				set_variable = {
					This.half_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.half_surrender_progress = 0.5
				}
				set_variable = {
					This.three_fourth_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.three_fourth_surrender_progress = 0.75
				}
				set_variable = {
					This.one_fourth_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.one_fourth_surrender_progress = 0.25
				}
				
				set_variable = { #guo
					This.neg_one_fourth_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.neg_one_fourth_surrender_progress = -0.25
				}
				
				set_variable = { #guo
					This.three_tenth_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.three_tenth_surrender_progress = 0.3
				}
				
				set_variable = { #guo
					This.same_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.same_surrender_progress = 1
				}
				
				set_variable = { #guo
					This.neg_same_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.neg_same_surrender_progress = -1
				}
				
				set_variable = { #guo
					This.neg_two_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.neg_two_surrender_progress = -2
				}
				
				set_variable = { #guo
					This.two_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.two_surrender_progress = 2
				}
				
				set_variable = {
					This.neg_half_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.neg_half_surrender_progress = -0.5
				}
				set_variable = {
					This.one_tenth_surrender_progress = This.surrender_progress
				}
				multiply_variable = {
					This.one_tenth_surrender_progress = 0.1
				}
			}
			
			supply_on_daily_effect = yes
			set_variable = {
				This.infantry_equipment_deficit = This.num_target_equipment_in_armies@infantry_equipment
			}
			subtract_from_variable = {
				This.infantry_equipment_deficit = This.num_equipment_in_armies@infantry_equipment
			}
			set_variable = {
				This.infantry_equipment_fill_ratio = This.num_equipment_in_armies@infantry_equipment
			}
			divide_variable = {
				This.infantry_equipment_fill_ratio = This.num_target_equipment_in_armies@infantry_equipment
			}
			set_variable = { This.cons_infra_ratio = this.RCM_army_supply_consumption }
			divide_variable = { This.cons_infra_ratio = this.total_infra }
			################
			TAN = { #change color when no commie
				if = {
					limit = {
						has_country_flag = im_original_color_now
						has_government = communism
					}
					clr_country_flag = im_original_color_now
					set_cosmetic_tag = TAN_RED
				}
				else_if = {
					limit = {
						NOT = {
							has_country_flag = im_original_color_now
						}
						NOT = {
							has_government = communism
						}
					}
					drop_cosmetic_tag = yes
					set_country_flag = im_original_color_now
				}
			}
			MON = {
				if = {
					limit = {
						has_country_flag = im_original_color_now
						has_government = communism
					}
					clr_country_flag = im_original_color_now
					set_cosmetic_tag = MON_RED
				}
				else_if = {
					limit = {
						NOT = {
							has_country_flag = im_original_color_now
						}
						NOT = {
							has_government = communism
						}
					}
					drop_cosmetic_tag = yes
					set_country_flag = im_original_color_now
				}
			}
			set_variable = {
				chi_constitutionalization_pressure_divided_by_10 = chi_constitutionalization_pressure
			}
			divide_variable = {
				chi_constitutionalization_pressure_divided_by_10 = 10
			} 
			if = {
				limit = {
					check_variable = {
						chi_constitutionalization_pressure < 0
					}
				}
				set_variable = {
					chi_constitutionalization_pressure = 0
				}
			}
			if = {
				limit = {
					check_variable = {
						chi_support_blue_shirts < 0
					}
				}
				set_variable = {
					chi_support_blue_shirts = 0
				}
			}
			if = {
				limit = {
					check_variable = {
						chi_support_CC < 0
					}
				}
				set_variable = {
					chi_support_CC = 0
				}
			}
			#legitimacy			
			if = {
				limit = {
					any_of_scopes = {
						array = global.warlord_states
						NOT = {
							tag = event_target:WTT_current_china_leader
						}
						has_country_flag = wtt_political_struggle
					}
				}
				multiply_variable = {
					global.base_struggle_support = 0
				}
				set_variable = {
					global.base_struggle_support = 0
				}
				for_each_scope_loop = {
					array = global.warlord_states
					if = {
						limit = {
							is_literally_china = yes
							OR = {
								has_completed_focus = CHI_join_the_republican_government
								has_country_flag = wtt_political_struggle
								tag = event_target:WTT_current_china_leader
							}
						}
						add_to_variable = {
							global.base_struggle_support = this.total_political_support_points
						}
					}
				}
				#event_target:WTT_current_china_leader = {
				#	every_country = {
				#		limit = {
				#			is_literally_china = yes
				#			OR = {
				#				has_completed_focus = CHI_join_the_republican_government
				#				has_country_flag = wtt_political_struggle
				#				tag = event_target:WTT_current_china_leader
				#			}
				#		}
				#		add_to_variable = {
				#			global.base_struggle_support = this.total_political_support_points
				#		}
				#	}
				#}
				##for_each_scope_loop = {
				#	array = global.warlord_states
				#	THIS = {
				#		if = {
				#			
				#		}
				#	}
				#}
				clr_global_flag = no_wtt_power_struggle
				else = {
					set_global_flag = no_wtt_power_struggle
					if = { #if only new china has power struggle
						limit = {
							event_target:WTT_current_china_leader = {
								has_country_flag = wtt_political_struggle
							}
						}
						event_target:WTT_current_china_leader = {
							clr_country_flag = wtt_political_struggle
						}
					}
					set_variable = {
						global.base_legitimacy_score = 0.1
					}
				}
			}
			event_target:WTT_current_china_leader = {				
				if = {
					limit = {
						NOT = {
							has_global_flag = no_wtt_power_struggle
						}
					}					
					set_variable = {
						global.base_legitimacy_score = This.total_political_support_points
					}
					divide_variable = {
						global.base_struggle_support = 1
					}
					divide_variable = {
						global.base_legitimacy_score = global.base_struggle_support
					}
					subtract_from_variable = {
						global.base_legitimacy_score = 0.5
					}
					divide_variable = {
						global.base_legitimacy_score = 5
					}
					if = {
						limit = {
							check_variable = { global.base_legitimacy_score < 0 }
						}
						multiply_variable = {
							global.base_legitimacy_score = 2
						}
					}					
				}									
				set_variable = {
					This.PP_legitimacy = global.base_legitimacy_score
				}
				set_variable = {
					This.Stability_legitimacy = global.base_legitimacy_score
				}
				set_variable = {
					This.war_support_legitimacy = global.base_legitimacy_score
				}
			}
			#commie_ridden_states
			if = {
				limit = {
					any_of_scopes = {
						array = global.big_china
						OR = {
							is_north_china_state_for_liberation = yes
							is_MAN_state_for_liberation = yes
						}
						has_state_flag = commie_ridden_states
						NOT = {
							has_state_flag = i_cracked_down_you
						}
					}
				}
				for_each_scope_loop = {
					array = global.big_china
					THIS = {
						if = {
							limit = {
								OR = {
									is_north_china_state_for_liberation = yes
									is_MAN_state_for_liberation = yes
								}
								has_state_flag = commie_ridden_states
								OR = {
									controller = {
										NOT = {
											OR = {
												tag = PRC
												has_government = communism
												#has_government = n_socialism
											}
										}
									}
									owner = {
										NOT = {
											OR = {
												tag = PRC
												has_government = communism
												#has_government = n_socialism
											}
										}
									}
								}
							}
							set_border_war = yes
						}
						if = {
							limit = {
								is_border_conflict = yes
								has_state_flag = commie_ridden_states
								OR = {
									NOT = {
										OR = {
											OR = {
												is_north_china_state_for_liberation = yes
												is_MAN_state_for_liberation = yes
											}
											has_state_flag = commie_ridden_states
										}
									}
									controller = {
										#has_full_control_of_state = PREV
										OR = {
											tag = PRC
											has_government = communism
											#has_government = n_socialism
										}
									}
									owner = {
										OR = {
											tag = PRC
											has_government = communism
											#has_government = n_socialism
										}
									}
								}
							}
							clr_state_flag = commie_ridden_states
							set_border_war = no
						}
					}
				}
			}
			
			if = {
				limit = {
					date > 1937.1.1
					OR = {
						has_template = "Hunan Luchün Shih"
						has_template = "Hunan Luchün Shih 2"
						has_template = "Hunan Tuli Lü"
						has_template = "Hunan Tuli Lü 2"
					}
					always = no ###no locked templates anymore for chi
				}
				if = {
					limit = {
						has_template = "Hunan Luchün Shih"
					}
					set_division_template_lock = {
						division_template = "Hunan Luchün Shih"
						is_locked = no
					}
				}
				if = {
					limit = {
						has_template = "Hunan Luchün Shih 2"
					}
					set_division_template_lock = {
						division_template = "Hunan Luchün Shih 2"
						is_locked = no
					}
				}
				if = {
					limit = {
						has_template = "Hunan Tuli Lü"
					}
					set_division_template_lock = {
						division_template = "Hunan Tuli Lü"
						is_locked = no
					}
				}
				if = {
					limit = {
						has_template = "Hunan Tuli Lü 2"
					}
					set_division_template_lock = {
						division_template = "Hunan Tuli Lü 2"
						is_locked = no
					}
				}
			}

			if = {
				limit = {
					NOT = {
						OR = {
							original_tag = JAP
							tag = ECA
					        is_ally_with = JAP
						}
					}
					any_controlled_state = {
						has_state_flag = JAP_chumogun_flag
					}
				}
				random_controlled_state = {
					limit = {
						has_state_flag = JAP_chumogun_flag
					}
					clr_state_flag = JAP_chumogun_flag
					remove_dynamic_modifier = { modifier = JAP_chumogun scope = ECA }
					remove_dynamic_modifier = { modifier = JAP_chumogun scope = JAP }
					remove_dynamic_modifier = { modifier = JAP_chumogun_ehb scope = EHB }
					remove_dynamic_modifier = { modifier = JAP_chumogun_man scope = MAN }
				}		
			}

            if = { #
				limit = {
					tag = event_target:scp_war_opposition_leader
					NOT = {
						is_ally_with = event_target:WTT_current_china_leader
					}
					is_in_faction = yes
					is_faction_leader = no
				}
				clear_global_event_target = scp_war_opposition_leader
				random_other_country = {
					limit = {
						NOT = {
							tag = event_target:WTT_communist_china
						}
						is_ally_with = ROOT
						is_faction_leader = yes
						NOT = {
							tag = event_target:WTT_current_china_leader
							tag = event_target:scp_war_opposition_leader
						}
					}
				    save_global_event_target_as = scp_war_opposition_leader 
				}
			}

			#################
			1030 = {
				if = {
					limit = {
						has_state_flag = I_choose_this_state_to_DMZ
						NEA = {
							is_neighbor_of = PRC
						}
						NOT = {
							is_demilitarized_zone = yes
						}
					}
					set_demilitarized_zone = yes
				}
			}
			1030 = {
				if = {
					limit = {
						is_demilitarized_zone = yes
						OR = {
							NOT = {
								country_exists = PRC
							}
							NOT = {
								country_exists = NEA
							}
							NOT = {
								NEA = {
									is_neighbor_of = PRC
								}
							}
							NOT = {
								has_state_flag = I_choose_this_state_to_DMZ
							}
							has_global_flag = no_point_to_have_tacit_truce
						}
					}
					set_demilitarized_zone = no
				}
			}
			
			if = {
				limit = {
					NOT = {
						has_global_flag = no_shanghai_DMZ
					}
				}
				613 = { set_demilitarized_zone = yes }
			}
			else_if = {
				limit = {
					613 = { is_demilitarized_zone = yes }
				}
				613 = { set_demilitarized_zone = no }
			}
			
			#=====================
			1053 = {
				if = {
					limit = {
						has_state_flag = I_choose_this_state_to_DMZ
						NEA = {
							is_neighbor_of = PRC
						}
						NOT = {
							is_demilitarized_zone = yes
						}
					}
					set_demilitarized_zone = yes
				}
			}
			1053 = {
				if = {
					limit = {
						is_demilitarized_zone = yes
						OR = {
							NOT = {
								country_exists = PRC
							}
							NOT = {
								country_exists = NEA
							}
							NOT = {
								NEA = {
									is_neighbor_of = PRC
								}
							}
							NOT = {
								country_exists = PRC
							}
							NOT = {
								has_state_flag = I_choose_this_state_to_DMZ
							}
							has_global_flag = no_point_to_have_tacit_truce
						}
					}
					set_demilitarized_zone = no
				}
			}
		}
	}
	#ROOT is winner #FROM gets annexed - This will also fire on_annex
	on_civil_war_end = {
		effect = {
			#end of proxy wars
			if = {
				limit = {
					is_puppet = yes
					OVERLORD = {
						has_country_flag = peace_on_war_ends_flag
					}
					FROM = {
						is_puppet = yes
						OVERLORD = {
							has_country_flag = peace_on_war_ends_flag
						}
					}
				}
				FROM = {
					OVERLORD = {
						save_event_target_as = loser_overlord
					}
				}
				OVERLORD = {
					every_other_country = {
						limit = {
							is_in_faction_with = PREV
							has_war_with = loser_overlord
						}
						white_peace = event_target:loser_overlord
					}
					white_peace = event_target:loser_overlord
				}
			}
			
			#in case of strikes
			if = {
				limit = {
					NOT = {
						AND = {
							tag = event_target:CPC_JAP_puppet
							NOT = { has_global_flag = CHI_JAP_COMM_yes }
						}
					}
					original_tag = CHI
					has_government = communism
				}
				if = {
					limit = {
						event_target:WTT_communist_china = {
							exists = yes
						}
					}
					event_target:WTT_communist_china = {
						annex_country = {
							target = ROOT transfer_troops = yes
						}
					}
					else = {
						if = {
							limit = {
								NOT = { tag = event_target:CPC_JAP_puppet }
							}
							set_cosmetic_tag = PRC_PRC
						}
					}
				}
			}
			if = { #clear core
				limit = {
					FROM = {
						OR = {
							is_literally_china = yes
							is_warlord = yes
							tag = RFM
							tag = ECA
							tag = MAN
							tag = PLM
							tag = EHB
							tag = CCP
							tag = NSG
							tag = SCG
						}
					}
				}
				country_event = clique.1
			}
			clr_country_flag = im_civ_war_exception
			if = {
				limit = {
					tag = event_target:KMT_CC_clique
				}
				set_cosmetic_tag = CHI
				FROM = {
					clr_country_flag = im_civ_war_exception
				}
				event_target:WTT_current_china_leader = {
					if = {	limit = { NOT = { tag = ROOT } }
						set_variable = { global.previous_china_leader = THIS }
					}
				}
				clear_global_event_target = WTT_current_china_leader				
				save_global_event_target_as = WTT_current_china_leader
				if = {
					limit = {
						has_dlc = "Waking the Tiger"
					}
					add_dynamic_modifier = {
						modifier = china_government_legitimacy
					}
				}
			}
			#move cap sik
			if = {
				limit = {
					original_tag = SIK
					NOT = {
						617 = {
							is_capital = yes
						}
					}
				}
			    set_capital = { state = 617 }
			}
			if = {
				limit = {
					original_tag = MAN
					NOT = {
						328 = {
							is_capital = yes
						}
					}
					NOT = {
						608 = {
							is_capital = yes
						}
					}
				}
			    set_capital = { state = 328 }
			}
		}
	}

	#FROM leader ROOT the one leaves
	on_leave_faction = {
		effect = {
			if = {
				limit = {
					tag = event_target:RCM_japan_friendly_china
					OR = {
						has_global_flag = CHI_accept_san_hiro
						has_global_flag = revise_hiro_san_success
					}
					JAP = {
						tag = FROM
					}
				}
				FROM = {
					country_event = rcmchina.286
				}
			}
		}
	}

	on_weekly = {
		effect = {
			if = {
				limit = {
					NOT = {
						has_global_flag = burma_road_closed_flag
					}
					has_global_flag = burma_road_done_flag
					has_country_flag = chi_eng_agreed_burma_road_flag
					OR = {
						325 = {
                            controller = {
								has_war_with = ROOT
							}
						}
						747 = {
                            controller = {
								has_war_with = ROOT
							}
						}
						992 = {
                            controller = {
								has_war_with = ROOT
							}
						}
					}
				}
				set_global_flag = burma_road_closed_flag
				country_event = { id = wtt_burma_road.2 }
			}
			if = {
				limit = {
					tag = SUY
					is_in_faction_with = event_target:WTT_current_china_leader
					any_core_state = {
						OR = {
							state = 1020
							state = 1014
							state = 621
							state = 1019
							state = 746
						}
						OR = {
							controller = {
								NOT = {
									tag = SUY
								}
								is_in_faction_with = SUY
							}
							owner = {
								NOT = {
									tag = SUY
								}
								is_in_faction_with = SUY
							}
						}
					}
				}
				SUY = {
					every_core_state = {
						limit = {
							OR = {
								state = 1020
								state = 1014
								state = 621
								state = 1019
								state = 746
							}
							OR = {
								controller = {
									NOT = {
										tag = SUY
									}
									is_in_faction_with = SUY
								}
								owner = {
									NOT = {
										tag = SUY
									}
									is_in_faction_with = SUY
								}
							}
						}
					    if = {
							limit = {
								owner = {
									is_in_faction_with = SUY
								}
								NOT = {
									is_controlled_by = owner
								}
							}
							set_state_owner_to = SUY
						}
					    else_if = {
							limit = {
								controller = {
									is_in_faction_with = SUY
								}
								owner = {
									is_ally_with = JAP
								}
							}
							transfer_state_to = SUY
						}
						else_if = {
							limit = {
								is_owned_and_controlled_by = owner
							}
							transfer_state_to = SUY
						}
					}
				}
			}
		}
	}

	on_monthly = {
		effect = {
			if = {
				limit = {
					event_target:WTT_current_china_leader = {
						any_core_state = {
							OR = {
								has_state_flag = im_mr1_state_flag
								has_state_flag = im_mr2_state_flag
								has_state_flag = im_mr3_state_flag
								has_state_flag = im_mr4_state_flag
								has_state_flag = im_mr5_state_flag
								has_state_flag = im_mr6_state_flag
								has_state_flag = im_mr7_state_flag
								has_state_flag = im_mr8_state_flag
								has_state_flag = im_mr9_state_flag
								has_state_flag = im_mr10_state_flag
							}
							NOT = {
								any_neighbor_state = {
									controller = {
										is_literally_china = yes
										has_war_with = JAP
									}
								}
							}	
						}
					}
				}
				event_target:WTT_current_china_leader = {
					every_core_state = {
						limit = {
							OR = {
								has_state_flag = im_mr1_state_flag
								has_state_flag = im_mr2_state_flag
								has_state_flag = im_mr3_state_flag
								has_state_flag = im_mr4_state_flag
								has_state_flag = im_mr5_state_flag
								has_state_flag = im_mr6_state_flag
								has_state_flag = im_mr7_state_flag
								has_state_flag = im_mr8_state_flag
								has_state_flag = im_mr9_state_flag
								has_state_flag = im_mr10_state_flag
							}
							NOT = {
								any_neighbor_state = {
									controller = {
										OR = {
											has_government = democratic
											has_government = neutrality
											has_government = fascism
											has_government = n_socialism
										}
										is_literally_china = yes
										has_war_with = JAP
									}
								}
							}	
						}
						remove_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_2_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_3_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_4_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_5_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_6_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_7_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_8_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_9_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_10_modifier scope = PREV }
						owner = {
							every_owned_state = {
								limit = {
									OR = {
										has_state_flag = im_mr1_state_flag
										has_state_flag = im_mr2_state_flag
										has_state_flag = im_mr3_state_flag
										has_state_flag = im_mr4_state_flag
										has_state_flag = im_mr5_state_flag
										has_state_flag = im_mr6_state_flag
										has_state_flag = im_mr7_state_flag
										has_state_flag = im_mr8_state_flag
										has_state_flag = im_mr9_state_flag
										has_state_flag = im_mr10_state_flag
									}
									NOT = {
										any_neighbor_state = {
											controller = {
												is_literally_china = yes
												has_war_with = JAP
											}
										}
									}	
								}
								if = {
									limit = {
										has_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
									}
									remove_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
								}
								if = {
									limit = {
										has_dynamic_modifier = { modifier = military_region_2_modifier scope = PREV }
									}
									remove_dynamic_modifier = { modifier = military_region_2_modifier scope = PREV }
								}
								if = {
									limit = {
										has_dynamic_modifier = { modifier = military_region_3_modifier scope = PREV }
									}
									remove_dynamic_modifier = { modifier = military_region_3_modifier scope = PREV }
								}
								if = {
									limit = {
										has_dynamic_modifier = { modifier = military_region_4_modifier scope = PREV }
									}
									remove_dynamic_modifier = { modifier = military_region_4_modifier scope = PREV }
								}
								if = {
									limit = {
										has_dynamic_modifier = { modifier = military_region_5_modifier scope = PREV }
									}
									remove_dynamic_modifier = { modifier = military_region_5_modifier scope = PREV }
								}
								if = {
									limit = {
										has_dynamic_modifier = { modifier = military_region_6_modifier scope = PREV }
									}
									remove_dynamic_modifier = { modifier = military_region_6_modifier scope = PREV }
								}
								if = {
									limit = {
										has_dynamic_modifier = { modifier = military_region_7_modifier scope = PREV }
									}
									remove_dynamic_modifier = { modifier = military_region_7_modifier scope = PREV }
								}
								if = {
									limit = {
										has_dynamic_modifier = { modifier = military_region_8_modifier scope = PREV }
									}
									remove_dynamic_modifier = { modifier = military_region_8_modifier scope = PREV }
								}
								if = {
									limit = {
										has_dynamic_modifier = { modifier = military_region_9_modifier scope = PREV }
									}
									remove_dynamic_modifier = { modifier = military_region_9_modifier scope = PREV }
								}
								if = {
									limit = {
										has_dynamic_modifier = { modifier = military_region_10_modifier scope = PREV }
									}
									remove_dynamic_modifier = { modifier = military_region_10_modifier scope = PREV }
								}
								clr_state_flag = im_mr1_state_flag
								clr_state_flag = im_mr2_state_flag
								clr_state_flag = im_mr3_state_flag
								clr_state_flag = im_mr4_state_flag
								clr_state_flag = im_mr5_state_flag
								clr_state_flag = im_mr6_state_flag
								clr_state_flag = im_mr7_state_flag
								clr_state_flag = im_mr8_state_flag
								clr_state_flag = im_mr9_state_flag
								clr_state_flag = im_mr10_state_flag
							}
						}
					}
				}
			}
			if = {
				limit = {
					event_target:WTT_current_china_leader = {
						any_core_state = {
							OR = {
								has_state_flag = im_mr1_state_flag
								has_state_flag = im_mr2_state_flag
								has_state_flag = im_mr3_state_flag
								has_state_flag = im_mr4_state_flag
								has_state_flag = im_mr5_state_flag
								has_state_flag = im_mr6_state_flag
								has_state_flag = im_mr7_state_flag
								has_state_flag = im_mr8_state_flag
								has_state_flag = im_mr9_state_flag
								has_state_flag = im_mr10_state_flag
							}
							is_owned_by = event_target:WTT_communist_china
						}
					}
				}
				event_target:WTT_current_china_leader = {
					every_core_state = {
						limit = {
							OR = {
								has_state_flag = im_mr1_state_flag
								has_state_flag = im_mr2_state_flag
								has_state_flag = im_mr3_state_flag
								has_state_flag = im_mr4_state_flag
								has_state_flag = im_mr5_state_flag
								has_state_flag = im_mr6_state_flag
								has_state_flag = im_mr7_state_flag
								has_state_flag = im_mr8_state_flag
								has_state_flag = im_mr9_state_flag
								has_state_flag = im_mr10_state_flag
							}
							OR = {
								is_owned_by = event_target:WTT_communist_china
								is_controlled_by = event_target:WTT_communist_china
							}
						}
						clr_state_flag = im_mr1_state_flag
						clr_state_flag = im_mr2_state_flag
						clr_state_flag = im_mr3_state_flag
						clr_state_flag = im_mr4_state_flag
						clr_state_flag = im_mr5_state_flag
						clr_state_flag = im_mr6_state_flag
						clr_state_flag = im_mr7_state_flag
						clr_state_flag = im_mr8_state_flag
						clr_state_flag = im_mr9_state_flag
						clr_state_flag = im_mr10_state_flag
						remove_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_2_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_3_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_4_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_5_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_6_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_7_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_8_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_9_modifier scope = PREV }
						remove_dynamic_modifier = { modifier = military_region_10_modifier scope = PREV }
						random_other_country = {
							for_each_scope_loop = {
								array = global.small_china
								if = {
									limit = {
										OR = {
											has_state_flag = im_mr1_state_flag
											has_state_flag = im_mr2_state_flag
											has_state_flag = im_mr3_state_flag
											has_state_flag = im_mr4_state_flag
											has_state_flag = im_mr5_state_flag
											has_state_flag = im_mr6_state_flag
											has_state_flag = im_mr7_state_flag
											has_state_flag = im_mr8_state_flag
											has_state_flag = im_mr9_state_flag
											has_state_flag = im_mr10_state_flag
										}
										OR = {
											is_owned_by = event_target:WTT_communist_china
											is_controlled_by = event_target:WTT_communist_china
										}
									}
									remove_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
									remove_dynamic_modifier = { modifier = military_region_2_modifier scope = PREV }
									remove_dynamic_modifier = { modifier = military_region_3_modifier scope = PREV }
									remove_dynamic_modifier = { modifier = military_region_4_modifier scope = PREV }
									remove_dynamic_modifier = { modifier = military_region_5_modifier scope = PREV }
									remove_dynamic_modifier = { modifier = military_region_6_modifier scope = PREV }
									remove_dynamic_modifier = { modifier = military_region_7_modifier scope = PREV }
									remove_dynamic_modifier = { modifier = military_region_8_modifier scope = PREV }
									remove_dynamic_modifier = { modifier = military_region_9_modifier scope = PREV }
									remove_dynamic_modifier = { modifier = military_region_10_modifier scope = PREV }
									clr_state_flag = im_mr1_state_flag
									clr_state_flag = im_mr2_state_flag
									clr_state_flag = im_mr3_state_flag
									clr_state_flag = im_mr4_state_flag
									clr_state_flag = im_mr5_state_flag
									clr_state_flag = im_mr6_state_flag
									clr_state_flag = im_mr7_state_flag
									clr_state_flag = im_mr8_state_flag
									clr_state_flag = im_mr9_state_flag
									clr_state_flag = im_mr10_state_flag			
								}						
							}	
						}
					}
				}
			}

			if = {
				limit = {
					event_target:WTT_current_china_leader = {
						has_war_with = JAP
						any_core_state = {
							NOT = {
                                OR = {
									has_state_flag = im_mr1_state_flag
									has_state_flag = im_mr2_state_flag
									has_state_flag = im_mr3_state_flag
									has_state_flag = im_mr4_state_flag
									has_state_flag = im_mr5_state_flag
									has_state_flag = im_mr6_state_flag
									has_state_flag = im_mr7_state_flag
									has_state_flag = im_mr8_state_flag
									has_state_flag = im_mr9_state_flag
									has_state_flag = im_mr10_state_flag
								}
							}
							OR = {
								AND = {
									has_global_flag = mr_1_adjusted_flag
									is_mr1_state_2 = yes
								}
								is_mr1_state = yes
								is_mr2_state = yes
								is_mr3_state = yes
								is_mr4_state = yes
								is_mr5_state = yes
								is_mr6_state = yes
								is_mr7_state = yes
								is_mr8_state = yes
								is_mr9_state = yes
								is_mr10_state = yes
							}	
							controller = {
								is_literally_china = yes
								has_war_with = JAP
								NOT = {
									has_government = communism
									has_war_with = event_target:WTT_current_china_leader
								}
							}
						}
					}
				}
				event_target:WTT_current_china_leader = {
					every_core_state = {
						limit = {
							NOT = {
                                OR = {
									has_state_flag = im_mr1_state_flag
									has_state_flag = im_mr2_state_flag
									has_state_flag = im_mr3_state_flag
									has_state_flag = im_mr4_state_flag
									has_state_flag = im_mr5_state_flag
									has_state_flag = im_mr6_state_flag
									has_state_flag = im_mr7_state_flag
									has_state_flag = im_mr8_state_flag
									has_state_flag = im_mr9_state_flag
									has_state_flag = im_mr10_state_flag
								}
							}
							OR = {
								AND = {
									has_global_flag = mr_1_adjusted_flag
									is_mr1_state_2 = yes
								}
								is_mr1_state = yes
								is_mr2_state = yes
								is_mr3_state = yes
								is_mr4_state = yes
								is_mr5_state = yes
								AND = {
									has_global_flag = mr_6_established_flag
									is_mr6_state = yes
								}
								AND = {
									has_global_flag = mr_7_established_flag
									is_mr7_state = yes
								}
								AND = {
									has_global_flag = mr_8_established_flag
									is_mr8_state = yes
								}
								AND = {
									has_global_flag = mr_9_established_flag
									is_mr9_state = yes
								}
								AND = {
									has_global_flag = mr_10_established_flag
									is_mr10_state = yes
								}
							}	
							controller = {
								is_literally_china = yes
								has_war_with = JAP
								NOT = {
									has_government = communism
									has_war_with = event_target:WTT_current_china_leader
								}
							}
						}
						if = {
							limit = {
								is_mr1_state = yes
							}
							set_state_flag = im_mr1_state_flag
							add_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr1_state = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
								}
							}
						}
						else_if = {
							limit = {
								has_global_flag = mr_1_adjusted_flag
								is_mr1_state_2 = yes
							}
							set_state_flag = im_mr1_state_flag
							add_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr1_state_2 = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_1_modifier scope = PREV }
								}
							}
						}
						else_if = {
							limit = {
								is_mr2_state = yes
							}
							set_state_flag = im_mr2_state_flag
							add_dynamic_modifier = { modifier = military_region_2_modifier scope = PREV }
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr2_state = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_2_modifier scope = PREV }
								}
							}
						}
						else_if = {
							limit = {
								is_mr3_state = yes
							}
							set_state_flag = im_mr3_state_flag
							add_dynamic_modifier = { modifier = military_region_3_modifier scope = PREV }
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr3_state = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_3_modifier scope = PREV }
								}
							}
						}
						else_if = {
							limit = {
								is_mr4_state = yes
							}
							set_state_flag = im_mr4_state_flag
							add_dynamic_modifier = { modifier = military_region_4_modifier scope = PREV }
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr3_state = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_4_modifier scope = PREV }
								}
							}
						}
						else_if = {
							limit = {
								is_mr5_state = yes
							}
							set_state_flag = im_mr5_state_flag
							add_dynamic_modifier = { modifier = military_region_5_modifier scope = PREV }
							if = {
								limit = {
									has_global_flag = GXC_MR5_flag		
									country_exists = GXC							
								}
								add_dynamic_modifier = { modifier = military_region_5_modifier scope = GXC }
							}
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr5_state = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_5_modifier scope = PREV }
								}
							}
						}
						else_if = {
							limit = {
								is_mr6_state = yes
							}
							set_state_flag = im_mr6_state_flag
							add_dynamic_modifier = { modifier = military_region_6_modifier scope = PREV }
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr6_state = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_6_modifier scope = PREV }
								}
							}
						}
						else_if = {
							limit = {
								is_mr7_state = yes
							}
							set_state_flag = im_mr7_state_flag
							add_dynamic_modifier = { modifier = military_region_7_modifier scope = PREV }
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr7_state = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_7_modifier scope = PREV }
								}
							}
						}
						else_if = {
							limit = {
								is_mr8_state = yes
							}
							set_state_flag = im_mr8_state_flag
							add_dynamic_modifier = { modifier = military_region_8_modifier scope = PREV }
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr8_state = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_8_modifier scope = PREV }
								}
							}
						}
						else_if = {
							limit = {
								is_mr9_state = yes
							}
							set_state_flag = im_mr9_state_flag
							add_dynamic_modifier = { modifier = military_region_9_modifier scope = PREV }
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr9_state = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_9_modifier scope = PREV }
								}
							}
						}
						else_if = {
							limit = {
								is_mr10_state = yes
							}
							set_state_flag = im_mr10_state_flag
							add_dynamic_modifier = { modifier = military_region_10_modifier scope = PREV }
							owner = {
								if = {
									limit = {
										is_literally_china = yes
										NOT = {
											has_government = communism
											tag = event_target:WTT_current_china_leader
										}
									}
								}
								every_owned_state = {
									limit = {
										is_not_controlled_by_jap_or_its_puppet = yes
										is_mr10_state = yes
										NOT = {
                                            OR = {
												has_state_flag = im_mr1_state_flag
												has_state_flag = im_mr2_state_flag
												has_state_flag = im_mr3_state_flag
												has_state_flag = im_mr4_state_flag
												has_state_flag = im_mr5_state_flag
												has_state_flag = im_mr6_state_flag
												has_state_flag = im_mr7_state_flag
												has_state_flag = im_mr8_state_flag
												has_state_flag = im_mr9_state_flag
												has_state_flag = im_mr10_state_flag
											}
										}	
									}
									add_dynamic_modifier = { modifier = military_region_10_modifier scope = PREV }
								}
							}
						}
					}
				}
			}
		}
	}
}